{"version":3,"file":"kendo.pivot.common.min.js","sources":["kendo.pivot.common.js"],"sourcesContent":["(function(f, define){\n    define('pivotgrid/common',[\n        \"kendo.core\"\n    ], f);\n})(function(){\n\n(function () {\n\nwindow.kendo.pivotgrid = window.kendo.pivotgrid || {};\nwindow.kendo.pivotgrid.common = (function (exports) {\n    \n\n    var filterFunctionFormats = {\n        contains: \", InStr({0}.CurrentMember.MEMBER_CAPTION,\\\"{1}\\\") > 0\",\n        doesnotcontain: \", InStr({0}.CurrentMember.MEMBER_CAPTION,\\\"{1}\\\")\",\n        endswith: \", Right({0}.CurrentMember.MEMBER_CAPTION,Len(\\\"{1}\\\"))=\\\"{1}\\\"\",\n        eq: \", {0}.CurrentMember.MEMBER_CAPTION = \\\"{1}\\\"\",\n        neq: \", {0}.CurrentMember.MEMBER_CAPTION = \\\"{1}\\\"\",\n        startswith: \", Left({0}.CurrentMember.MEMBER_CAPTION,Len(\\\"{1}\\\"))=\\\"{1}\\\"\"\n    };\n    var operators = {\n        doesnotcontain: 'doesnotcontain',\n        in: 'in',\n        neq: \"neq\"\n    };\n    /**\n     * @hidden\n     */\n    function serializeFilters(filters, cube) {\n        var command = \"\";\n        var current = \"\";\n        for (var idx = filters.length - 1; idx >= 0; idx--) {\n            current = \"SELECT (\";\n            current += serializeExpression(filters[idx]);\n            current += \") ON 0\";\n            if (idx === filters.length - 1) {\n                current += \" FROM [\" + cube + \"]\";\n                command = current;\n            }\n            else {\n                command = current + \" FROM ( \" + command + \" )\";\n            }\n        }\n        return command;\n    }\n    function serializeExpression(expression) {\n        var command = '';\n        var value = String(expression.value);\n        var field = expression.field;\n        var operator = expression.operator;\n        if (operator === operators.in) {\n            command += \"{\";\n            command += value;\n            command += \"}\";\n        }\n        else {\n            command += operator === operators.neq || operator === operators.doesnotcontain ? '-' : '';\n            command += \"Filter(\";\n            command += field + \".MEMBERS\";\n            command += formatString(filterFunctionFormats[operator], field, value);\n            command += \")\";\n        }\n        return command;\n    }\n    function formatString(str) {\n        var values = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            values[_i - 1] = arguments[_i];\n        }\n        values.forEach(function (value, index) {\n            str = str.replace(new RegExp(\"\\\\{\" + index + \"\\\\}\", 'g'), value);\n        });\n        return str;\n    }\n\n    /**\n     * @hidden\n     */\n    function serializeMembers(members, measures, sort) {\n        var command = \"\";\n        members = members || [];\n        var parsed = parseDescriptors(members);\n        var expanded = parsed.expanded;\n        var rootNames = getRootNames(parsed.root);\n        var crossJoinCommands = [];\n        var length = expanded.length;\n        var idx = 0;\n        var memberName;\n        var names = [];\n        if (rootNames.length > 1 || measures.length > 1) {\n            crossJoinCommands.push(crossJoinCommand(rootNames, measures));\n            for (; idx < length; idx++) {\n                memberName = expandMemberDescriptor(expanded[idx].name, sort);\n                names = mapNames(memberName, rootNames);\n                crossJoinCommands.push(crossJoinCommand(names, measures));\n            }\n            command += crossJoinCommands.join(\",\");\n        }\n        else {\n            for (; idx < length; idx++) {\n                memberName = expandMemberDescriptor(expanded[idx].name, sort);\n                names.push(memberName[0]);\n            }\n            command += rootNames.concat(names).join(\",\");\n        }\n        return command;\n    }\n    /**\n     * @hidden\n     */\n    function measureNames(measures) {\n        var length = measures.length;\n        var result = [];\n        var measure;\n        for (var idx = 0; idx < length; idx++) {\n            measure = measures[idx];\n            result.push(measure.name !== undefined ? measure.name : measure);\n        }\n        return result;\n    }\n    function getRootNames(members) {\n        var root = [];\n        members.forEach(function (member) {\n            var name = member.name[0];\n            var hierarchyName = baseHierarchyPath(name);\n            if (!root.some(function (n) { return n.indexOf(hierarchyName) === 0; })) {\n                root.push(name);\n            }\n        });\n        return root;\n    }\n    function parseDescriptors(members) {\n        var expanded = [];\n        var child = [];\n        var root = [];\n        var idx = 0;\n        var found;\n        for (; idx < members.length; idx++) {\n            var member = members[idx];\n            var name_1 = member.name;\n            found = false;\n            if (name_1.length > 1) {\n                child.push(member);\n            }\n            else {\n                var hierarchyName = baseHierarchyPath(name_1[0]);\n                for (var j = 0, l = root.length; j < l; j++) {\n                    if (root[j].name[0].indexOf(hierarchyName) === 0) {\n                        found = true;\n                        break;\n                    }\n                }\n                if (!found) {\n                    root.push(member);\n                }\n                if (member.expand) {\n                    expanded.push(member);\n                }\n            }\n        }\n        expanded = expanded.concat(child);\n        return {\n            expanded: expanded,\n            root: root\n        };\n    }\n    function mapNames(names, rootNames) {\n        var rootLength = rootNames.length;\n        rootNames = rootNames.slice(0);\n        for (var idx = 0; idx < names.length; idx++) {\n            var name_2 = names[idx];\n            for (var j = 0; j < rootLength; j++) {\n                var rootName = baseHierarchyPath(rootNames[j]);\n                if (name_2.indexOf(rootName) !== -1) {\n                    rootNames[j] = name_2;\n                    break;\n                }\n            }\n        }\n        return rootNames;\n    }\n    function crossJoinCommand(members, measures) {\n        var tmp = members.slice(0);\n        if (measures.length > 1) {\n            tmp.push(\"{\" + measureNames(measures).join(\",\") + \"}\");\n        }\n        return crossJoin(tmp);\n    }\n    function expandMemberDescriptor(names, sort) {\n        var idx = names.length - 1;\n        var name = names[idx];\n        var sortDescriptor = sortDescriptorForMember(sort, name);\n        if (sortDescriptor && sortDescriptor.dir) {\n            name = \"ORDER(\" + name + \".Children,\" + sortDescriptor.field + \".CurrentMember.MEMBER_CAPTION,\" + sortDescriptor.dir + \")\";\n        }\n        else {\n            name += \".Children\";\n        }\n        names[idx] = name;\n        return names;\n    }\n    function sortDescriptorForMember(sort, member) {\n        for (var idx = 0, length_1 = sort.length; idx < length_1; idx++) {\n            if (member.indexOf(sort[idx].field) === 0) {\n                return sort[idx];\n            }\n        }\n        return null;\n    }\n    function baseHierarchyPath(memberName) {\n        var parts = memberName.split(\".\");\n        if (parts.length > 2) {\n            return parts[0] + \".\" + parts[1];\n        }\n        return memberName;\n    }\n    function crossJoin(names) {\n        var result = \"CROSSJOIN({\";\n        var name;\n        if (names.length > 2) {\n            name = names.pop();\n            result += crossJoin(names);\n        }\n        else {\n            result += names.shift();\n            name = names.pop();\n        }\n        result += \"},{\";\n        result += name;\n        result += \"})\";\n        return result;\n    }\n\n    /**\n     * @hidden\n     */\n    function createRequestBody(options) {\n        var command = '<Envelope xmlns=\"http://schemas.xmlsoap.org/soap/envelope/\"><Header/><Body><Execute xmlns=\"urn:schemas-microsoft-com:xml-analysis\"><Command><Statement>';\n        var _a = options.columnAxes, columnAxes = _a === void 0 ? [] : _a, _b = options.rowAxes, rowAxes = _b === void 0 ? [] : _b;\n        var _c = options.measureAxes, measureAxes = _c === void 0 ? [] : _c, _d = options.sort, sort = _d === void 0 ? [] : _d, _e = options.filter, filter = _e === void 0 ? [] : _e;\n        var measuresRowAxis = options.measuresAxis === \"rows\";\n        command += \"SELECT NON EMPTY {\";\n        if (!columnAxes.length && rowAxes.length && (!measureAxes.length || (measureAxes.length && measuresRowAxis))) {\n            columnAxes = rowAxes;\n            rowAxes = [];\n            measuresRowAxis = false;\n        }\n        if (!columnAxes.length && !rowAxes.length) {\n            measuresRowAxis = false;\n        }\n        if (columnAxes.length) {\n            command += serializeMembers(columnAxes, !measuresRowAxis ? measureAxes : [], sort);\n        }\n        else if (measureAxes.length && !measuresRowAxis) {\n            command += measureNames(measureAxes).join(\",\");\n        }\n        command += \"} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON COLUMNS\";\n        if (rowAxes.length || (measuresRowAxis && measureAxes.length > 1)) {\n            command += \", NON EMPTY {\";\n            if (rowAxes.length) {\n                command += serializeMembers(rowAxes, measuresRowAxis ? measureAxes : [], sort);\n            }\n            else {\n                command += measureNames(measureAxes).join(\",\");\n            }\n            command += \"} DIMENSION PROPERTIES CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME ON ROWS\";\n        }\n        if (filter.length) {\n            command += \" FROM \";\n            command += \"(\";\n            command += serializeFilters(filter, options.connection.cube);\n            command += \")\";\n        }\n        else {\n            command += \" FROM [\" + options.connection.cube + \"]\";\n        }\n        if (measureAxes.length === 1 && columnAxes.length) {\n            command += \" WHERE (\" + measureNames(measureAxes).join(\",\") + \")\";\n        }\n        command += '</Statement></Command><Properties><PropertyList><Catalog>' + options.connection.catalog + '</Catalog><Format>Multidimensional</Format></PropertyList></Properties></Execute></Body></Envelope>';\n        return command.replace(/&/g, \"&amp;\");\n    }\n\n    /******************************************************************************\n    Copyright (c) Microsoft Corporation.\n\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */\n\n    var __assign = function() {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n\n    function __awaiter(thisArg, _arguments, P, generator) {\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n        return new (P || (P = Promise))(function (resolve, reject) {\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\n        });\n    }\n\n    function __generator(thisArg, body) {\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n        function verb(n) { return function (v) { return step([n, v]); }; }\n        function step(op) {\n            if (f) throw new TypeError(\"Generator is already executing.\");\n            while (_) try {\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n                if (y = 0, t) op = [op[0] & 2, t.value];\n                switch (op[0]) {\n                    case 0: case 1: t = op; break;\n                    case 4: _.label++; return { value: op[1], done: false };\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                    default:\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                        if (t[2]) _.ops.pop();\n                        _.trys.pop(); continue;\n                }\n                op = body.call(thisArg, _);\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n        }\n    }\n\n    /** @deprecated */\n    function __spreadArrays() {\n        for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n        for (var r = Array(s), k = 0, i = 0; i < il; i++)\n            for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n                r[k] = a[j];\n        return r;\n    }\n\n    /**\n     * @hidden\n     */\n    function parseResponse(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var axes = Array.from(xmlDoc.querySelectorAll(\"Axis\"));\n        var cells = Array.from(xmlDoc.querySelectorAll(\"CellData > Cell\"))\n            .map(function (cell) { return ({\n            fmtValue: getPropertyValue(cell, \"FmtValue\"),\n            ordinal: parseInt(cell.getAttribute(\"CellOrdinal\"), 10),\n            value: getPropertyValue(cell, \"Value\")\n        }); });\n        var columns = { tuples: [] };\n        var rows = { tuples: [] };\n        var data = [];\n        axes.forEach(function (axis) {\n            if (axis.getAttribute('name') !== \"SlicerAxis\") {\n                var tuples = columns.tuples.length === 0 ? columns.tuples : rows.tuples;\n                Array.prototype.push.apply(tuples, translateAxis(axis));\n            }\n        });\n        var indexedData = new Array(rows.tuples.length * columns.tuples.length).fill(null);\n        cells.forEach(function (c) { indexedData[c.ordinal] = c; });\n        var counter = 0;\n        rows.tuples.forEach(function (rowTuple) {\n            columns.tuples.forEach(function (colTuple) {\n                data.push({\n                    columnTuple: colTuple,\n                    data: indexedData[counter],\n                    rowTuple: rowTuple\n                });\n                counter++;\n            });\n        });\n        return { columns: columns, data: data, rows: rows };\n    }\n    /**\n     * @hidden\n     */\n    function getPropertyValue(member, name) {\n        var node = member.querySelector(name);\n        return node ? node.textContent : \"\";\n    }\n    function translateAxis(axis) {\n        var tuples = Array.from(axis.querySelectorAll(\"Tuple\"));\n        return tuples.map(function (tuple) {\n            var memberElements = Array.from(tuple.querySelectorAll(\"Member\"));\n            var members = memberElements.map(function (member) {\n                var lNum = parseInt(getPropertyValue(member, \"LNum\") || \"0\", 10);\n                var hasChildren = parseInt(getPropertyValue(member, \"CHILDREN_CARDINALITY\") || \"0\", 10) > 0;\n                return {\n                    caption: getPropertyValue(member, \"Caption\"),\n                    children: [],\n                    hasChildren: hasChildren,\n                    hierarchy: member.getAttribute('Hierarchy'),\n                    levelName: getPropertyValue(member, \"LName\"),\n                    levelNum: lNum,\n                    name: getPropertyValue(member, \"UName\"),\n                    parentName: getPropertyValue(member, \"PARENT_UNIQUE_NAME\")\n                };\n            });\n            return { members: members };\n        });\n    }\n\n    /**\n     * @hidden\n     */\n    var discoverCommands = {\n        schemaCatalogs: \"DBSCHEMA_CATALOGS\",\n        schemaCubes: \"MDSCHEMA_CUBES\",\n        schemaDimensions: \"MDSCHEMA_DIMENSIONS\",\n        schemaHierarchies: \"MDSCHEMA_HIERARCHIES\",\n        schemaKPIs: \"MDSCHEMA_KPIS\",\n        schemaLevels: \"MDSCHEMA_LEVELS\",\n        schemaMeasures: \"MDSCHEMA_MEASURES\",\n        schemaMembers: \"MDSCHEMA_MEMBERS\"\n    };\n    /**\n     * @hidden\n     */\n    function createDiscoverBody(options) {\n        var properties = {};\n        var command = '<Envelope xmlns=\"http://schemas.xmlsoap.org/soap/envelope/\"><Header/><Body><Discover xmlns=\"urn:schemas-microsoft-com:xml-analysis\">';\n        command += \"<RequestType>\" + (discoverCommands[options.command] || options.command) + \"</RequestType>\";\n        command += \"<Restrictions>\" + serializeOptions(\"RestrictionList\", options.restrictions, true) + \"</Restrictions>\";\n        if (options.connection && options.connection.catalog) {\n            properties.Catalog = options.connection.catalog;\n        }\n        command += \"<Properties>\" + serializeOptions(\"PropertyList\", properties, false) + \"</Properties>\";\n        command += '</Discover></Body></Envelope>';\n        return command;\n    }\n    function serializeOptions(parentTagName, options, capitalize) {\n        var result = \"\";\n        if (options) {\n            result += \"<\" + parentTagName + \">\";\n            var value = void 0;\n            for (var key in options) {\n                if (options[key]) {\n                    value = options[key];\n                    if (capitalize) {\n                        key = key.replace(/([A-Z]+(?=$|[A-Z][a-z])|[A-Z]?[a-z]+)/g, \"$1_\").toUpperCase().replace(/_$/, \"\");\n                    }\n                    result += \"<\" + key + \">\" + value + \"</\" + key + \">\";\n                }\n            }\n            result += \"</\" + parentTagName + \">\";\n        }\n        else {\n            result += \"<\" + parentTagName + \"/>\";\n        }\n        return result;\n    }\n\n    /**\n     * @hidden\n     */\n    function parseCubes(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n            .map(function (row) { return ({\n            name: getPropertyValue(row, \"CUBE_NAME\"),\n            caption: getPropertyValue(row, \"CUBE_CAPTION\"),\n            description: getPropertyValue(row, \"DESCRIPTION\"),\n            type: getPropertyValue(row, \"CUBE_TYPE\")\n        }); });\n        return rows;\n    }\n    /**\n     * @hidden\n     */\n    function parseCatalogs(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n            .map(function (row) { return ({\n            name: getPropertyValue(row, \"CATALOG_NAME\"),\n            description: getPropertyValue(row, \"DESCRIPTION\")\n        }); });\n        return rows;\n    }\n    /**\n     * @hidden\n     */\n    function parseMeasures(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n            .map(function (row) { return ({\n            name: getPropertyValue(row, \"MEASURE_NAME\"),\n            caption: getPropertyValue(row, \"MEASURE_CAPTION\"),\n            uniqueName: getPropertyValue(row, \"MEASURE_UNIQUE_NAME\"),\n            description: getPropertyValue(row, \"DESCRIPTION\"),\n            aggregator: getPropertyValue(row, \"MEASURE_AGGREGATOR\"),\n            groupName: getPropertyValue(row, \"MEASUREGROUP_NAME\"),\n            displayFolder: getPropertyValue(row, \"MEASURE_DISPLAY_FOLDER\"),\n            defaultFormat: getPropertyValue(row, \"DEFAULT_FORMAT_STRING\")\n        }); });\n        return rows;\n    }\n    /**\n     * @hidden\n     */\n    function parseKPIs(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n            .map(function (row) { return ({\n            name: getPropertyValue(row, \"KPI_NAME\"),\n            uniqueName: getPropertyValue(row, \"KPI_NAME\"),\n            caption: getPropertyValue(row, \"KPI_CAPTION\"),\n            value: getPropertyValue(row, \"KPI_VALUE\"),\n            goal: getPropertyValue(row, \"KPI_GOAL\"),\n            status: getPropertyValue(row, \"KPI_STATUS\"),\n            trend: getPropertyValue(row, \"KPI_TREND\"),\n            statusGraphic: getPropertyValue(row, \"KPI_STATUS_GRAPHIC\"),\n            trendGraphic: getPropertyValue(row, \"KPI_TREND_GRAPHIC\"),\n            description: getPropertyValue(row, \"KPI_DESCRIPTION\"),\n            groupName: getPropertyValue(row, \"MEASUREGROUP_NAME\"),\n            type: \"kpi\"\n        }); });\n        return rows;\n    }\n    /**\n     * @hidden\n     */\n    function parseDimensions(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n            .map(function (row) { return ({\n            caption: getPropertyValue(row, \"DIMENSION_CAPTION\"),\n            defaultHierarchy: getPropertyValue(row, \"DEFAULT_HIERARCHY\"),\n            description: getPropertyValue(row, \"DESCRIPTION\"),\n            name: getPropertyValue(row, \"DIMENSION_NAME\"),\n            type: parseInt(getPropertyValue(row, \"DIMENSION_TYPE\"), 10),\n            uniqueName: getPropertyValue(row, \"DIMENSION_UNIQUE_NAME\")\n        }); });\n        return rows;\n    }\n    /**\n     * @hidden\n     */\n    function parseHierarchies(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n            .map(function (row) { return ({\n            name: getPropertyValue(row, \"HIERARCHY_NAME\"),\n            caption: getPropertyValue(row, \"HIERARCHY_CAPTION\"),\n            description: getPropertyValue(row, \"DESCRIPTION\"),\n            uniqueName: getPropertyValue(row, \"HIERARCHY_UNIQUE_NAME\"),\n            dimensionUniqueName: getPropertyValue(row, \"DIMENSION_UNIQUE_NAME\"),\n            displayFolder: getPropertyValue(row, \"HIERARCHY_DISPLAY_FOLDER\"),\n            origin: getPropertyValue(row, \"HIERARCHY_ORIGIN\"),\n            defaultMember: getPropertyValue(row, \"DEFAULT_MEMBER\")\n        }); });\n        return rows;\n    }\n    /**\n     * @hidden\n     */\n    function parseLevels(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n            .map(function (row) { return ({\n            name: getPropertyValue(row, \"LEVEL_NAME\"),\n            caption: getPropertyValue(row, \"LEVEL_CAPTION\"),\n            description: getPropertyValue(row, \"DESCRIPTION\"),\n            uniqueName: getPropertyValue(row, \"LEVEL_UNIQUE_NAME\"),\n            dimensionUniqueName: getPropertyValue(row, \"DIMENSION_UNIQUE_NAME\"),\n            displayFolder: getPropertyValue(row, \"LEVEL_DISPLAY_FOLDER\"),\n            orderingProperty: getPropertyValue(row, \"LEVEL_ORDERING_PROPERTY\"),\n            origin: getPropertyValue(row, \"LEVEL_ORIGIN\"),\n            hierarchyUniqueName: getPropertyValue(row, \"HIERARCHY_UNIQUE_NAME\")\n        }); });\n        return rows;\n    }\n    /**\n     * @hidden\n     */\n    function parseMembers(response) {\n        var xmlDoc = new DOMParser().parseFromString(response, \"text/xml\");\n        var rows = Array.from(xmlDoc.querySelectorAll(\"DiscoverResponse > return > root > row\"))\n            .map(function (row) { return ({\n            name: getPropertyValue(row, \"MEMBER_NAME\"),\n            caption: getPropertyValue(row, \"MEMBER_CAPTION\"),\n            uniqueName: getPropertyValue(row, \"MEMBER_UNIQUE_NAME\"),\n            dimensionUniqueName: getPropertyValue(row, \"DIMENSION_UNIQUE_NAME\"),\n            hierarchyUniqueName: getPropertyValue(row, \"HIERARCHY_UNIQUE_NAME\"),\n            levelUniqueName: getPropertyValue(row, \"LEVEL_UNIQUE_NAME\"),\n            childrenCardinality: getPropertyValue(row, \"CHILDREN_CARDINALITY\")\n        }); });\n        return rows;\n    }\n\n    var discoverParser = {\n        schemaCatalogs: parseCatalogs,\n        schemaCubes: parseCubes,\n        schemaDimensions: parseDimensions,\n        schemaHierarchies: parseHierarchies,\n        schemaKPIs: parseKPIs,\n        schemaLevels: parseLevels,\n        schemaMeasures: parseMeasures,\n        schemaMembers: parseMembers\n    };\n    /**\n     * Fetches the data.\n     *\n     * @param options RequestOptions\n     * @returns Promise<ResponseData>\n     *\n     * @example\n     * const options: RequestOptions = { ... };\n     *\n     * fetchData(options).then(createDataState).then((dataState: DataState) => {\n     *  // Update the UI\n     * });\n     */\n    /**\n     * @hidden\n     */\n    var fetchData = function (fetchOptions, options) { return __awaiter(void 0, void 0, void 0, function () {\n        var init, response, stringResponse;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    init = __assign({ body: createRequestBody(options), headers: { 'Content-Type': 'text/xml' }, method: 'POST' }, fetchOptions.init);\n                    return [4 /*yield*/, fetch(fetchOptions.url, init)];\n                case 1:\n                    response = _a.sent();\n                    return [4 /*yield*/, response.text()];\n                case 2:\n                    stringResponse = _a.sent();\n                    return [2 /*return*/, parseResponse(stringResponse)];\n            }\n        });\n    }); };\n    /**\n     * @hidden\n     */\n    var fetchDiscover = function (fetchOptions, options) { return __awaiter(void 0, void 0, void 0, function () {\n        var init, response, stringResponse;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    init = __assign({ body: createDiscoverBody(options), headers: { 'Content-Type': 'text/xml' }, method: 'POST' }, fetchOptions.init);\n                    return [4 /*yield*/, fetch(fetchOptions.url, init)];\n                case 1:\n                    response = _a.sent();\n                    return [4 /*yield*/, response.text()];\n                case 2:\n                    stringResponse = _a.sent();\n                    return [2 /*return*/, discoverParser[options.command](stringResponse)];\n            }\n        });\n    }); };\n\n    /**\n     * Creates the state object. See `fetchData`.\n     *\n     * @param response - ResponseData\n     * @returns DataState\n     */\n    /**\n     * @hidden\n     */\n    var createDataState = function (response) {\n        var state = {\n            columns: response.columns.tuples,\n            data: response.data,\n            rows: response.rows.tuples\n        };\n        return state;\n    };\n\n    /**\n     * Creates a collection of AxisDescriptor base on the expandTree.\n     * @param expandTree - { [key: string]: boolean }\n     * @returns AxisDescriptor[]\n     *\n     * @example\n     * See `setRowExpand` or `setColumnExpand` functions.\n     */\n    /**\n     * @hidden\n     */\n    function createAxisDescriptors(expandTree) {\n        var descriptors = [];\n        for (var _i = 0, _a = Object.keys(expandTree); _i < _a.length; _i++) {\n            var key = _a[_i];\n            descriptors.push({ name: JSON.parse(key), expand: expandTree[key] });\n        }\n        return descriptors;\n    }\n\n    /**\n     * Sets sort descriptors to request options.\n     *\n     * @param options - RequestOptions\n     * @param sort - SortDescriptor[]\n     *\n     * @example\n     * const options: RequestOptions = { ... };\n     * const sort: SortDescriptor[] = [{ ... }, { ... }];\n     * setSort(options, sort);\n     * // skip the sort parameter to clear current filter - setSort(options);\n     *\n     * fetchData(options).then(createDataState).then((dataState: DataState) => {\n     *  // Update the UI\n     * });\n     */\n    /**\n     * @hidden\n     */\n    var setSort = function (options, sort) {\n        if (sort === void 0) { sort = []; }\n        options.sort = sort;\n    };\n\n    /**\n     * Sets filter descriptors to request options.\n     *\n     * @param options - RequestOptions\n     * @param filter - FilterDescriptor[]\n     *\n     * @example\n     * const options: RequestOptions = { ... };\n     * const filter: FilterDescriptor[] = [{ ... }, { ... }];\n     * setFilter(options, filter);\n     * // skip the filter parameter to clear current filter - setFilter(options);\n     *\n     * fetchData(options).then(createDataState).then((dataState: DataState) => {\n     *  // Update the UI\n     * });\n     */\n    /**\n     * @hidden\n     */\n    var setFilter = function (options, filter) {\n        if (filter === void 0) { filter = []; }\n        options.filter = filter;\n    };\n\n    // A typical tree depth count won't work for the Pivot,\n    // as each branch can have lower number of nodes than the total number of levels\n    /**\n     * @hidden\n     */\n    var getMaxNesting = function (node, set) {\n        if (set === void 0) { set = new Set(); }\n        (node.children || []).forEach(function (child) {\n            set.add(child.levelName);\n            getMaxNesting(child, set);\n        });\n        return set.size;\n    };\n    /**\n     * @hidden\n     */\n    var getMaxExpansion = function (node) {\n        var expanded = 0;\n        (node.children || []).forEach(function (child) {\n            expanded += (getMaxExpansion(child) || 1);\n        });\n        return expanded;\n    };\n    /**\n     * @hidden\n     */\n    var generateNormalizedPath = function (node, parent) {\n        return (parent && (parent.hierarchy === node.hierarchy)\n            ? __spreadArrays((parent.normalizedPath || []).slice(0, -1), [node.name || null]) : __spreadArrays(((parent && parent.normalizedPath) ? parent.normalizedPath : []), [node.name])).filter(Boolean);\n    };\n    /**\n     * @hidden\n     */\n    var generatePath = function (node, parent) {\n        return (parent && (parent.hierarchy === node.hierarchy)\n            ? __spreadArrays((parent.path || []).slice(0, -1), [((node.levelNum === 0 ? node.hierarchy : node.name) || null)]) : __spreadArrays(((parent && parent.path) ? parent.path : []), [node.levelNum === 0 ? node.hierarchy : node.name])).filter(Boolean);\n    };\n    /**\n     * @hidden\n     */\n    var toMatrix = function (node, rowIndex, colIndex, maxDepth, maxBreadth, matrix, leafs, parent) {\n        if (rowIndex === void 0) { rowIndex = -1; }\n        if (colIndex === void 0) { colIndex = 0; }\n        if (maxDepth === void 0) { maxDepth = undefined; }\n        if (maxBreadth === void 0) { maxBreadth = undefined; }\n        if (matrix === void 0) { matrix = undefined; }\n        if (leafs === void 0) { leafs = undefined; }\n        if (parent === void 0) { parent = undefined; }\n        var branchDepth = getMaxNesting(node);\n        var branchBreadth = getMaxExpansion(node);\n        var depth = maxDepth || branchDepth;\n        var breadth = maxBreadth || branchBreadth;\n        var matrixResult = matrix ? matrix.slice() : [];\n        var leafsResult = leafs ? leafs.slice() : new Array(breadth);\n        var index = matrixResult.findIndex(function (l) { return l && l.name === node.levelName && l.level === node.levelNum; });\n        var level = matrixResult[index];\n        var row = {\n            name: node.levelName,\n            level: node.levelNum,\n            index: rowIndex,\n            cells: new Array(breadth).fill(null)\n        };\n        var inject = rowIndex !== -1 && colIndex !== -1;\n        var cell = {\n            caption: node.caption,\n            name: node.name,\n            levelName: node.levelName,\n            levelNum: node.levelNum,\n            hasChildren: node.hasChildren,\n            parentName: node.parentName,\n            hierarchy: node.hierarchy,\n            total: (node.total !== undefined ? node.total : false) || (parent && parent.children.length <= 1 && parent.total),\n            parent: parent,\n            rowIndex: rowIndex,\n            colIndex: colIndex,\n            depth: 1,\n            breadth: 1,\n            path: node.path || [],\n            normalizedPath: node.normalizedPath || [],\n            children: node.children.filter(function (c) { return c.hierarchy === node.hierarchy; })\n        };\n        if (inject) {\n            if (level) {\n                level.cells[colIndex] = cell;\n                if (level.index >= rowIndex) {\n                    rowIndex = level.index;\n                }\n            }\n            else {\n                if (matrixResult[rowIndex] && matrixResult[rowIndex].cells.length) {\n                    for (var idx = rowIndex; idx < matrixResult.length; idx++) {\n                        var shiftedRow = matrixResult[idx];\n                        shiftedRow.index++;\n                    }\n                    matrixResult.splice(rowIndex, 0, row);\n                    matrixResult[rowIndex].cells[colIndex] = cell;\n                }\n                else {\n                    matrixResult[rowIndex] = row;\n                    matrixResult[rowIndex].cells[colIndex] = cell;\n                }\n            }\n        }\n        var collOffset = 0;\n        if (node.children && node.children.length) {\n            node.children.forEach(function (child) {\n                var _a = toMatrix(child, rowIndex + 1, colIndex + collOffset, depth, breadth, matrixResult, leafsResult, cell), newMatrix = _a[0], newLeafs = _a[1], childBreadth = _a[3];\n                collOffset += (childBreadth || 1);\n                matrixResult = newMatrix.slice();\n                leafsResult = newLeafs.slice();\n            });\n        }\n        else if (node.normalizedPath) {\n            leafsResult[colIndex] = { total: cell.total, path: node.normalizedPath };\n        }\n        cell.depth = branchDepth;\n        cell.breadth = branchBreadth;\n        return [\n            matrixResult,\n            leafsResult,\n            branchDepth,\n            branchBreadth\n        ];\n    };\n    var withTotal = function (root, parent, index) {\n        if (parent === void 0) { parent = null; }\n        if (index === void 0) { index = 0; }\n        var hierarchy;\n        var alt = __assign(__assign({}, root), { total: true, hasChildren: false, children: [] });\n        for (var childIndex = 0; childIndex < root.children.length; childIndex++) {\n            var child = withTotal(root.children[childIndex], root, childIndex);\n            hierarchy = hierarchy || child.hierarchy;\n            if (child.hierarchy !== hierarchy\n                && parent\n                && !parent.children.some(function (c) { return c.total && c.name === alt.name; })\n                && !root.total) {\n                alt.children.push(child);\n                root.children.splice(childIndex, 1);\n                childIndex--;\n            }\n        }\n        if (root.children.filter(function (c) { return !c.total; }).length >= 1\n            && parent\n            && !parent.children.some(function (c) { return c.total && c.name === alt.name; })\n            && !root.total) {\n            var childHierarchy = root.children[0].hierarchy;\n            if (root.hierarchy === childHierarchy) {\n                parent.children.splice(index + 1, 0, alt);\n            }\n        }\n        return root;\n    };\n    /**\n     * @hidden\n     */\n    var toTree = function (tuples) {\n        var root = { children: [] };\n        var map = {};\n        for (var tupleIndex = 0; tupleIndex < tuples.length; tupleIndex++) {\n            var tuple = copy(tuples[tupleIndex]);\n            var key = \"\";\n            var _loop_1 = function (memberIndex) {\n                var member = tuple.members[memberIndex];\n                var parent_1;\n                if (root.children && root.children.length === 0) {\n                    parent_1 = root;\n                }\n                else if (map[key] && !map[key + member.name] && member.levelNum === 0) {\n                    parent_1 = map[key];\n                }\n                else if (map[key + member.parentName] && member.levelNum > 0 && !map[key + member.parentName + member.name]) {\n                    parent_1 = map[key + member.parentName];\n                }\n                else if (!map[key + member.parentName] && member.levelNum > 0 && !map[key + member.parentName + member.name]) {\n                    var parentKey = Object.keys(map).find(function (e) { return member.parentName === map[e].name; });\n                    if (parentKey) {\n                        parent_1 = map[parentKey];\n                    }\n                }\n                if (parent_1) {\n                    member.path = generatePath(member, parent_1);\n                    member.normalizedPath = generateNormalizedPath(member, parent_1);\n                    var intruderIndex = parent_1.children.findIndex(function (c) { return c.hierarchy !== parent_1.hierarchy; });\n                    if (intruderIndex !== -1) {\n                        parent_1.children.splice(intruderIndex, 0, member);\n                    }\n                    else {\n                        parent_1.children.push(member);\n                    }\n                }\n                member.parentName += member.name;\n                key += member.parentName;\n                if (!map[key]) {\n                    map[key] = member;\n                }\n            };\n            for (var memberIndex = 0; memberIndex < tuple.members.length; memberIndex++) {\n                _loop_1(memberIndex);\n            }\n        }\n        return copy(withTotal(root));\n    };\n    /**\n     * @hidden\n     */\n    var toData = function (data, columns, rows, breadth, depth) {\n        var result = Array.from(new Array(depth), function () { return ({ cells: Array.from(new Array(breadth), function () { return null; }) }); });\n        var hash = function (names) { return names.join('|'); };\n        var membersNames = function (tuple) { return tuple.members.map(function (m) { return m.name; }); };\n        var columnsIndexes = new Map();\n        var rowsIndexes = new Map();\n        columns.forEach(function (colMembers, idx) { columnsIndexes.set(hash(colMembers.path), idx); });\n        rows.forEach(function (rowMembers, idx) { rowsIndexes.set(hash(rowMembers.path), idx); });\n        data.forEach(function (item) {\n            var colIndex = columnsIndexes.get(hash(membersNames(item.columnTuple)));\n            var rowIndex = rowsIndexes.get(hash(membersNames(item.rowTuple)));\n            if (colIndex !== undefined && rowIndex !== undefined) {\n                if (!result[rowIndex].cells[colIndex]) {\n                    result[rowIndex].row = rows[rowIndex].path;\n                    result[rowIndex].cells[colIndex] = item;\n                }\n            }\n        });\n        return result;\n    };\n    var rotateMatrix = function (matrix, leafs, depth, breadth) {\n        var result = new Array(breadth);\n        for (var colIndex = 0; colIndex < breadth; colIndex++) {\n            for (var rowIndex = 0; rowIndex < depth; rowIndex++) {\n                if (matrix[rowIndex] && matrix[rowIndex].cells[colIndex]) {\n                    var cell = matrix[rowIndex].cells[colIndex];\n                    if (!result[colIndex]) {\n                        result[colIndex] = {\n                            cells: new Array(depth).fill(null)\n                        };\n                    }\n                    result[colIndex].cells[rowIndex] = __assign(__assign({}, cell), { rowSpan: cell.colSpan, colSpan: cell.rowSpan });\n                }\n            }\n        }\n        return [result, leafs, breadth, depth];\n    };\n    /**\n     * @hidden\n     */\n    var toColumns = function (root) {\n        var _a = toMatrix(root), matrix = _a[0], leafs = _a[1], depth = _a[2], breadth = _a[3];\n        for (var colIndex = 0; colIndex < breadth; colIndex++) {\n            var cell = null;\n            for (var rowIndex = 0; rowIndex < depth; rowIndex++) {\n                if (matrix[rowIndex]) {\n                    var next = matrix[rowIndex].cells[colIndex];\n                    if (!next && cell) {\n                        cell.rowSpan = (cell.rowSpan || 1) + 1;\n                    }\n                    if (cell) {\n                        cell.colSpan = cell.breadth || 1;\n                    }\n                    if (next) {\n                        cell = next;\n                    }\n                }\n            }\n        }\n        return [matrix, leafs, depth, breadth];\n    };\n    /**\n     * @hidden\n     */\n    var toRows = function (root) {\n        var _a = toMatrix(root), matrix = _a[0], leafs = _a[1], depth = _a[2], breadth = _a[3];\n        for (var colIndex = 0; colIndex < breadth; colIndex++) {\n            var cell = null;\n            for (var rowIndex = 0; rowIndex < depth; rowIndex++) {\n                if (matrix[rowIndex]) {\n                    var next = matrix[rowIndex].cells[colIndex];\n                    if (!next && cell) {\n                        cell.rowSpan = (cell.rowSpan || 1) + 1;\n                    }\n                    if (cell) {\n                        cell.colSpan = cell.breadth;\n                    }\n                    if (next) {\n                        cell = next;\n                    }\n                }\n            }\n        }\n        return rotateMatrix(matrix, leafs, depth, breadth);\n    };\n    /**\n     * @hidden\n     */\n    function copy(obj) {\n        return JSON.parse(JSON.stringify(obj));\n    }\n    var kpiMeasure = function (name, measure, type) {\n        return {\n            hierarchyUniqueName: name,\n            uniqueName: measure,\n            caption: measure,\n            measure: measure,\n            name: measure,\n            type: type,\n            kpi: true\n        };\n    };\n    /**\n     * @hidden\n     */\n    function buildKPIMeasures(node) {\n        var name = node.name;\n        return [\n            kpiMeasure(name, node.value, \"value\"),\n            kpiMeasure(name, node.goal, \"goal\"),\n            kpiMeasure(name, node.status, \"status\"),\n            kpiMeasure(name, node.trend, \"trend\")\n        ];\n    }\n    /**\n     * @hidden\n     */\n    var addKPI = function (data) {\n        var found;\n        var idx = 0;\n        for (; idx < data.length; idx++) {\n            if (data[idx].type === 2) {\n                found = true;\n                break;\n            }\n        }\n        if (found) {\n            data.splice(idx + 1, 0, {\n                caption: \"KPIs\",\n                defaultHierarchy: \"[KPIs]\",\n                name: \"KPIs\",\n                uniqueName: \"[KPIs]\"\n            });\n        }\n    };\n    /**\n     * @hidden\n     */\n    var compareAxisWithField = function (a, b) { return String(a.name) === String([(b.defaultHierarchy\n            ? b.defaultHierarchy\n            : b.uniqueName)]); };\n    /**\n     * @hidden\n     */\n    var compareAxes = function (a, b) { return String(a.name) === String(b.name); };\n    /**\n     * @hidden\n     */\n    var filterField = function (axes, out) {\n        var _loop_2 = function (i) {\n            var axis = axes[i];\n            var index = axis.name.findIndex(function (name) { return compareAxisWithField({ name: [name] }, out) || String(name).startsWith(out.uniqueName); });\n            if (index !== -1) {\n                if (index === axis.name.length - 1 || axis.name.length === 1) {\n                    axes.splice(i, 1);\n                }\n                else {\n                    axis.name.splice(index, 1);\n                    var duplicatedAxisIndex = axes.findIndex(function (ax) { return ax !== axis && String(ax.name) === String(axis.name); });\n                    if (duplicatedAxisIndex !== -1) {\n                        axes[duplicatedAxisIndex] = __assign(__assign(__assign({}, axes[duplicatedAxisIndex]), axis), ((axes[duplicatedAxisIndex].expand || axis.expand) ? { expand: true } : {}));\n                        axes.splice(i, 1);\n                    }\n                }\n            }\n        };\n        for (var i = axes.length - 1; i >= 0; i--) {\n            _loop_2(i);\n        }\n    };\n    /**\n     * @hidden\n     */\n    var insertAxis = function (axes, toInsert, state) {\n        var index = -1;\n        if (state.dropTarget && state.dropDirection) {\n            var offset = state.dropDirection\n                ? (state.dropDirection === 'before'\n                    ? 0\n                    : 1)\n                : 0;\n            index = axes.findIndex(function (c) { return compareAxes(c, state.dropTarget); }) + offset;\n        }\n        if (index !== -1) {\n            axes.forEach(function (axis) {\n                var _a;\n                if (axis.expand && axis.name.length > 1 && axis.name.length > index) {\n                    (_a = axis.name).splice.apply(_a, __spreadArrays([index, 0], toInsert.name));\n                }\n            });\n            axes.splice(index, 0, toInsert);\n        }\n        else {\n            axes.push(toInsert);\n        }\n    };\n\n    /**\n     * @hidden\n     */\n    exports.HEADERS_ACTION = void 0;\n    (function (HEADERS_ACTION) {\n        HEADERS_ACTION[\"toggle\"] = \"HEADERS_ACTION_TOGGLE\";\n        HEADERS_ACTION[\"expand\"] = \"HEADERS_ACTION_EXPAND\";\n        HEADERS_ACTION[\"collapse\"] = \"HEADERS_ACTION_COLLAPSE\";\n    })(exports.HEADERS_ACTION || (exports.HEADERS_ACTION = {}));\n    var findPath = function (node, matchFn, matched) {\n        var result = new Set();\n        node.children.forEach(function (child) {\n            var match = matchFn(child);\n            if (matched) {\n                result.add(String(child.path));\n            }\n            findPath(child, matchFn, (matched || match)).map(function (h) {\n                result.add(h);\n            });\n        });\n        return Array.from(result.values());\n    };\n    /**\n     * @hidden\n     */\n    var headersReducer = function (state, action) {\n        switch (action.type) {\n            case exports.HEADERS_ACTION.toggle: {\n                var existing = state.find((function (s) { return String(s.name) === String(action.payload); }));\n                return headersReducer(state, __assign(__assign({}, action), { type: existing && (existing.expand)\n                        ? exports.HEADERS_ACTION.collapse\n                        : exports.HEADERS_ACTION.expand }));\n            }\n            case exports.HEADERS_ACTION.expand: {\n                var existing_1 = state.find((function (s) { return String(s.name) === String(action.payload); }));\n                if (existing_1 && existing_1.expand === true) {\n                    return state;\n                }\n                else if (existing_1 && (existing_1.expand === false || existing_1.expand === undefined)) {\n                    return state.map(function (s) { return s === existing_1 ? (__assign(__assign({}, existing_1), { expand: true })) : s; });\n                }\n                else {\n                    var nextState = state.slice();\n                    nextState.push({ name: action.payload, expand: true });\n                    return nextState;\n                }\n            }\n            case exports.HEADERS_ACTION.collapse: {\n                var filtered_1 = findPath(action.tree, function (node) { return !node.total && String(node.path) === String(action.payload); });\n                var newState = state.slice()\n                    .filter(function (h) { return !filtered_1.some(function (f) { return f === String(h.name); }); })\n                    .map(function (h) { return (__assign(__assign({}, h), { expand: Boolean(h.expand) })); })\n                    .map(function (h) { return (String(h.name) === String(action.payload))\n                    ? action.payload.length > 1 ? undefined : { name: action.payload, expand: false }\n                    : h; })\n                    .filter(Boolean);\n                return newState;\n            }\n            default: {\n                return state;\n            }\n        }\n    };\n\n    /**\n     * @hidden\n     */\n    exports.PIVOT_CONFIGURATOR_ACTION = void 0;\n    (function (PIVOT_CONFIGURATOR_ACTION) {\n        // Selection\n        PIVOT_CONFIGURATOR_ACTION[\"toggleSelection\"] = \"PIVOT_CONFIGURATOR_ACTION_TOGGLE_SELECTION\";\n        PIVOT_CONFIGURATOR_ACTION[\"addColumnAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXIS\";\n        PIVOT_CONFIGURATOR_ACTION[\"addColumnAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_COLUMN_AXES\";\n        PIVOT_CONFIGURATOR_ACTION[\"removeColumnAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXIS\";\n        PIVOT_CONFIGURATOR_ACTION[\"removeColumnAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_COLUMN_AXES\";\n        PIVOT_CONFIGURATOR_ACTION[\"addRowAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXIS\";\n        PIVOT_CONFIGURATOR_ACTION[\"addRowAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_ROW_AXES\";\n        PIVOT_CONFIGURATOR_ACTION[\"removeRowAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXIS\";\n        PIVOT_CONFIGURATOR_ACTION[\"removeRowAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_ROW_AXES\";\n        PIVOT_CONFIGURATOR_ACTION[\"addMeasureAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXIS\";\n        PIVOT_CONFIGURATOR_ACTION[\"addMeasureAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_MEASURE_AXES\";\n        PIVOT_CONFIGURATOR_ACTION[\"removeMeasureAxis\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXIS\";\n        PIVOT_CONFIGURATOR_ACTION[\"removeMeasureAxes\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_MEASURE_AXES\";\n        // Removal\n        PIVOT_CONFIGURATOR_ACTION[\"remove\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE\";\n        // Sort\n        PIVOT_CONFIGURATOR_ACTION[\"setSort\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_SORT\";\n        // Filter\n        PIVOT_CONFIGURATOR_ACTION[\"setFilter\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_FILTER\";\n        PIVOT_CONFIGURATOR_ACTION[\"addFilter\"] = \"PIVOT_CONFIGURATOR_ACTION_ADD_FILTER\";\n        PIVOT_CONFIGURATOR_ACTION[\"changeFilter\"] = \"PIVOT_CONFIGURATOR_ACTION_CHANGE_FILTER\";\n        PIVOT_CONFIGURATOR_ACTION[\"removeFilter\"] = \"PIVOT_CONFIGURATOR_ACTION_REMOVE_FILTER\";\n        // Drag\n        PIVOT_CONFIGURATOR_ACTION[\"setDragItem\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_DRAGITEM\";\n        PIVOT_CONFIGURATOR_ACTION[\"drop\"] = \"PIVOT_CONFIGURATOR_ACTION_DROP\";\n        PIVOT_CONFIGURATOR_ACTION[\"setDropZone\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_DROP_ZONE\";\n        PIVOT_CONFIGURATOR_ACTION[\"setDropTarget\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_DROP_TARGET\";\n        PIVOT_CONFIGURATOR_ACTION[\"setDropDirection\"] = \"PIVOT_CONFIGURATOR_ACTION_SET_DROP_DIRECTION\";\n    })(exports.PIVOT_CONFIGURATOR_ACTION || (exports.PIVOT_CONFIGURATOR_ACTION = {}));\n    /**\n     * @hidden\n     */\n    var configuratorReducer = function (state, action) {\n        var newRows;\n        var newColumns;\n        var newMeasures;\n        var newSort;\n        var newFilter;\n        var newDragitem;\n        var newDropZone;\n        var newDropDirection;\n        var newDropTarget;\n        switch (action.type) {\n            case exports.PIVOT_CONFIGURATOR_ACTION.toggleSelection: {\n                if (Array.isArray(action.payload)) ;\n                else {\n                    var payload_1 = action.payload;\n                    if (payload_1.type === 2 || 'aggregator' in payload_1) {\n                        if (state.measureAxes.some(function (s) { return compareAxisWithField(s, payload_1); })) {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis }));\n                        }\n                        else {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.addMeasureAxis }));\n                        }\n                    }\n                    else if (payload_1.type === 'kpi') {\n                        var measures = buildKPIMeasures(payload_1);\n                        if (measures.every(function (m) { return state.measureAxes.some(function (s) { return compareAxisWithField(s, m); }); })) {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxes, payload: measures }));\n                        }\n                        else {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.addMeasureAxes, payload: measures.filter(function (m) { return !state.measureAxes.some(function (s) { return compareAxisWithField(s, m); }); }) }));\n                        }\n                    }\n                    else if (action.payload.kpi) {\n                        if (state.measureAxes.some(function (s) { return compareAxisWithField(s, payload_1); })) {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis }));\n                        }\n                        else {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.addMeasureAxis }));\n                        }\n                    }\n                    else {\n                        if (state.columnAxes.some(function (s) { return compareAxisWithField(s, payload_1); })) {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.removeColumnAxis }));\n                        }\n                        else if (state.rowAxes.some(function (s) { return compareAxisWithField(s, payload_1); })) {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.removeRowAxis }));\n                        }\n                        else if ((state.columnAxes && state.columnAxes.length) && (!state.rowAxes || !state.rowAxes.length)) {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.addRowAxis }));\n                        }\n                        else {\n                            return configuratorReducer(state, __assign(__assign({}, action), { type: exports.PIVOT_CONFIGURATOR_ACTION.addColumnAxis }));\n                        }\n                    }\n                }\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.addColumnAxis: {\n                newColumns = __spreadArrays((state.columnAxes || []), [\n                    { name: [action.payload.defaultHierarchy || action.payload.uniqueName] }\n                ]);\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.addColumnAxes: {\n                // TODO;\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.removeColumnAxis: {\n                newColumns = __spreadArrays((state.columnAxes || []).filter(function (s) { return !compareAxisWithField(s, action.payload); }));\n                filterField(newColumns, action.payload);\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.removeColumnAxes: {\n                // TODO;\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.addRowAxis: {\n                newRows = __spreadArrays((state.rowAxes || []), [\n                    { name: [action.payload.defaultHierarchy || action.payload.uniqueName] }\n                ]);\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.addRowAxes: {\n                // TODO;\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.removeRowAxis: {\n                newRows = __spreadArrays((state.rowAxes || []).filter(function (s) { return !compareAxisWithField(s, action.payload); }));\n                filterField(newRows, action.payload);\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.removeRowAxes: {\n                // TODO;\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.addMeasureAxis: {\n                newMeasures = __spreadArrays((state.measureAxes || []), [\n                    { name: [action.payload.defaultHierarchy || action.payload.uniqueName] }\n                ]);\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxis: {\n                newMeasures = __spreadArrays((state.measureAxes || []).filter(function (s) { return !compareAxisWithField(s, action.payload); }));\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.addMeasureAxes: {\n                newMeasures = __spreadArrays((state.measureAxes || []), (action.payload || []).map(function (p) { return ({ name: [p.defaultHierarchy || p.uniqueName] }); }));\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.removeMeasureAxes: {\n                newMeasures = __spreadArrays((state.measureAxes || []).filter(function (s) { return !action.payload.some(function (p) { return compareAxisWithField(s, p); }); }));\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.remove: {\n                if (state.columnAxes.some(function (s) { return compareAxes(s, action.payload); })) {\n                    newColumns = __spreadArrays(state.columnAxes.filter(function (s) { return !compareAxes(s, action.payload); }));\n                    filterField(newColumns, { uniqueName: action.payload.name });\n                }\n                if (state.rowAxes.some(function (s) { return compareAxes(s, action.payload); })) {\n                    newRows = __spreadArrays(state.rowAxes.filter(function (s) { return !compareAxes(s, action.payload); }));\n                    filterField(newRows, { uniqueName: action.payload.name });\n                }\n                if (state.measureAxes.some(function (s) { return compareAxes(s, action.payload); })) {\n                    newMeasures = __spreadArrays(state.measureAxes.filter(function (s) { return !compareAxes(s, action.payload); }));\n                }\n                break;\n            }\n            case exports.PIVOT_CONFIGURATOR_ACTION.setDragItem:\n                newDragitem = action.payload;\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.setDropZone:\n                newDropZone = action.payload;\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.setDropTarget:\n                newDropTarget = action.payload;\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.setDropDirection:\n                newDropDirection = action.payload;\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.drop:\n                if (state.dragItem && state.dropZone) {\n                    var currentColumn = state.columnAxes.find(function (s) { return compareAxes(s, action.payload); });\n                    var currentRow = state.rowAxes.find(function (s) { return compareAxes(s, action.payload); });\n                    var currentMeasure = state.measureAxes.find(function (s) { return compareAxes(s, action.payload); });\n                    var current = void 0;\n                    if (currentColumn) {\n                        current = currentColumn;\n                        newColumns = __spreadArrays(state.columnAxes.filter(function (s) { return !compareAxes(s, action.payload); }));\n                        filterField(newColumns, { uniqueName: action.payload.name });\n                    }\n                    if (currentRow) {\n                        current = currentRow;\n                        newRows = __spreadArrays(state.rowAxes.filter(function (s) { return !compareAxes(s, action.payload); }));\n                        filterField(newRows, { uniqueName: action.payload.name });\n                    }\n                    if (currentMeasure) {\n                        current = currentMeasure;\n                        newMeasures = __spreadArrays(state.measureAxes.filter(function (s) { return !compareAxes(s, action.payload); }));\n                    }\n                    switch (state.dropZone) {\n                        case 'columnAxes': {\n                            newColumns = newColumns || state.columnAxes.slice();\n                            insertAxis(newColumns, current, state);\n                            break;\n                        }\n                        case 'rowAxes': {\n                            newRows = newRows || state.rowAxes.slice();\n                            insertAxis(newRows, current, state);\n                            break;\n                        }\n                        case 'measureAxes': {\n                            newMeasures = newMeasures || state.measureAxes.slice();\n                            insertAxis(newMeasures, current, state);\n                            break;\n                        }\n                    }\n                }\n                newDragitem = null;\n                newDropZone = null;\n                newDropTarget = null;\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.setSort:\n                newSort = action.payload;\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.setFilter:\n                if (Array.isArray(action.payload)) {\n                    newFilter = action.payload;\n                }\n                else {\n                    newFilter = [action.payload];\n                }\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.addFilter:\n                newFilter = (state.filter || []).slice();\n                if (Array.isArray(action.payload)) {\n                    newFilter.push.apply(newFilter, action.payload);\n                }\n                else {\n                    newFilter.push(action.payload);\n                }\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.changeFilter:\n                newFilter = (Array.isArray(action.payload)\n                    ? (state.filter || []).map(function (f) { return action.payload.some(function (a) { return a.field === f.field; })\n                        ? action.payload.find(function (a) { return a.field === f.field; })\n                        : f; })\n                    : (state.filter || []).map(function (f) { return f.field === action.payload.field\n                        ? action.payload\n                        : f; }));\n                break;\n            case exports.PIVOT_CONFIGURATOR_ACTION.removeFilter:\n                newFilter = (state.filter || []).slice();\n                if (Array.isArray(action.payload)) {\n                    newFilter = newFilter.filter(function (f) { return !action.payload.some(function (p) { return p.field === f.field &&\n                        p.operator === f.operator; }); });\n                }\n                else {\n                    newFilter = newFilter.filter(function (f) { return !(f.field === action.payload.field\n                        && f.operator === action.payload.operator); });\n                }\n                break;\n        }\n        return {\n            dragItem: newDragitem,\n            dropTarget: newDropTarget,\n            dropDirection: newDropDirection,\n            dropZone: newDropZone,\n            columnAxes: newColumns,\n            rowAxes: newRows,\n            measureAxes: newMeasures,\n            filter: newFilter,\n            sort: newSort\n        };\n    };\n\n    // tslint:disable:object-literal-sort-keys\n    /**\n     * Represents the aggregate object which calculates the total value. Applicable for local data binding.\n     */\n    var sumAggregate = {\n        init: function (data) {\n            if (('sum' in data) === false) {\n                data.sum = 0;\n            }\n        },\n        merge: function (src, dest) {\n            dest.sum += src.sum;\n        },\n        accumulate: function (acc, value) {\n            acc.sum += value;\n        },\n        result: function (data) { return data.sum; },\n        format: function (value) { return value.toFixed(2); }\n    };\n    /**\n     * Represents the aggregate object which calculates the minimum value. Applicable for local data binding.\n     */\n    var minAggregate = {\n        init: function (data) {\n            if (('min' in data) === false) {\n                data.min = Number.POSITIVE_INFINITY;\n            }\n        },\n        merge: function (src, dest) {\n            dest.min = Math.min(src.min, dest.min);\n        },\n        accumulate: function (acc, value) {\n            acc.min = Math.min(value, acc.min);\n        },\n        result: function (data) { return Number.isFinite(data.min) ? data.min : NaN; },\n        format: function (value) { return value.toFixed(2); }\n    };\n    /**\n     * Represents the aggregate object which calculates the maximum value. Applicable for local data binding.\n     */\n    var maxAggregate = {\n        init: function (data) {\n            if (('max' in data) === false) {\n                data.max = Number.NEGATIVE_INFINITY;\n            }\n        },\n        merge: function (src, dest) {\n            dest.max = Math.max(src.max, dest.max);\n        },\n        accumulate: function (acc, value) {\n            acc.max = Math.max(value, acc.max);\n        },\n        result: function (data) { return Number.isFinite(data.max) ? data.max : NaN; },\n        format: function (value) { return value.toFixed(2); }\n    };\n    /**\n     * Represents the aggregate object which calculates the average value. Applicable for local data binding.\n     */\n    var averageAggregate = {\n        init: function (data) {\n            if (('count' in data) === false) {\n                data.sumA = 0;\n                data.count = 0;\n            }\n        },\n        merge: function (src, dest) {\n            dest.sumA += src.sumA;\n            dest.count += src.count;\n        },\n        accumulate: function (acc, value) {\n            acc.sumA += value;\n            acc.count += 1;\n        },\n        result: function (data) { return data.sumA / data.count; },\n        format: function (value) { return value.toFixed(2); }\n    };\n\n    /**\n     * @hidden\n     */\n    var isPresent = function (value) { return value !== null && value !== undefined; };\n    /**\n     * @hidden\n     */\n    var isBlank = function (value) { return value === null || value === undefined; };\n    /**\n     * @hidden\n     */\n    var isArray = function (value) { return Array.isArray(value); };\n    /**\n     * @hidden\n     */\n    var isFunction = function (value) { return typeof value === 'function'; };\n    /**\n     * @hidden\n     */\n    var isString = function (value) { return typeof value === 'string'; };\n    /**\n     * @hidden\n     */\n    var isNullOrEmptyString = function (value) { return isBlank(value) || value.trim().length === 0; };\n    /**\n     * @hidden\n     */\n    var isNotNullOrEmptyString = function (value) { return !isNullOrEmptyString(value); };\n    /**\n     * @hidden\n     */\n    var isNumeric = function (value) { return !isNaN(value - parseFloat(value)); };\n    /**\n     * @hidden\n     */\n    var isDate = function (value) { return value && value.getTime; };\n\n    // tslint:enable:max-line-length\n    /**\n     * @hidden\n     * Type guard for `CompositeFilterDescriptor`.\n     */\n    var isCompositeFilterDescriptor = function (source) {\n        return isPresent(source.filters);\n    };\n\n    /**\n     * @hidden\n     */\n    var ifElse = function (predicate, right, left) { return function (value) { return predicate(value) ? right(value) : left(value); }; };\n    /**\n     * @hidden\n     * Performs the right-to-left function composition. Functions should have a unary.\n     */\n    var compose = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return function (data) { return args.reduceRight(function (acc, curr) { return curr(acc); }, data); };\n    };\n\n    /**\n     * @hidden\n     */\n    var toUTC = function (date) {\n        return new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()));\n    };\n    /**\n     * @hidden\n     */\n    var isDateValue = function (x) { return isDate(x.value); };\n\n    var getterCache = {};\n    var FIELD_REGEX = /\\[(?:(\\d+)|['\"](.*?)['\"])\\]|((?:(?!\\[.*?\\]|\\.).)+)/g;\n    // tslint:disable-next-line:no-string-literal\n    getterCache['undefined'] = function (obj) { return obj; };\n    /**\n     * @hidden\n     */\n    var getter = function (field, safe) {\n        var key = field + safe;\n        if (getterCache[key]) {\n            return getterCache[key];\n        }\n        var fields = [];\n        field.replace(FIELD_REGEX, function (_, index, indexAccessor, field) {\n            fields.push(isPresent(index) ? index : (indexAccessor || field));\n            return undefined;\n        });\n        getterCache[key] = function (obj) {\n            var result = obj;\n            for (var idx = 0; idx < fields.length; idx++) {\n                result = result[fields[idx]];\n                if (!isPresent(result) && safe) {\n                    return result;\n                }\n            }\n            return result;\n        };\n        return getterCache[key];\n    };\n\n    var pairwise = function (key) { return function (value) { return [key, value]; }; };\n    var empty = function () { return null; };\n    var isNotEmptyArray = function (value) { return isPresent(value) && isArray(value) && value.length > 0; };\n    var isNotEmpty = function (accessor) { return function (value) { return isNotEmptyArray(accessor(value)); }; };\n    var runOrEmpty = function (predicate, fn) { return ifElse(predicate, fn, empty); };\n    var calcPage = function (_a) {\n        var skip = _a.skip, take = _a.take;\n        return Math.floor((skip || 0) / take) + 1;\n    };\n    var formatDescriptors = function (accessor, formatter) { return function (state) { return (accessor(state).map(formatter).join(\"~\")); }; };\n    var removeAfter = function (what) { return function (str) { return str.slice(0, str.indexOf(what)); }; };\n    var replace = function (patterns) {\n        return compose.apply(void 0, patterns.map(function (_a) {\n            var left = _a[0], right = _a[1];\n            return function (s) { return s.replace(new RegExp(left, \"g\"), right); };\n        }));\n    };\n    var sanitizeDateLiterals = replace([[\"\\\"\", \"\"], [\":\", \"-\"]]);\n    var removeAfterDot = removeAfter(\".\");\n    var directionFormatter = function (_a) {\n        var field = _a.field, _b = _a.dir, dir = _b === void 0 ? \"asc\" : _b;\n        return field + \"-\" + dir;\n    };\n    var aggregateFormatter = function (_a) {\n        var field = _a.field, aggregate = _a.aggregate;\n        return field + \"-\" + aggregate;\n    };\n    var take = getter(\"take\");\n    var aggregates = getter(\"aggregates\");\n    getter(\"skip\");\n    var group = getter(\"group\");\n    var sort = getter(\"sort\", true);\n    var formatSort = formatDescriptors(sort, directionFormatter);\n    var formatGroup = formatDescriptors(group, directionFormatter);\n    var formatAggregates = formatDescriptors(aggregates, aggregateFormatter);\n    var prefixDateValue = function (value) { return \"datetime'\" + value + \"'\"; };\n    var formatDateValue = compose(prefixDateValue, removeAfterDot, sanitizeDateLiterals, JSON.stringify, toUTC);\n    var formatDate = function (_a) {\n        var field = _a.field, value = _a.value, ignoreCase = _a.ignoreCase, operator = _a.operator;\n        return ({\n            value: formatDateValue(value),\n            field: field,\n            ignoreCase: ignoreCase,\n            operator: operator\n        });\n    };\n    var normalizeSort = function (state) { return Object.assign({}, state, {\n        sort: (sort(state) || []).filter(function (_a) {\n            var dir = _a.dir;\n            return isNotNullOrEmptyString(dir);\n        })\n    }); };\n    compose(pairwise('page'), calcPage);\n    compose(pairwise('pageSize'), take);\n    compose(pairwise('group'), formatGroup);\n    var transformSort = compose(pairwise('sort'), formatSort);\n    compose(pairwise('aggregate'), formatAggregates);\n    compose(runOrEmpty(isNotEmpty(sort), transformSort), normalizeSort);\n    var filterFormatter = function (_a) {\n        var field = _a.field, operator = _a.operator, value = _a.value;\n        return field + \"~\" + operator + \"~\" + value;\n    };\n    ifElse(isDateValue, compose(filterFormatter, formatDate), filterFormatter);\n\n    // tslint:enable:max-line-length\n    var set = function (field, target, value) {\n        target[field] = value;\n        return target;\n    };\n    var convert = function (mapper) { return function (values) { return Object.keys(values).reduce(mapper.bind(null, values), {}); }; };\n    var translateAggregate = convert(function (source, acc, field) { return set(field.toLowerCase(), acc, source[field]); });\n    var translateAggregates = convert(function (source, acc, field) { return set(field, acc, translateAggregate(source[field])); });\n    var valueOrDefault = function (value, defaultValue) { return isPresent(value) ? value : defaultValue; };\n    var normalizeGroup = function (group) { return ({\n        aggregates: group.Aggregates || group.aggregates,\n        field: group.Member || group.member || group.field,\n        hasSubgroups: group.HasSubgroups || group.hasSubgroups || false,\n        items: group.Items || group.items,\n        value: valueOrDefault(group.Key, valueOrDefault(group.key, group.value))\n    }); };\n    var translateGroup = compose(function (_a) {\n        var field = _a.field, hasSubgroups = _a.hasSubgroups, value = _a.value, aggregates = _a.aggregates, items = _a.items;\n        return ({\n            aggregates: translateAggregates(aggregates),\n            field: field,\n            items: hasSubgroups ? items.map(translateGroup) : items,\n            value: value\n        });\n    }, normalizeGroup);\n\n    var logic = {\n        \"or\": {\n            concat: function (acc, fn) { return function (a) { return acc(a) || fn(a); }; },\n            identity: function () { return false; }\n        },\n        \"and\": {\n            concat: function (acc, fn) { return function (a) { return acc(a) && fn(a); }; },\n            identity: function () { return true; }\n        }\n    };\n    var operatorsMap = {\n        contains: function (a, b) { return (a || \"\").indexOf(b) >= 0; },\n        doesnotcontain: function (a, b) { return (a || \"\").indexOf(b) === -1; },\n        doesnotendwith: function (a, b) { return (a || \"\").indexOf(b, (a || \"\").length - (b || \"\").length) < 0; },\n        doesnotstartwith: function (a, b) { return (a || \"\").lastIndexOf(b, 0) === -1; },\n        endswith: function (a, b) { return (a || \"\").indexOf(b, (a || \"\").length - (b || \"\").length) >= 0; },\n        eq: function (a, b) { return a === b; },\n        gt: function (a, b) { return a > b; },\n        gte: function (a, b) { return a >= b; },\n        isempty: function (a) { return a === ''; },\n        isnotempty: function (a) { return a !== ''; },\n        isnotnull: function (a) { return isPresent(a); },\n        isnull: function (a) { return isBlank(a); },\n        lt: function (a, b) { return a < b; },\n        lte: function (a, b) { return a <= b; },\n        neq: function (a, b) { return a != b; },\n        startswith: function (a, b) { return (a || \"\").lastIndexOf(b, 0) === 0; }\n    };\n    var dateRegExp = /^\\/Date\\((.*?)\\)\\/$/;\n    var convertValue = function (value, ignoreCase) {\n        if (value != null && isString(value)) {\n            var date = dateRegExp.exec(value);\n            if (date) {\n                return new Date(+date[1]).getTime();\n            }\n            else if (ignoreCase) {\n                return value.toLowerCase();\n            }\n        }\n        else if (value != null && isDate(value)) {\n            return value.getTime();\n        }\n        return value;\n    };\n    var typedGetter = function (prop, value, ignoreCase) {\n        if (!isPresent(value)) {\n            return prop;\n        }\n        var acc = prop;\n        if (isString(value)) {\n            var date = dateRegExp.exec(value);\n            if (date) {\n                value = new Date(+date[1]);\n            }\n            else {\n                acc = function (a) {\n                    var x = prop(a);\n                    if (typeof x === 'string' && ignoreCase) {\n                        return x.toLowerCase();\n                    }\n                    else {\n                        return isNumeric(x) ? x + \"\" : x;\n                    }\n                };\n            }\n        }\n        if (isDate(value)) {\n            return function (a) {\n                var x = acc(a);\n                return isDate(x) ? x.getTime() : x;\n            };\n        }\n        return acc;\n    };\n    var transformFilter = function (_a) {\n        var field = _a.field, ignoreCase = _a.ignoreCase, value = _a.value, operator = _a.operator;\n        field = !isPresent(field) ? function (a) { return a; } : field;\n        ignoreCase = isPresent(ignoreCase) ? ignoreCase : true;\n        var itemProp = typedGetter(isFunction(field) ? field : getter(field, true), value, ignoreCase);\n        value = convertValue(value, ignoreCase);\n        var op = isFunction(operator) ? operator : operatorsMap[operator];\n        return function (a) { return op(itemProp(a), value, ignoreCase); };\n    };\n    /**\n     * @hidden\n     */\n    var transformCompositeFilter = function (filter) {\n        var combiner = logic[filter.logic];\n        return filter.filters\n            .filter(isPresent)\n            .map(function (x) { return isCompositeFilterDescriptor(x) ? transformCompositeFilter(x) : transformFilter(x); })\n            .reduce(combiner.concat, combiner.identity);\n    };\n\n    // tslint:disable:max-line-length\n    /**\n     * Creates a [Predicate]({% slug api_kendo-data-query_predicate %}) function for the specified [CompositeFilterDescriptor]({% slug api_kendo-data-query_compositefilterdescriptor %}).\n     *\n     * @param {CompositeFilterDescriptor} descriptor - The descriptor for which the predicate is created.\n     * @returns {Predicate} - The created function instance.\n     *\n     * @example\n     * ```ts\n     * import { compileFilter } from '@progress/kendo-data-query';\n     *\n     * const data = [{ name: \"Pork\" }, { name: \"Pepper\" }, { name: \"Beef\" } ];\n     * const predicate = compileFilter({ logic: \"and\", filters: [{ field: \"name\", operator: \"startswith\", value: \"P\" }] });\n     * const result = data.filter(predicate);\n     *\n     * ```\n     */\n    // tslint:enable:max-line-length\n    var compileFilter = function (descriptor) {\n        if (!descriptor || descriptor.filters.length === 0) {\n            return function () { return true; };\n        }\n        return transformCompositeFilter(descriptor);\n    };\n\n    function forEachDesc(desc, callbackfn) {\n        if ('filters' in desc) {\n            desc.filters.map(function (child) { return forEachDesc(child, callbackfn); });\n        }\n        else {\n            callbackfn(desc);\n        }\n    }\n    var filterFields = function (filter, callback) {\n        var descriptors = Array.isArray(filter) ? filter : filter.filters;\n        descriptors.forEach(function (desc) { return forEachDesc(desc, callback); });\n    };\n    /** @hidden */\n    var initializeFiltering = function (rows, columns, filter) {\n        var compositeFilter = filter ?\n            (Array.isArray(filter) ? { logic: 'and', filters: filter } : filter) : undefined;\n        var predicate = compositeFilter ? compileFilter(compositeFilter) : function () { return true; };\n        var axes = rows.concat(columns);\n        var fieldValues = [];\n        filterFields(filter || [], function (desc) {\n            if ('field' in desc && desc.field) {\n                fieldValues.push(desc.field);\n            }\n        });\n        var result = { hasFilter: false, predicate: predicate, filteringAxes: [] };\n        if (fieldValues.some(function (f) { return typeof f === 'function'; })) {\n            result.filteringAxes = axes.slice();\n        }\n        else if (fieldValues.length > 0) {\n            var filteringFields_1 = Array.from(new Set(fieldValues).values());\n            var filteringAxes = axes.filter(function (a) { return filteringFields_1.indexOf(a.key) >= 0; });\n            result.filteringAxes = filteringAxes;\n        }\n        result.hasFilter = result.filteringAxes.length > 0;\n        return result;\n    };\n\n    /** @hidden */\n    var subNode = function (node, field, initialNode) {\n        var childNode = node.get(field);\n        if (!childNode) {\n            childNode = initialNode || new Map();\n            node.set(field, childNode);\n        }\n        return childNode;\n    };\n    var separator = '&';\n    /** @hidden */\n    var createKey = function (key, value) { return key + separator + value; };\n    /** @hidden */\n    var splitKeyValue = function (keyValue) {\n        var separatorIndex = keyValue.indexOf(separator);\n        if (separatorIndex !== -1) {\n            var key = keyValue.substring(0, separatorIndex);\n            var value = keyValue.substring(separatorIndex + 1);\n            return [key, value];\n        }\n        else {\n            return [keyValue, undefined];\n        }\n    };\n\n    var calculateColumnData = function (node, measures, dataField) {\n        node.forEach(function (childNode, k) {\n            if (k !== dataField) {\n                if (childNode.size > 0) {\n                    calculateColumnData(childNode, measures, dataField);\n                }\n                var childData_1 = childNode.get(dataField);\n                var parentData_1 = subNode(node, dataField, {});\n                measures.forEach(function (m) {\n                    m.aggregate.init(parentData_1);\n                    m.aggregate.merge(childData_1, parentData_1);\n                });\n            }\n        });\n    };\n    /** @hidden */\n    var mergeTrees = function (src, dest, measures, dataField) {\n        src.forEach(function (srcChild, k) {\n            var destChild;\n            if (k !== dataField) {\n                destChild = subNode(dest, k);\n                mergeTrees(srcChild, destChild, measures, dataField);\n            }\n            else {\n                destChild = subNode(dest, k, {});\n                measures.forEach(function (m) {\n                    m.aggregate.init(destChild);\n                    m.aggregate.merge(srcChild, destChild);\n                });\n            }\n        });\n    };\n    var calculateColumns = function (node, measures, columnsData, dataField) {\n        node.forEach(function (childNode, k) {\n            if (k !== columnsData) {\n                if (childNode.size > 0) {\n                    calculateColumns(childNode, measures, columnsData, dataField);\n                }\n                var srcColumns = subNode(childNode, columnsData);\n                var destColumns = subNode(node, columnsData);\n                mergeTrees(srcColumns, destColumns, measures, dataField);\n            }\n        });\n    };\n    /** @hidden */\n    var createDataTree = function (data, rows, columns, measures, fields, filter) {\n        var result = new Map();\n        var cache = new Map();\n        var axes = rows.concat(columns);\n        var leafNodes = new Set();\n        var dataField = fields.dataField, columnsData = fields.columnsData;\n        var _a = initializeFiltering(rows, columns, filter), hasFilter = _a.hasFilter, predicate = _a.predicate, filteringAxes = _a.filteringAxes;\n        var empty = '';\n        data.forEach(function (dataItem) {\n            if (hasFilter) {\n                var filteringDataItem_1 = {};\n                filteringAxes.forEach(function (axis) { filteringDataItem_1[axis.key] = axis.displayValue(dataItem); });\n                if (!predicate(filteringDataItem_1)) {\n                    return;\n                }\n            }\n            var values = axes.map(function (a) { return a.displayValue(dataItem); });\n            var dataKey = empty.concat.apply(empty, values);\n            var nodeData = cache.get(dataKey);\n            if (!nodeData) {\n                var node_1 = result;\n                var eachAxis = function (axis) {\n                    node_1 = subNode(node_1, createKey(axis.key, axis.displayValue(dataItem)));\n                };\n                rows.forEach(eachAxis);\n                node_1 = subNode(node_1, columnsData);\n                leafNodes.add(node_1);\n                columns.forEach(eachAxis);\n                nodeData = {};\n                node_1.set(dataField, nodeData);\n                cache.set(dataKey, nodeData);\n                measures.forEach(function (m) {\n                    m.aggregate.init(nodeData);\n                });\n            }\n            measures.forEach(function (m) {\n                m.aggregate.accumulate(nodeData, m.value(dataItem));\n            });\n        });\n        leafNodes.forEach(function (leaf) { return calculateColumnData(leaf, measures, dataField); });\n        calculateColumns(result, measures, columnsData, dataField);\n        return result;\n    };\n    /** @hidden */\n    var cloneDataTree = function (dataTree, dataField, measures) {\n        var result = new Map();\n        mergeTrees(dataTree, result, measures, dataField);\n        return result;\n    };\n\n    var createPath = function (name, axes, path) {\n        var _a = splitKeyValue(name), key = _a[0], value = _a[1];\n        var result = path.slice();\n        if (key && value) {\n            var axis = axes.find(function (a) { return a.key === key; });\n            var caption_1 = axis ? axis.caption : '';\n            return result.map(function (p) { return p === caption_1 ? name : p; });\n        }\n        return result;\n    };\n    var membersNode = function (tree, members, field, axisSettings, measures, dataField, cache) {\n        var cacheData = cache || new Map();\n        var path = axisSettings.map(function (a) { return a.caption; });\n        while (members.length > 1 && axisSettings.some(function (a) { return a.caption === members[members.length - 1].caption; })) {\n            members.pop();\n            path.pop();\n        }\n        var node = tree;\n        members.forEach(function (m, i) {\n            path = createPath(m.name, axisSettings, path);\n            if (node && !axisSettings.some(function (a) { return a.caption === m.name; })) {\n                if (!node.has(m.name) && !cacheData.has(path.slice(0, path.indexOf(m.name) + 1).join('-'))) {\n                    var currentLevel = Array.from(node).find(function (n) { return n[0] !== field; });\n                    var currentLevelNode = currentLevel && currentLevel[0];\n                    var levelField_1 = currentLevelNode && splitKeyValue(currentLevelNode)[0];\n                    var depth = levelField_1 ? i - axisSettings.findIndex(function (a) { return a.key === levelField_1; }) : 0;\n                    var _loop_1 = function (t) {\n                        var data = [];\n                        node.forEach(function (value, key) {\n                            if (key !== field) {\n                                data.push.apply(data, Array.from(value).filter(function (d) { return d[0] !== field; }));\n                            }\n                        });\n                        var next = new Map();\n                        data.forEach(function (item) {\n                            if (next.has(item[0])) {\n                                var dest = next.get(item[0]);\n                                var src = item[1];\n                                var newDest = new Map();\n                                mergeTrees(dest, newDest, measures, dataField);\n                                mergeTrees(src, newDest, measures, dataField);\n                                next.set(item[0], newDest);\n                            }\n                            else {\n                                next.set(item[0], new Map(item[1]));\n                            }\n                        });\n                        var currentPath = path.slice(0, path.indexOf(m.name));\n                        next.forEach(function (value, key) {\n                            cacheData.set(createPath(key, axisSettings, currentPath.concat([key])).join('-'), value);\n                        });\n                        next.set(field, node.get(field));\n                        node = next;\n                    };\n                    for (var t = 0; t < depth; t++) {\n                        _loop_1(t);\n                    }\n                }\n                node = node.get(m.name) || cacheData.get(path.slice(0, path.indexOf(m.name) + 1).join('-'));\n            }\n        });\n        return node;\n    };\n    /** @hidden */\n    var readData = function (dataTree, rowTuples, columnTuples, fields, columnSettings, rowSettings, measures) {\n        var data = [];\n        var dataField = fields.dataField, columnsData = fields.columnsData;\n        var rowsCache = new Map();\n        rowTuples.forEach(function (row) {\n            var rowNode = membersNode(dataTree, row.members.slice(), columnsData, rowSettings, measures, dataField, rowsCache);\n            var rowColumnsNode = rowNode && rowNode.get(columnsData);\n            columnTuples.forEach(function (col) {\n                var members = col.members.slice();\n                var measure = measures[0];\n                if (members[members.length - 1].levelName === \"[Measures].[MeasuresLevel]\") {\n                    var measuresMember_1 = members.pop();\n                    measure = measures.find(function (m) { return String(m.name) === measuresMember_1.caption; }) || measure;\n                }\n                var colNode = rowColumnsNode && membersNode(rowColumnsNode, members, dataField, columnSettings, measures, dataField);\n                var value = '', fmtValue = '', ordinal = 0;\n                if (colNode && measure) {\n                    var result = measure.aggregate.result(colNode.get(dataField));\n                    value = String(result);\n                    fmtValue = measure.aggregate.format(result);\n                }\n                data.push({\n                    columnTuple: col,\n                    data: { fmtValue: fmtValue, ordinal: ordinal, value: value },\n                    rowTuple: row\n                });\n            });\n        });\n        return data;\n    };\n\n    var getTopMembersTuple = function (parentFields, axesSettings) {\n        var allTuple = { members: [] };\n        parentFields.forEach(function (topField) {\n            var axis = axesSettings.find(function (a) { return a.key === topField; });\n            var caption = axis ? axis.caption : \"\";\n            var member = {\n                caption: caption,\n                children: [],\n                hasChildren: true,\n                parentName: \"\",\n                levelNum: 0,\n                levelName: caption,\n                hierarchy: topField,\n                name: caption\n            };\n            allTuple.members.push(member);\n        });\n        return allTuple;\n    };\n    var sortFunc = function (descriptor, axe) {\n        return function (a, b) {\n            var order = descriptor.dir;\n            var sortableA = axe.sortValue(splitKeyValue(a[0])[1]);\n            var sortableB = axe.sortValue(splitKeyValue(b[0])[1]);\n            if (sortableA < sortableB) {\n                return order === \"asc\" ? -1 : 1;\n            }\n            if (sortableA > sortableB) {\n                return order === \"asc\" ? 1 : -1;\n            }\n            return 0;\n        };\n    };\n    var mergeData = function (src, dest, exclude) {\n        src.forEach(function (srcChild, k) {\n            if (!exclude[k]) {\n                var destChild = subNode(dest, k);\n                mergeData(srcChild, destChild, exclude);\n            }\n        });\n    };\n    var childrenByKeys = function (dataTree, keys, exclude) {\n        var result = [];\n        var nodeData = function (node) { return Array.from(node).filter(function (n) { return !exclude[n[0]]; }); };\n        var element = new Map(dataTree);\n        var next;\n        var _loop_1 = function (i) {\n            next = element.get(keys[i]);\n            if (next) {\n                element = new Map(next);\n            }\n            else if (i < keys.length - 1 && Array.from(element).some(function (e) { return splitKeyValue(e[0])[0] === keys[i]; })) {\n                var curLevel_1 = [];\n                element.forEach(function (child, key) {\n                    if (!exclude[key]) {\n                        curLevel_1.push.apply(curLevel_1, nodeData(new Map(child)));\n                    }\n                });\n                element = new Map();\n                curLevel_1.forEach(function (item) {\n                    if (element.has(item[0])) {\n                        var dest = element.get(item[0]);\n                        var src = item[1];\n                        var newDest = new Map();\n                        mergeData(dest, newDest, exclude);\n                        mergeData(src, newDest, exclude);\n                        element.set(item[0], newDest);\n                    }\n                    else {\n                        element.set(item[0], new Map(item[1]));\n                    }\n                });\n            }\n            else if (i === 0 || i === keys.length - 1) {\n                if (Array.from(element).some(function (e) { return splitKeyValue(e[0])[0] === keys[i]; })) {\n                    result.push.apply(result, nodeData(element));\n                }\n            }\n        };\n        for (var i = 0; i < keys.length; i++) {\n            _loop_1(i);\n        }\n        return result;\n    };\n    /** @hidden */\n    var rootFields = function (definitions) {\n        var fields = new Set();\n        definitions.forEach(function (item) {\n            if (item.name.length === 1 && !splitKeyValue(item.name[0])[1]) {\n                fields.add(item.name[0]);\n            }\n        });\n        return fields;\n    };\n    /** @hidden */\n    var createTuples = function (axesSettings, definitions, dataTree, sortDescriptors, excludeFields) {\n        var parentFields = rootFields(definitions);\n        var flatMembers = [];\n        var topTuple = getTopMembersTuple(parentFields, axesSettings);\n        flatMembers.push(topTuple);\n        var _loop_2 = function (i) {\n            var currDef = definitions[i];\n            if (currDef.name.length === 1 && !currDef.expand && parentFields.has(currDef.name[0])) {\n                return \"continue\";\n            }\n            var keysToAdd = new Set(parentFields.keys());\n            var currDefMembers = [];\n            var keys = [];\n            var tuples = [];\n            var axe;\n            currDef.name.forEach(function (element, index) {\n                var _a;\n                var _b = splitKeyValue(element), field = _b[0], value = _b[1];\n                axe = axesSettings.find(function (a) { return a.key === field; });\n                if (value) {\n                    keysToAdd.delete(field);\n                    keys.push(element);\n                    var member = {\n                        children: [],\n                        caption: value,\n                        hierarchy: field,\n                        levelNum: 1,\n                        levelName: field + \" \" + field,\n                        name: element,\n                        parentName: axe ? axe.caption : \"\"\n                    };\n                    currDefMembers.push(member);\n                }\n                else if (currDef.expand && currDef.name.length - 1 === index) {\n                    keysToAdd.delete(element);\n                    keys.push(element);\n                    var children = childrenByKeys(dataTree, keys, excludeFields);\n                    var descriptor = sortDescriptors.find(function (desc) { return desc.field === field; });\n                    if (descriptor && descriptor.dir) {\n                        children.sort(sortFunc(descriptor, axe));\n                    }\n                    for (var c = 0; c < children.length; c++) {\n                        var leafValue = children[c][0];\n                        var leafTuple = { members: [] };\n                        tuples.push(leafTuple);\n                        var caption = splitKeyValue(leafValue)[1];\n                        axe = axesSettings.find(function (a) { return a.key === element; });\n                        var member = {\n                            caption: caption,\n                            children: [],\n                            levelName: element + \" \" + element,\n                            levelNum: 1,\n                            parentName: axe ? axe.caption : \"\",\n                            hierarchy: element,\n                            name: leafValue\n                        };\n                        (_a = leafTuple.members).push.apply(_a, currDefMembers);\n                        leafTuple.members.push(member);\n                    }\n                }\n                else if (currDef.expand) {\n                    axe = axesSettings.find(function (a) { return a.key === element; });\n                    var axisCaption = axe ? axe.caption : \"\";\n                    keysToAdd.delete(element);\n                    keys.push(element);\n                    var member = {\n                        children: [],\n                        caption: axisCaption,\n                        hierarchy: element,\n                        levelName: axisCaption,\n                        levelNum: 0,\n                        name: axisCaption,\n                        parentName: \"\"\n                    };\n                    currDefMembers.push(member);\n                }\n                keysToAdd.forEach(function (key) {\n                    tuples.forEach(function (tuple) {\n                        axe = axesSettings.find(function (a) { return a.key === key; });\n                        var curCaption = axe ? axe.caption : \"\";\n                        var member = {\n                            children: [],\n                            hasChildren: true,\n                            caption: curCaption,\n                            hierarchy: key,\n                            levelName: curCaption,\n                            levelNum: 0,\n                            name: curCaption,\n                            parentName: \"\"\n                        };\n                        tuple.members.push(member);\n                    });\n                });\n                flatMembers.push.apply(flatMembers, tuples);\n            });\n        };\n        for (var i = 0; i < definitions.length; i++) {\n            _loop_2(i);\n        }\n        return flatMembers;\n    };\n    var addMeasure = function (tuple, measure) {\n        var measureMember = {\n            caption: String(measure.name),\n            children: [],\n            hasChildren: false,\n            hierarchy: \"[Measures]\",\n            levelName: \"[Measures].[MeasuresLevel]\",\n            levelNum: 0,\n            name: \"[Measures].[\" + measure.name + \"]\",\n            parentName: \"\"\n        };\n        var tupleCopy = copy(tuple);\n        tupleCopy.members.push(measureMember);\n        return tupleCopy;\n    };\n    /** @hidden */\n    var addMultipleMeasures = function (tuples, measures) {\n        if (measures.length < 2) {\n            return tuples;\n        }\n        var result = tuples.slice();\n        for (var i = result.length - 1; i >= 0; i--) {\n            var tuple = result[i];\n            result[i] = addMeasure(result[i], measures[0]);\n            for (var m = 1; m < measures.length; m++) {\n                var tupleWithMeasure = addMeasure(tuple, measures[m]);\n                result.splice(i + 1, 0, tupleWithMeasure);\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    var createLocalDataState = function (args) {\n        var _a;\n        var dataTree = args.dataTree, rowSettings = args.rowSettings, columnSettings = args.columnSettings, rowAxes = args.rowAxes, columnAxes = args.columnAxes, measures = args.measures, sort = args.sort, fields = args.fields;\n        var exclude = (_a = {}, _a[fields.columnsData] = fields.columnsData, _a[fields.dataField] = fields.dataField, _a);\n        var columnTuples = addMultipleMeasures(createTuples(columnSettings, columnAxes, dataTree.get(fields.columnsData), sort, exclude), measures);\n        var rowTuples = createTuples(rowSettings, rowAxes, dataTree, sort, exclude);\n        var resultData = readData(dataTree, rowTuples, columnTuples, fields, columnSettings, rowSettings, measures);\n        return {\n            columns: columnTuples,\n            data: resultData,\n            rows: rowTuples\n        };\n    };\n\n    /** @hidden */\n    var createFlatSchemaDimensions = function (dimensions, measures) {\n        var result = Object.keys(dimensions).map(function (dim) { return ({\n            caption: dim,\n            defaultHierarchy: dim,\n            description: '',\n            name: dim,\n            uniqueName: dim,\n            hierarchyUniqueName: dim,\n            measure: true,\n            type: 1 // https://github.com/telerik/kendo-pivotgrid-common/blob/develop/src/models/responseDiscover.ts#L12-L14\n        }); });\n        if (measures.length) {\n            result.push({\n                caption: 'Measures',\n                children: measures.map(function (m) { return ({\n                    aggregator: '1',\n                    caption: String(m.name),\n                    defaultFormat: '',\n                    description: '',\n                    displayFolder: '',\n                    groupName: String(m.name),\n                    name: String(m.name),\n                    uniqueName: String(m.name)\n                }); }),\n                type: 2,\n                description: '',\n                name: 'Measures',\n                uniqueName: '[Measures]'\n            });\n        }\n        return result;\n    };\n\n    exports.addKPI = addKPI;\n    exports.addMultipleMeasures = addMultipleMeasures;\n    exports.averageAggregate = averageAggregate;\n    exports.buildKPIMeasures = buildKPIMeasures;\n    exports.cloneDataTree = cloneDataTree;\n    exports.compareAxes = compareAxes;\n    exports.configuratorReducer = configuratorReducer;\n    exports.createAxisDescriptors = createAxisDescriptors;\n    exports.createDataState = createDataState;\n    exports.createDataTree = createDataTree;\n    exports.createDiscoverBody = createDiscoverBody;\n    exports.createFlatSchemaDimensions = createFlatSchemaDimensions;\n    exports.createLocalDataState = createLocalDataState;\n    exports.createRequestBody = createRequestBody;\n    exports.createTuples = createTuples;\n    exports.discoverCommands = discoverCommands;\n    exports.fetchData = fetchData;\n    exports.fetchDiscover = fetchDiscover;\n    exports.headersReducer = headersReducer;\n    exports.maxAggregate = maxAggregate;\n    exports.mergeTrees = mergeTrees;\n    exports.minAggregate = minAggregate;\n    exports.parseResponse = parseResponse;\n    exports.readData = readData;\n    exports.rootFields = rootFields;\n    exports.setFilter = setFilter;\n    exports.setSort = setSort;\n    exports.sumAggregate = sumAggregate;\n    exports.toColumns = toColumns;\n    exports.toData = toData;\n    exports.toRows = toRows;\n    exports.toTree = toTree;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n    return exports;\n\n})({});\n\n})();\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3){ (a3 || a2)(); });\n(function(f, define) {\n    define('kendo.pivot.common',[ \"./pivotgrid/common\" ], f);\n})(function() {\n    var __meta__ = {\n        id: \"pivot.common\",\n        name: \"PivotCommon\",\n        category: \"web\",\n        description: \"Common JS for PivotGrid\",\n        depends: [ \"core\" ]\n    };\n\n\treturn window.kendo;\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","window","kendo","pivotgrid","common","exports","filterFunctionFormats","contains","doesnotcontain","endswith","eq","neq","startswith","operators","in","serializeFilters","filters","cube","command","current","idx","length","serializeExpression","expression","value","String","field","operator","formatString","str","values","_i","arguments","forEach","index","replace","RegExp","serializeMembers","members","measures","sort","parsed","parseDescriptors","expanded","rootNames","getRootNames","root","crossJoinCommands","memberName","names","push","crossJoinCommand","expandMemberDescriptor","name","mapNames","join","concat","measureNames","result","measure","undefined","member","hierarchyName","baseHierarchyPath","some","n","indexOf","child","found","name_1","j","l","expand","rootLength","slice","name_2","rootName","tmp","crossJoin","sortDescriptor","sortDescriptorForMember","dir","length_1","parts","split","pop","shift","createRequestBody","options","_a","columnAxes","_b","rowAxes","_c","measureAxes","_d","_e","filter","measuresRowAxis","measuresAxis","connection","catalog","__assign","Object","assign","t","s","i","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","adopt","resolve","Promise","reject","fulfilled","step","next","e","rejected","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","throw","return","Symbol","iterator","v","op","TypeError","__spreadArrays","il","r","Array","k","a","jl","parseResponse","response","xmlDoc","DOMParser","parseFromString","axes","from","querySelectorAll","cells","map","cell","fmtValue","getPropertyValue","ordinal","parseInt","getAttribute","columns","tuples","rows","data","axis","translateAxis","indexedData","fill","c","counter","rowTuple","colTuple","columnTuple","node","querySelector","textContent","tuple","memberElements","lNum","hasChildren","caption","children","hierarchy","levelName","levelNum","parentName","discoverCommands","schemaCatalogs","schemaCubes","schemaDimensions","schemaHierarchies","schemaKPIs","schemaLevels","schemaMeasures","schemaMembers","createDiscoverBody","properties","serializeOptions","restrictions","Catalog","parentTagName","capitalize","key","toUpperCase","parseCubes","row","description","type","parseCatalogs","parseMeasures","uniqueName","aggregator","groupName","displayFolder","defaultFormat","parseKPIs","goal","status","trend","statusGraphic","trendGraphic","parseDimensions","defaultHierarchy","parseHierarchies","dimensionUniqueName","origin","defaultMember","parseLevels","orderingProperty","hierarchyUniqueName","parseMembers","levelUniqueName","childrenCardinality","discoverParser","fetchData","fetchOptions","init","stringResponse","headers","Content-Type","method","fetch","url","text","fetchDiscover","createDataState","state","createAxisDescriptors","expandTree","descriptors","keys","JSON","parse","setSort","setFilter","getMaxNesting","set","Set","add","size","getMaxExpansion","generateNormalizedPath","parent","normalizedPath","Boolean","generatePath","path","toMatrix","rowIndex","colIndex","maxDepth","maxBreadth","matrix","leafs","branchDepth","branchBreadth","depth","breadth","matrixResult","leafsResult","findIndex","level","inject","total","shiftedRow","splice","collOffset","newMatrix","newLeafs","childBreadth","withTotal","alt","childIndex","childHierarchy","toTree","tupleIndex","copy","_loop_1","memberIndex","parent_1","parentKey","find","intruderIndex","toData","hash","membersNames","m","columnsIndexes","Map","rowsIndexes","colMembers","rowMembers","item","get","rotateMatrix","rowSpan","colSpan","toColumns","toRows","obj","stringify","kpiMeasure","kpi","buildKPIMeasures","addKPI","compareAxisWithField","b","compareAxes","filterField","out","_loop_2","startsWith","duplicatedAxisIndex","ax","insertAxis","toInsert","dropTarget","dropDirection","offset","HEADERS_ACTION","findPath","matchFn","matched","match","h","headersReducer","action","toggle","existing","payload","collapse","existing_1","nextState","filtered_1","tree","newState","PIVOT_CONFIGURATOR_ACTION","configuratorReducer","newRows","newColumns","newMeasures","newSort","newFilter","newDragitem","newDropZone","newDropDirection","newDropTarget","toggleSelection","isArray","payload_1","removeMeasureAxis","addMeasureAxis","every","removeMeasureAxes","addMeasureAxes","removeColumnAxis","removeRowAxis","addRowAxis","addColumnAxis","addColumnAxes","removeColumnAxes","addRowAxes","removeRowAxes","remove","setDragItem","setDropZone","setDropTarget","setDropDirection","drop","dragItem","dropZone","currentColumn","currentRow","currentMeasure","addFilter","changeFilter","removeFilter","sumAggregate","sum","merge","src","dest","accumulate","acc","format","toFixed","minAggregate","min","Number","POSITIVE_INFINITY","Math","isFinite","NaN","maxAggregate","max","NEGATIVE_INFINITY","averageAggregate","sumA","count","isPresent","isBlank","isFunction","isString","isNullOrEmptyString","trim","isNotNullOrEmptyString","isNumeric","isNaN","parseFloat","isDate","getTime","isCompositeFilterDescriptor","source","ifElse","predicate","right","left","compose","args","reduceRight","curr","toUTC","date","Date","UTC","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","isDateValue","x","getterCache","FIELD_REGEX","getter","safe","fields","indexAccessor","pairwise","empty","isNotEmptyArray","isNotEmpty","accessor","runOrEmpty","fn","calcPage","skip","take","floor","formatDescriptors","formatter","removeAfter","what","patterns","sanitizeDateLiterals","removeAfterDot","directionFormatter","aggregateFormatter","aggregate","aggregates","group","formatSort","formatGroup","formatAggregates","prefixDateValue","formatDateValue","formatDate","ignoreCase","normalizeSort","transformSort","filterFormatter","target","convert","mapper","reduce","bind","translateAggregate","toLowerCase","translateAggregates","valueOrDefault","defaultValue","normalizeGroup","Aggregates","Member","hasSubgroups","HasSubgroups","items","Items","Key","translateGroup","logic","or","identity","and","operatorsMap","doesnotendwith","doesnotstartwith","lastIndexOf","gt","gte","isempty","isnotempty","isnotnull","isnull","lt","lte","dateRegExp","convertValue","exec","typedGetter","prop","transformFilter","itemProp","transformCompositeFilter","combiner","compileFilter","descriptor","forEachDesc","desc","callbackfn","filterFields","callback","initializeFiltering","compositeFilter","fieldValues","hasFilter","filteringAxes","filteringFields_1","subNode","initialNode","childNode","separator","createKey","splitKeyValue","keyValue","separatorIndex","substring","calculateColumnData","dataField","childData_1","parentData_1","mergeTrees","srcChild","destChild","calculateColumns","columnsData","srcColumns","destColumns","createDataTree","cache","leafNodes","dataItem","filteringDataItem_1","displayValue","dataKey","nodeData","node_1","eachAxis","leaf","cloneDataTree","dataTree","createPath","caption_1","membersNode","axisSettings","cacheData","has","currentLevel","currentLevelNode","levelField_1","d","newDest","currentPath","readData","rowTuples","columnTuples","columnSettings","rowSettings","rowsCache","rowNode","rowColumnsNode","col","measuresMember_1","colNode","getTopMembersTuple","parentFields","axesSettings","allTuple","topField","sortFunc","axe","order","sortableA","sortValue","sortableB","mergeData","exclude","childrenByKeys","element","curLevel_1","rootFields","definitions","createTuples","sortDescriptors","excludeFields","flatMembers","topTuple","currDef","keysToAdd","currDefMembers","delete","leafValue","leafTuple","axisCaption","curCaption","addMeasure","measureMember","tupleCopy","addMultipleMeasures","tupleWithMeasure","createLocalDataState","resultData","createFlatSchemaDimensions","dimensions","dim","defineProperty","amd","a1","a2","a3","__meta__","id","category","depends"],"mappings":"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"}