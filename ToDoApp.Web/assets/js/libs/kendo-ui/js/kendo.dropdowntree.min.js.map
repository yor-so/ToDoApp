{"version":3,"file":"kendo.dropdowntree.min.js","sources":["kendo.dropdowntree.js"],"sourcesContent":["(function(f, define) {\n    define('dropdowntree/treeview',[ \"kendo.treeview\" ], f);\n})(function() {\n\n(function($, undefined) {\n\n    var kendo = window.kendo,\n        ui = kendo.ui,\n        keys = kendo.keys,\n        DISABLED = \"k-disabled\",\n        SELECT = \"select\",\n        CHECKED = \"checked\",\n        DATABOUND = \"dataBound\",\n        CLICK = \"click\",\n        NS = \".kendoTreeView\",\n        INDETERMINATE = \"indeterminate\",\n        NAVIGATE = \"navigate\",\n        subGroup,\n        TreeView = ui.TreeView;\n\n        function contentChild(filter) {\n            return function(node) {\n                var result = node.children(\".k-animation-container\");\n\n                if (!result.length) {\n                    result = node;\n                }\n\n                return result.children(filter);\n            };\n        }\n\n        subGroup = contentChild(\".k-group\");\n\n    var Tree = TreeView.extend({\n        init: function(element, options, dropdowntree) {\n            var that = this;\n\n            that.dropdowntree = dropdowntree;\n\n            TreeView.fn.init.call(that, element, options);\n            if (that.dropdowntree._isMultipleSelection()) {\n                that.wrapper.on(CLICK + NS, '.k-in.k-selected', that._clickSelectedItem.bind(that));\n            }\n        },\n\n        _checkOnSelect: function(e) {\n            if (!e.isDefaultPrevented()) {\n                var dataItem = this.dataItem(e.node);\n\n                dataItem.set(\"checked\", !dataItem.checked);\n            }\n        },\n\n        _setCheckedValue: function(node, value) {\n            node.set(CHECKED, value);\n        },\n\n        _click: function(e) {\n            var that = this;\n\n            if (that.dropdowntree._isMultipleSelection()) {\n                that.one(\"select\", that._checkOnSelect);\n            }\n            TreeView.fn._click.call(that, e);\n        },\n\n        _clickSelectedItem: function(e) {\n            var that = this,\n            node = $(e.currentTarget);\n\n            that.one(\"select\", that._checkOnSelect);\n            if (!that._trigger(SELECT, node)) {\n                that.dataItem(node).set(\"selected\", false);\n            }\n        },\n\n        defaultrefresh: function(e) {\n            var that = this;\n            var node = e.node;\n            var action = e.action;\n            var items = e.items;\n            var parentNode = this.wrapper;\n            var options = this.options;\n            var loadOnDemand = options.loadOnDemand;\n            var checkChildren = options.checkboxes && options.checkboxes.checkChildren;\n            var i;\n\n            if (this._skip) {\n                return;\n            }\n\n            if (e.field) {\n                if (!items[0] || !items[0].level) {\n                    return;\n                }\n\n                return this._updateNodes(items, e.field);\n            }\n\n            if (node) {\n                parentNode = this.findByUid(node.uid);\n                this._progress(parentNode, false);\n            }\n\n            if (checkChildren && action != \"remove\") {\n                var bubble = false;\n\n                for (i = 0; i < items.length; i++) {\n                    if (\"checked\" in items[i]) {\n                        bubble = true;\n                        break;\n                    }\n                }\n\n                if (!bubble && node && node.checked) {\n                    for (i = 0; i < items.length; i++) {\n                        items[i].checked = true;\n                    }\n                }\n            }\n\n            if (action == \"add\") {\n                this._appendItems(e.index, items, parentNode);\n            } else if (action == \"remove\") {\n                this._remove(this.findByUid(items[0].uid), false);\n            } else if (action == \"itemchange\") {\n                this._updateNodes(items);\n            } else if (action == \"itemloaded\") {\n                this._refreshChildren(parentNode, items, e.index);\n            } else {\n                this._refreshRoot(items);\n            }\n\n            if (action != \"remove\") {\n                for (i = 0; i < items.length; i++) {\n                    if (!loadOnDemand || items[i].expanded) {\n                        items[i].load();\n                    }\n                }\n            }\n\n            that.wrapper.attr(\"role\", \"tree\");\n            that.wrapper.find(\">ul\").attr(\"role\", \"none\");\n\n            this._ariaItems(this.wrapper.find(\">.k-group>.k-item\"), 1);\n\n            this.trigger(DATABOUND, { node: node ? parentNode : undefined });\n            this.dropdowntree._treeViewDataBound({ node: node ? parentNode : undefined, sender: this });\n            if (this.options.checkboxes.checkChildren) {\n                this.updateIndeterminate();\n            }\n        },\n\n        _previousVisible: function(node) {\n            var that = this,\n                lastChild,\n                result;\n\n            if (!node.length || node.prev().length) {\n                if (node.length) {\n                    result = node.prev();\n                } else {\n                    result = that.root.children().last();\n                }\n\n                while (that._expanded(result)) {\n                    lastChild = subGroup(result).children().last();\n\n                    if (!lastChild.length) {\n                        break;\n                    }\n\n                    result = lastChild;\n                }\n            } else {\n                result = that.parent(node) || node;\n\n                if (!result.length) {\n                    if (that.dropdowntree.checkAll && that.dropdowntree.checkAll.is(\":visible\")) {\n                        that.dropdowntree.checkAll.find(\".k-checkbox\").trigger(\"focus\");\n                    } else if (that.dropdowntree.filterInput) {\n                        that.dropdowntree.filterInput.trigger(\"focus\");\n                    } else {\n                        that.dropdowntree.wrapper.trigger(\"focus\");\n                    }\n                }\n            }\n\n            return result;\n        },\n\n        _keydown: function(e) {\n            var that = this,\n                key = e.keyCode,\n                target,\n                focused = that.current(),\n                expanded = that._expanded(focused),\n                checkbox = focused.find(\".k-checkbox-wrapper\").first().find(\":checkbox\"),\n                rtl = kendo.support.isRtl(that.element);\n\n            if (e.target != e.currentTarget) {\n                return;\n            }\n\n            if ((!rtl && key == keys.RIGHT) || (rtl && key == keys.LEFT)) {\n                if (expanded) {\n                    target = that._nextVisible(focused);\n                } else if (!focused.find(\".k-in\").first().hasClass(DISABLED)) {\n                    that.expand(focused);\n                }\n            } else if ((!rtl && key == keys.LEFT) || (rtl && key == keys.RIGHT)) {\n                if (expanded && !focused.find(\".k-in\").first().hasClass(DISABLED)) {\n                    that.collapse(focused);\n                } else {\n                    target = that.parent(focused);\n\n                    if (!that._enabled(target)) {\n                        target = undefined;\n                    }\n                }\n            } else if (key == keys.DOWN) {\n                target = that._nextVisible(focused);\n            } else if (key == keys.UP && !e.altKey) {\n                target = that._previousVisible(focused);\n            } else if (key == keys.HOME) {\n                target = that._nextVisible($());\n            } else if (key == keys.END) {\n                target = that._previousVisible($());\n            } else if (key == keys.ENTER && !focused.find(\".k-in\").first().hasClass(DISABLED)) {\n                if (!focused.find(\".k-in\").first().hasClass(\"k-selected\")) {\n                    if (!that._trigger(SELECT, focused)) {\n                        that.select(focused);\n                    }\n                }\n            } else if (key == keys.SPACEBAR && checkbox.length && !focused.find(\".k-in\").first().hasClass(DISABLED)) {\n                checkbox.prop(CHECKED, !checkbox.prop(CHECKED))\n                    .data(INDETERMINATE, false)\n                    .prop(INDETERMINATE, false);\n\n                that._checkboxChange({ target: checkbox });\n\n                target = focused;\n            } else if ((e.altKey && key === keys.UP) || key === keys.ESC) {\n                that._closePopup();\n            } else if ( key === keys.TAB) {\n                e.preventDefault();\n                that._closePopup();\n            }\n\n            if (target) {\n                e.preventDefault();\n\n                if (focused[0] != target[0]) {\n                    that._trigger(NAVIGATE, target);\n                    that.current(target);\n                }\n            }\n        },\n\n        _closePopup: function() {\n            this.dropdowntree.close();\n            this.dropdowntree.wrapper.trigger(\"focus\");\n        },\n\n        refresh: function(e) {\n            this.defaultrefresh(e);\n\n            if (this.dropdowntree.options.skipUpdateOnBind) {\n                return;\n            }\n\n            if (e.action === \"itemchange\") {\n                if (this.dropdowntree._isMultipleSelection()) {\n                    if (e.field === \"checked\") {\n                        this.dropdowntree._checkValue(e.items[0]);\n                    }\n                } else {\n                    if (e.field !== \"checked\" && e.field !== \"expanded\" && e.items[0].selected) {\n                        this.dropdowntree._selectValue(e.items[0]);\n                    }\n                }\n            } else {\n                this.dropdowntree.refresh(e);\n            }\n        }\n\n    });\n\n    kendo.ui._dropdowntree = Tree;\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n(function(f, define) {\n    define('kendo.dropdowntree',[ \"./dropdowntree/treeview\", \"kendo.popup\", \"kendo.binder\", \"kendo.html.chip\", \"kendo.html.chiplist\", \"kendo.html.button\", \"kendo.html.input\" ], f);\n})(function() {\n\nvar __meta__ = {\n    id: \"dropdowntree\",\n    name: \"DropDownTree\",\n    category: \"web\",\n    description: \"The DropDownTree widget displays a hierarchy of items and allows the selection of single or multiple items.\",\n    depends: [ \"treeview\", \"popup\", \"binder\", \"html.chip\", \"html.chiplist\", \"html.button\", \"html.input\" ]\n};\n\n(function($, undefined) {\n    var kendo = window.kendo,\n        ui = kendo.ui,\n        html = kendo.html,\n        Widget = ui.Widget,\n        TreeView = ui._dropdowntree,\n        ObservableArray = kendo.data.ObservableArray,\n        ObservableObject = kendo.data.ObservableObject,\n        extend = $.extend,\n        activeElement = kendo._activeElement,\n        ns = \".kendoDropDownTree\",\n        keys = kendo.keys,\n        support = kendo.support,\n        HIDDENCLASS = \"k-hidden\",\n        WIDTH = \"width\",\n        browser = support.browser,\n        outerWidth = kendo._outerWidth,\n        DOT = \".\",\n        DISABLED = \"disabled\",\n        READONLY = \"readonly\",\n        STATEDISABLED = \"k-disabled\",\n        ARIA_DISABLED = \"aria-disabled\",\n        HOVER = \"k-hover\",\n        FOCUSED = \"k-focus\",\n        HOVEREVENTS = \"mouseenter\" + ns + \" mouseleave\" + ns,\n        TABINDEX = \"tabindex\",\n        CLICK = \"click\",\n        OPEN = \"open\",\n        CLOSE = \"close\",\n        CHANGE = \"change\",\n        quotRegExp = /\"/g,\n\n        CHIP = \".k-chip\";\n\n    var DropDownTree = kendo.ui.Widget.extend( {\n        init: function(element, options) {\n            this.ns = ns;\n\n            kendo.ui.Widget.fn.init.call(this, element, options);\n            this._selection = this._getSelection();\n            this._focusInputHandler = this._focusInput.bind(this);\n            this._initial = this.element.val();\n\n            this._values = [];\n\n            var value = this.options.value;\n\n            if (value === null || !value.length) {\n                this._noInitialValue = true;\n            }\n\n            if (!this._isNullorUndefined(value)) {\n                this._valueMethodCalled = true;\n                this._values = Array.isArray(value) ? value.slice(0) : [value];\n            }\n\n            this._inputTemplate();\n\n            this._accessors();\n            this._setTreeViewOptions(this.options);\n            this._dataSource();\n            this._selection._initWrapper();\n            this._applyCssClasses();\n            this._placeholder(true);\n            this._tabindex();\n            this.wrapper.data(TABINDEX, this.wrapper.attr(TABINDEX));\n\n            this.tree = $('<div/>')\n            .attr({\n                tabIndex: -1,\n                \"aria-hidden\": true\n            });\n\n            this.list = $(\"<div class='k-list-container'/>\")\n                .append(this.tree);\n\n            this._header();\n            this._noData();\n            this._footer();\n            this._reset();\n            this._popup();\n            this.popup.one(\"open\", this._popupOpen.bind(this));\n            this._clearButton();\n            this._filterHeader();\n            this._treeview();\n\n            this._renderFooter();\n\n            this._checkAll();\n            this._enable();\n            this._toggleCloseVisibility();\n\n            this._aria();\n\n            if (!this.options.autoBind) {\n                var text = options.text || \"\";\n                if (!this._isNullorUndefined(options.value)) {\n                    this._preselect(options.value);\n                } else if (text) {\n                    this._textAccessor(text);\n                } else if (options.placeholder) {\n                    this._placeholder(true);\n                }\n            }\n\n            var disabled = $(this.element).parents(\"fieldset\").is(':disabled');\n\n            if (disabled) {\n                this.enable(false);\n            }\n            this._valueMethodCalled = false;\n            kendo.notify(this);\n        },\n\n        _preselect: function(data, value) {\n            this._selection._preselect(data, value);\n        },\n\n        _setTreeViewOptions: function(options) {\n            var treeviewOptions = {\n                autoBind: options.autoBind,\n                checkboxes: options.checkboxes,\n                dataImageUrlField: options.dataImageUrlField,\n                dataSpriteCssClassField: options.dataSpriteCssClassField,\n                dataTextField: options.dataTextField,\n                dataUrlField: options.dataUrlField,\n                loadOnDemand: options.loadOnDemand,\n                size: options.size\n            };\n\n            this.options.treeview = $.extend({}, treeviewOptions, this.options.treeview);\n\n            if (options.template) {\n                this.options.treeview.template = options.template;\n            }\n\n            if (options.size) {\n                this.options.treeview.size = options.size;\n            }\n        },\n\n        _dataSource: function() {\n            var rootDataSource = this.options.dataSource;\n\n            this.dataSource = kendo.data.HierarchicalDataSource.create(rootDataSource);\n            if (rootDataSource) {\n                $.extend(this.options.treeview,{\n                    dataSource: this.dataSource\n                });\n            }\n        },\n\n        _popupOpen: function() {\n            var popup = this.popup;\n            popup.wrapper = kendo.wrap(popup.element);\n        },\n\n        _getSelection: function() {\n            if (this._isMultipleSelection()) {\n                this.options._altname = \"MultiSelectDropDownTree\";\n                return new ui.DropDownTree.MultipleSelection(this);\n            } else {\n                return new ui.DropDownTree.SingleSelection(this);\n            }\n        },\n\n        setDataSource: function(dataSource) {\n            this._isDataSourceSet = true;\n            if (this._tags) {\n                this._noInitialValue = true;\n                this.setValue([]);\n                this._tags.empty();\n                this.span.show();\n                this._multipleTags.empty();\n            }\n            this.dataSource = dataSource;\n            this.treeview.setDataSource(dataSource);\n            this._isDataSourceSet = false;\n        },\n\n        _isMultipleSelection: function() {\n            return this.options && (this.options.treeview.checkboxes || this.options.checkboxes);\n        },\n\n        options: {\n            name: \"DropDownTree\",\n            animation: {},\n            autoBind: true,\n            autoClose: true,\n            autoWidth: false,\n            clearButton: true,\n            dataTextField: \"\",\n            dataValueField: \"\",\n            dataImageUrlField: \"\",\n            dataSpriteCssClassField: \"\",\n            dataUrlField: \"\",\n            delay: 500,\n            enabled: true,\n            enforceMinLength: false,\n            filter: \"none\",\n            height: 200,\n            ignoreCase: true,\n            index: 0,\n            loadOnDemand: false,\n            messages: {\n                \"singleTag\": \"item(s) selected\",\n                \"clear\": \"clear\",\n                \"deleteTag\": \"delete\",\n                \"noData\": \"No data found.\"\n            },\n            minLength: 1,\n            checkboxes: false,\n            noDataTemplate: true,\n            placeholder: \"\",\n            checkAll: false,\n            checkAllTemplate: \"Check all\",\n            tagMode: \"multiple\",\n            template: null,\n            text: null,\n            treeview: {},\n            valuePrimitive: false,\n            footerTemplate: \"\",\n            headerTemplate: \"\",\n            value: null,\n            valueTemplate: null,\n            popup: null,\n            filterLabel: null,\n            size: \"medium\",\n            fillMode: \"solid\",\n            rounded: \"medium\"\n        },\n\n        events: [\n            \"open\",\n            \"close\",\n            \"dataBound\",\n            CHANGE,\n            \"select\",\n            \"filtering\"\n        ],\n\n        focus: function() {\n            this.wrapper.trigger(\"focus\");\n        },\n\n        dataItem: function(node) {\n            return this.treeview.dataItem(node);\n        },\n\n        readonly: function(readonly) {\n            this._editable({\n                readonly: readonly === undefined ? true : readonly,\n                disable: false\n            });\n            this._toggleCloseVisibility();\n        },\n\n        enable: function(enable) {\n            this._editable({\n                readonly: false,\n                disable: !(enable = enable === undefined ? true : enable)\n            });\n            this._toggleCloseVisibility();\n        },\n\n        toggle: function(open) {\n            this._toggle(open);\n        },\n\n        open: function() {\n            var popup = this.popup;\n\n            if (!this.options.autoBind && !this.dataSource.data().length) {\n                this.treeview._progress(true);\n                if (this._isFilterEnabled()) {\n                    this._search();\n                } else {\n                    this.dataSource.fetch();\n                }\n            }\n\n            if (popup.visible() || !this._allowOpening()) {\n                return;\n            }\n\n            if (this._isMultipleSelection()) {\n                popup.element.addClass(\"k-multiple-selection\");\n            }\n            popup.element.addClass(\"k-popup-dropdowntree\");\n\n            popup.one(\"activate\", this._focusInputHandler);\n            popup._hovered = true;\n            popup.open();\n        },\n\n        close: function() {\n            this.popup.close();\n        },\n\n        search: function(word) {\n            var options = this.options;\n            var filter;\n            clearTimeout(this._typingTimeout);\n\n            if ((!options.enforceMinLength && !word.length) || word.length >= options.minLength) {\n                filter = this._getFilter(word);\n                if (this.trigger(\"filtering\", { filter: filter }) ||\n                 Array.isArray(this.options.dataTextField)) {\n                    return;\n                }\n\n                this._filtering = true;\n                this.treeview.dataSource.filter(filter);\n            }\n        },\n\n        _getFilter: function(word) {\n            return {\n                field: this.options.dataTextField,\n                operator: this.options.filter,\n                value: word,\n                ignoreCase: this.options.ignoreCase\n              };\n        },\n\n        refresh: function() {\n            var data = this.treeview.dataSource.flatView();\n            this._renderFooter();\n            this._renderNoData();\n            if (this.filterInput && this.checkAll) {\n                this.checkAll.toggle(!this.filterInput.val().length);\n            }\n\n            this.tree.toggle(!!data.length);\n            $(this.noData).toggle(!data.length);\n        },\n\n        setOptions: function(options) {\n\n            if (this.options.checkboxes != options.checkboxes) {\n                delete options.checkboxes;\n                window.console.warn('setOptions method can not be used to set the checkboxes option in DropDownTree');\n            }\n\n            Widget.fn.setOptions.call(this, options);\n\n            this._setTreeViewOptions(options);\n            this._dataSource();\n            if (this.options.treeview || options.size) {\n                this.treeview.setOptions(this.options.treeview);\n            }\n\n            if (options.height && this.tree) {\n                this.tree.css('max-height', options.height);\n            }\n\n            this._header();\n            this._noData();\n            this._footer();\n\n            this._renderFooter();\n            this._renderNoData();\n            if (this.span && (this._isMultipleSelection() || this.span.hasClass(\"k-readonly\"))) {\n                this._placeholder(true);\n            }\n            this._inputTemplate();\n            this._accessors();\n            this._filterHeader();\n            this._checkAll();\n            this._enable();\n            if (options && (options.enable || options.enabled)) {\n                this.enable(true);\n            }\n            this._clearButton();\n        },\n\n        destroy: function() {\n            kendo.ui.Widget.fn.destroy.call(this);\n            if (this.treeview) {\n                this.treeview.destroy();\n            }\n            this.popup.destroy();\n\n            this.wrapper.off(ns);\n            this._clear.off(ns);\n            if (this.filterInput) {\n                this.filterInput.off(ns);\n            }\n\n            if (this.tagList) {\n                this.tagList.off(ns);\n            }\n\n            kendo.unbind(this.tagList);\n            if (this.options.checkAll && this.checkAll) {\n                this.checkAll.off(ns);\n            }\n\n            if (this._form) {\n                this._form.off(\"reset\", this._resetHandler);\n            }\n        },\n\n        setValue: function(value) {\n            value = Array.isArray(value) || value instanceof ObservableArray ? value.slice(0) : [value];\n\n            this._values = value;\n        },\n\n        items: function() {\n            return this.treeview.items();\n        },\n\n        value: function(value) {\n            var that = this;\n\n            if (value) {\n                if (that.filterInput && that.dataSource._filter) {\n                    that._filtering = true;\n                    that.dataSource.filter({});\n                } else if (!that.dataSource.data().length || !that.treeview.dataSource.data().length) {\n                    if (!that.options.loadOnDemand) {\n                        that.treeview.one('loadCompleted', function() {\n                            that._selection._setValue(value);\n                        });\n\n                        if (!that.options.autoBind && that.options.valuePrimitive) {\n                            that.dataSource.fetch();\n                        }\n                    } else {\n                        that.dataSource.fetch(function() {\n                            that._selection._setValue(value);\n                        });\n                    }\n\n                    return;\n                }\n            }\n\n            return that._selection._setValue(value);\n        },\n\n        text: function(text) {\n            var loweredText;\n            var ignoreCase = this.options.ignoreCase;\n\n            text = text === null ? \"\" : text;\n\n            if (text !== undefined && !this._isMultipleSelection()) {\n                if (typeof text !== \"string\") {\n                    this._textAccessor(text);\n                    return;\n                }\n\n                loweredText = ignoreCase ? text : text.toLowerCase();\n\n                this._selectItemByText(loweredText);\n\n                this._textAccessor(loweredText);\n            } else {\n                return this._textAccessor();\n            }\n        },\n\n        _aria: function() {\n            var input = this.wrapper.find(\"span.k-input-inner\");\n\n            this.wrapper.attr({\n                \"aria-haspopup\": \"tree\",\n                \"aria-expanded\": false,\n                \"aria-controls\": this.treeview.element.attr(\"id\"),\n                \"role\": \"listbox\"\n            });\n\n            this._activeId = kendo.guid();\n            this._ariaLabel(this.wrapper);\n\n            if (this.filterInput && this.options.filterLabel) {\n                this.filterInput.attr(\"aria-label\", this.options.filterLabel);\n            }\n\n            if (!this.options.checkboxes && input.text().length) {\n                input.attr(\"role\", \"option\");\n                input.attr(\"aria-selected\", \"true\");\n                input.attr(\"id\", this._activeId);\n\n                this.wrapper.attr(\"aria-activedescendant\", this._activeId);\n            } else if (this.options.checkboxes) {\n                this.wrapper.attr({\n                    \"aria-multiselectable\": true,\n                    \"aria-describedby\": this.tagList[0].id\n                });\n\n                this.tagList.attr(\"role\", \"none\");\n            }\n        },\n\n        _header: function() {\n            var list = this;\n            var header = $(list.header);\n            var template = list.options.headerTemplate;\n\n            this._angularElement(header, \"cleanup\");\n            kendo.destroy(header);\n            header.remove();\n\n            if (!template) {\n                list.header = null;\n                return;\n            }\n\n            var headerTemplate = typeof template !== \"function\" ? kendo.template(template) : template;\n            header = $(headerTemplate({}));\n\n            list.header = header[0] ? header : null;\n            list.list.prepend(header);\n\n            this._angularElement(list.header, \"compile\");\n        },\n\n        _noData: function() {\n            var list = this;\n            var noData = $(list.noData);\n            var template = list.options.noDataTemplate === true ? list.options.messages.noData : list.options.noDataTemplate;\n\n            list.angular(\"cleanup\", function() { return { elements: noData }; });\n            kendo.destroy(noData);\n            noData.remove();\n\n            if (!template) {\n                list.noData = null;\n                return;\n            }\n\n            list.noData = $('<div class=\"k-no-data\" style=\"display: none;\"></div>').appendTo(list.list);\n            list.noDataTemplate = typeof template !== \"function\" ? kendo.template(template) : template;\n        },\n\n        _renderNoData: function() {\n            var list = this;\n            var noData = list.noData;\n\n            if (!noData) {\n                return;\n            }\n\n            this._angularElement(noData, \"cleanup\");\n            noData.html(list.noDataTemplate({ instance: list }));\n            this._angularElement(noData, \"compile\");\n        },\n\n        _footer: function() {\n            var list = this;\n            var footer = $(list.footer);\n            var template = list.options.footerTemplate;\n\n            this._angularElement(footer, \"cleanup\");\n            kendo.destroy(footer);\n            footer.remove();\n\n            if (!template) {\n                list.footer = null;\n                return;\n            }\n\n            list.footer = $('<div class=\"k-footer\"></div>').appendTo(list.list);\n            list.footerTemplate = typeof template !== \"function\" ? kendo.template(template) : template;\n        },\n\n        _renderFooter: function() {\n            var list = this;\n            var footer = list.footer;\n\n            if (!footer) {\n                return;\n            }\n\n            this._angularElement(footer, \"cleanup\");\n            footer.html(list.footerTemplate({ instance: list }));\n            this._angularElement(footer, \"compile\");\n        },\n\n        _enable: function() {\n            var that = this,\n                options = that.options,\n                disabled = that.element.is(\"[disabled]\");\n\n            if (options.enable !== undefined) {\n                options.enabled = options.enable;\n            }\n\n            if (!options.enabled || disabled) {\n                that.enable(false);\n            } else {\n                that.readonly(that.element.is(\"[readonly]\"));\n            }\n        },\n\n        _adjustListWidth: function() {\n            var that = this,\n                list = that.list,\n                width = list[0].style.width,\n                wrapper = that.wrapper,\n                computedStyle, computedWidth;\n\n            if (!list.data(WIDTH) && width) {\n                return;\n            }\n\n            computedStyle = window.getComputedStyle ? window.getComputedStyle(wrapper[0], null) : 0;\n            computedWidth = parseFloat(computedStyle && computedStyle.width) || outerWidth(wrapper);\n\n            if (computedStyle && browser.msie) { // getComputedStyle returns different box in IE.\n                computedWidth += parseFloat(computedStyle.paddingLeft) + parseFloat(computedStyle.paddingRight) + parseFloat(computedStyle.borderLeftWidth) + parseFloat(computedStyle.borderRightWidth);\n            }\n\n            if (list.css(\"box-sizing\") !== \"border-box\") {\n                width = computedWidth - (outerWidth(list) - list.width());\n            } else {\n                width = computedWidth;\n            }\n\n            list.css({\n                fontFamily: wrapper.css(\"font-family\"),\n                width: that.options.autoWidth ? \"auto\" : width,\n                minWidth: width,\n                whiteSpace: that.options.autoWidth ? \"nowrap\" : \"normal\"\n            })\n            .data(WIDTH, width);\n\n            return true;\n        },\n\n        _reset: function() {\n            var that = this,\n                element = that.element,\n                formId = element.attr(\"form\"),\n                form = formId ? $(\"#\" + formId) : element.closest(\"form\");\n\n            if (form[0]) {\n                that._resetHandler = function() {\n                    setTimeout(function() {\n                        that.value(that._initial);\n                    });\n                };\n\n                that._form = form.on(\"reset\", that._resetHandler);\n            }\n        },\n\n        _popup: function() {\n            var list = this;\n\n            if (list.options.checkboxes && list.options.checkAll) {\n                list.list.attr(\"role\", \"application\");\n            }\n\n            list.popup = new ui.Popup(list.list, extend({}, list.options.popup, {\n                anchor: list.wrapper,\n                open: list._openHandler.bind(list),\n                close: list._closeHandler.bind(list),\n                animation: list.options.animation,\n                isRtl: support.isRtl(list.wrapper),\n                autosize: list.options.autoWidth\n            }));\n        },\n\n        _angularElement: function(element, action) {\n            if (!element) {\n                return;\n            }\n\n            this.angular(action, function() {\n                return { elements: element };\n            });\n        },\n\n        _allowOpening: function() {\n            return this.options.noDataTemplate || this.treeview.dataSource.flatView().length;\n        },\n\n        _placeholder: function(show) {\n            if (this.span) {\n                this.span.toggleClass(\"k-readonly\", show).text(show ? this.options.placeholder : \"\");\n            }\n\n            if (this.span.text().trim().length > 0) {\n                this.span.parent().attr({\n                    role: \"option\",\n                    \"aria-selected\": true\n                });\n            } else {\n                this.span.parent().removeAttr(\"role\");\n                this.span.parent().removeAttr(\"aria-selected\");\n            }\n        },\n\n        _currentValue: function(dataItem) {\n            var currentValue = this._value(dataItem);\n            if (!currentValue && currentValue !== 0) {\n                currentValue = dataItem;\n            }\n\n            return currentValue;\n        },\n\n        _checkValue: function(dataItem) {\n            var value = \"\";\n            var indexOfValue = -1;\n            var currentValue = this.value();\n            var isMultiple = this.options.tagMode === \"multiple\";\n\n            if (dataItem || dataItem === 0) {\n                if (dataItem.level) {\n                    dataItem._level = dataItem.level();\n                }\n\n                value = this._currentValue(dataItem);\n\n                indexOfValue = currentValue.indexOf(value);\n            }\n\n            if (dataItem.checked) {\n                var alreadyAddedTag = $.grep(this._tags, function( item ) {\n                    return item.uid === dataItem._tagUid;\n                });\n\n                if (alreadyAddedTag.length) {\n                    return;\n                }\n\n                var itemToAdd = new ObservableObject(dataItem.toJSON());\n                dataItem._tagUid = itemToAdd.uid;\n                this._tags.push(itemToAdd);\n\n                if (this._tags.length === 1) {\n                    this.span.hide();\n\n                    if (!isMultiple) {\n                        this._multipleTags.push(itemToAdd);\n                    }\n                }\n\n                if (indexOfValue === -1) {\n                    currentValue.push(value);\n                    this.setValue(currentValue);\n                }\n            } else {\n                var itemToRemove = this._tags.find(function(item) {\n                    return item.uid === dataItem._tagUid;\n                });\n\n                var idx = this._tags.indexOf(itemToRemove);\n\n                if (idx !== -1) {\n                    this._tags.splice(idx, 1);\n                } else {\n                    this._treeViewCheckAllCheck(dataItem);\n                    return;\n                }\n\n                if (this._tags.length === 0) {\n                    this.span.show();\n                    if (!isMultiple) {\n                        this._multipleTags.splice(0, 1);\n                    }\n                }\n                if (indexOfValue !== -1) {\n                    currentValue.splice(indexOfValue, 1);\n                    this.setValue(currentValue);\n                }\n            }\n\n            this._treeViewCheckAllCheck(dataItem);\n            if (!this._preventChangeTrigger && !this._valueMethodCalled && !this._noInitialValue) {\n                this.trigger(CHANGE);\n            }\n\n            if (this.options.autoClose && this.popup.visible()) {\n                this.close();\n                this.wrapper.trigger(\"focus\");\n            }\n            this.popup.position();\n            this._toggleCloseVisibility();\n            this._updateSelectedOptions();\n        },\n\n        _updateSelectedOptions: function() {\n            if (this.element[0].tagName.toLowerCase() !== 'select') {\n                return;\n            }\n\n            var selectedItems = this._tags;\n            var options = '';\n            var dataItem = null;\n            var value = null;\n\n            if (selectedItems.length) {\n                for (var idx = 0; idx < selectedItems.length; idx++) {\n                    dataItem = selectedItems[idx];\n\n                    value = this._value(dataItem);\n                    options += this._option(value, this._text(dataItem), true);\n                }\n            }\n\n            this.element.html(options);\n        },\n\n        _option: function(dataValue, dataText, selected) {\n            var option = \"<option\";\n\n            if (dataValue !== undefined) {\n                dataValue += \"\";\n\n                if (dataValue.indexOf('\"') !== -1) {\n                    dataValue = dataValue.replace(quotRegExp, \"&quot;\");\n                }\n\n                option += ' value=\"' + dataValue + '\"';\n            }\n\n            if (selected) {\n                option += ' selected';\n            }\n\n            option += \">\";\n\n            if (dataText !== undefined) {\n                option += kendo.htmlEncode(dataText);\n            }\n\n            return option += \"</option>\";\n        },\n\n        _selectValue: function(dataItem) {\n            var value = \"\";\n            var text = \"\";\n\n            if (dataItem || dataItem === 0) {\n                if (dataItem.level) {\n                    dataItem._level = dataItem.level();\n                }\n                text = this._text(dataItem) || dataItem;\n                value = this._currentValue(dataItem);\n            }\n\n            if (value === null) {\n                value = \"\";\n            }\n            this.setValue(value);\n            this._textAccessor(text, dataItem);\n            this._accessor(value);\n\n            if (!this._preventChangeTrigger && !this._valueMethodCalled) {\n                this.trigger(CHANGE);\n            }\n            this._valueMethodCalled = false;\n\n            if (this.options.autoClose && this.popup.visible()) {\n                this.close();\n                this.wrapper.trigger(\"focus\");\n            }\n            this.popup.position();\n            this._toggleCloseVisibility();\n        },\n\n        _clearClick: function(e) {\n            e.stopPropagation();\n            this.wrapper.trigger(\"focus\");\n            this._clearTextAndValue();\n        },\n\n        _clearTextAndValue: function() {\n            this.setValue([]);\n            this._clearInput();\n            this._clearText();\n            this._selection._clearValue();\n            this.popup.position();\n            this._toggleCloseVisibility();\n        },\n\n        _clearText: function() {\n            if (this.options.placeholder) {\n                this._placeholder(true);\n            } else {\n                if (this.span) {\n                    this.span.html(\"\");\n                }\n            }\n        },\n\n        _inputTemplate: function() {\n            var template = this.options.valueTemplate;\n\n            if (!template) {\n                template = kendo.template('#:this._text(data)#', { useWithBlock: false }).bind(this);\n            } else {\n                template = kendo.template(template);\n            }\n\n            this.valueTemplate = template;\n        },\n\n        _assignInstance: function(text, value) {\n            var dataTextField = this.options.dataTextField;\n            var dataItem = {};\n\n            if (dataTextField) {\n                assign(dataItem, dataTextField.split(DOT), text);\n                assign(dataItem, this.options.dataValueField.split(DOT), value);\n                dataItem = new ObservableObject(dataItem);\n            } else {\n                dataItem = text;\n            }\n\n            return dataItem;\n        },\n\n        _textAccessor: function(text, dataItem) {\n            var valueTemplate = this.valueTemplate;\n            var span = this.span;\n\n            if (text === undefined) {\n                return span.text();\n            }\n\n            span.removeClass(\"k-readonly\");\n\n            if (!dataItem && ($.isPlainObject(text) || text instanceof ObservableObject)) {\n                dataItem = text;\n            }\n\n            if (!dataItem) {\n                dataItem = this._assignInstance(text, this._accessor());\n            }\n\n            var getElements = function() {\n                return {\n                    elements: span.get(),\n                    data: [ { dataItem: dataItem } ]\n                };\n            };\n\n            this.angular(\"cleanup\", getElements);\n\n            try {\n                span.html(valueTemplate(dataItem));\n            } catch (e) {\n                //dataItem has missing fields required in custom template\n                if (span) {\n                    span.html(\"\");\n                }\n            }\n\n            this.angular(\"compile\", getElements);\n        },\n\n        _accessors: function() {\n            var element = this.element;\n            var options = this.options;\n            var getter = kendo.getter;\n            var textField = element.attr(kendo.attr(\"text-field\"));\n            var valueField = element.attr(kendo.attr(\"value-field\"));\n\n            var getterFunction = function(field) {\n                if (Array.isArray(field)) {\n                    var count = field.length;\n                    var levels = $.map(field, function(x) {\n                        return function(d) { return d[x];};\n                    });\n\n                    return function(dataItem) {\n                        var level = dataItem._level;\n\n                        if (!level && level !== 0) {\n                            return;\n                        }\n\n                        return levels[Math.min(level, count - 1)](dataItem);\n                    };\n                } else {\n                    return getter(field);\n                }\n            };\n\n            if (!options.dataTextField && textField) {\n                options.dataTextField = textField;\n            }\n\n            if (!options.dataValueField && valueField) {\n                options.dataValueField = valueField;\n            }\n\n            options.dataTextField = options.dataTextField || \"text\";\n            options.dataValueField = options.dataValueField || \"value\";\n\n            this._text = getterFunction(options.dataTextField);\n            this._value = getterFunction(options.dataValueField);\n        },\n\n        _accessor: function(value, idx) {\n            return this._accessorInput(value, idx);\n        },\n\n        _accessorInput: function(value) {\n            var element = this.element[0];\n\n            if (value === undefined) {\n                return element.value;\n            } else {\n                if (value === null) {\n                    value = \"\";\n                }\n                element.value = value;\n            }\n        },\n\n        _clearInput: function() {\n            var element = this.element[0];\n            element.value = \"\";\n        },\n\n        _clearButton: function() {\n            var clearTitle = this.options.messages.clear;\n\n            if (!this._clear) {\n                this._clear = $('<span unselectable=\"on\" class=\"k-clear-value\" title=\"' + clearTitle + '\"><span class=\"k-icon k-i-x\"></span></span>').attr({\n                    \"role\": \"button\",\n                    \"tabIndex\": -1\n                });\n            }\n\n            if (this.options.clearButton) {\n                this._clear.insertAfter(this.tagList || this.span.parent());\n                this.wrapper.addClass(\"k-dropdowntree-clearable\");\n            } else {\n                if (!this.options.clearButton) {\n                    this._clear.remove();\n                }\n            }\n        },\n\n        _toggleCloseVisibility: function() {\n            var isReadOnly = this.element.attr(READONLY);\n            var hasValue = (this.value() && !this._isMultipleSelection()) || this.value().length;\n            var valueDoesNotEqualPlaceHolder = this.element.val() && this.element.val() !== this.options.placeholder;\n\n            if ((!isReadOnly && (hasValue || valueDoesNotEqualPlaceHolder))) {\n                this._showClear();\n            } else {\n                this._hideClear();\n            }\n        },\n\n        _showClear: function() {\n            if (this._clear) {\n                this._clear.removeClass(HIDDENCLASS);\n            }\n        },\n\n        _hideClear: function() {\n            if (this._clear) {\n                this._clear.addClass(HIDDENCLASS);\n            }\n        },\n\n        _openHandler: function(e) {\n            this._adjustListWidth();\n\n            if (this.trigger(OPEN)) {\n                e.preventDefault();\n            } else {\n                 this.wrapper.attr(\"aria-expanded\", true);\n                 this.tree.attr(\"aria-hidden\", false).attr(\"role\", \"tree\");\n            }\n        },\n\n        _closeHandler: function(e) {\n            if (this.trigger(CLOSE)) {\n                e.preventDefault();\n            } else {\n                 this.wrapper.attr(\"aria-expanded\", false);\n                 this.tree.attr(\"aria-hidden\", true);\n            }\n        },\n\n        _treeview: function() {\n            var that = this;\n            if (that.options.height) {\n                that.tree.css('max-height',that.options.height);\n            }\n            that.tree.attr('id', kendo.guid());\n            that.treeview = new TreeView(that.tree, extend({ size: that.options.size }, that.options.treeview), that);\n            that.dataSource = that.treeview.dataSource;\n\n            that.treeview.bind(\"select\",function(e) {\n                that.trigger(\"select\", e);\n            });\n        },\n\n        _treeViewDataBound: function(e) {\n            if (e.node && this._prev && this._prev.length) {\n                e.sender.expand(e.node);\n            }\n\n            if (this._filtering) {\n                if (!e.node) {\n                    this._filtering = false;\n                }\n\n                if (!this._isMultipleSelection()) {\n                    this._deselectItem(e);\n                }\n                return;\n            }\n\n            if (!this.treeview) {\n                this.treeview = e.sender;\n            }\n\n            if (!e.node) {\n                var rootItems = e.sender.dataSource.data();\n\n                this._checkLoadedItems(rootItems);\n                if (this._noInitialValue) {\n                    this._noInitialValue = false;\n                }\n            } else {\n                var rootItem = e.sender.dataItem(e.node);\n                if (rootItem) {\n                    var subItems = rootItem.children.data();\n                    this._checkLoadedItems(subItems);\n                }\n            }\n            this.trigger(\"dataBound\", e);\n        },\n\n        _deselectItem: function(e) {\n            var items = [];\n            if (!e.node) {\n                items = e.sender.dataSource.data();\n            } else {\n                var rootItem = e.sender.dataItem(e.node);\n                if (rootItem) {\n                    items = rootItem.children.data();\n                }\n            }\n\n            for (var i = 0; i < items.length; i++) {\n                if (items[i].selected &&\n                    !this._valueComparer(items[i], this.value())) {\n                    items[i].set(\"selected\", false);\n                }\n            }\n        },\n\n        _checkLoadedItems: function(items) {\n            var value = this.value();\n\n            if (!items) {\n                return;\n            }\n\n            for (var idx = 0; idx < items.length; idx++) {\n                this._selection._checkLoadedItem(items[idx], value);\n            }\n        },\n\n        _treeViewCheckAllCheck: function(dataItem) {\n            if (this.options.checkAll && this.checkAll) {\n                this._getAllChecked();\n\n                if (dataItem.checked) {\n                    this._checkCheckAll();\n                } else {\n                    this._uncheckCheckAll();\n                }\n            }\n        },\n\n        _checkCheckAll: function() {\n            var checkAllCheckbox = this.checkAll.find('.k-checkbox');\n\n            if (this._allItemsAreChecked) {\n                checkAllCheckbox.prop('checked', true)\n                                .prop('indeterminate', false);\n            } else {\n                checkAllCheckbox.prop('indeterminate', true);\n            }\n        },\n\n        _uncheckCheckAll: function() {\n            var checkAllCheckbox = this.checkAll.find('.k-checkbox');\n\n            if (this._allItemsAreUnchecked) {\n                checkAllCheckbox.prop('checked', false)\n                                .prop('indeterminate', false);\n            } else {\n                checkAllCheckbox.prop('indeterminate', true);\n            }\n        },\n\n        _filterHeader: function() {\n            var filterTemplate = '<div class=\"k-list-filter\">' +\n                '<span class=\"k-searchbox k-input k-input-md k-rounded-md k-input-solid\" type=\"text\" autocomplete=\"off\">' +\n                    '<span class=\"k-input-icon k-icon k-i-search\"></span>' +\n                '</span>' +\n            '</div>';\n\n            if (this.filterInput) {\n                this.filterInput\n                    .off(ns)\n                    .parent()\n                    .remove();\n\n                this.filterInput = null;\n            }\n\n            if (this._isFilterEnabled()) {\n                this._disableCheckChildren();\n\n                this.filterInput = $('<input class=\"k-input-inner\" type=\"text\" />')\n                    .attr({\n                        placeholder: this.element.attr(\"placeholder\"),\n                        title: this.element.attr(\"title\"),\n                        role: \"searchbox\",\n                        \"aria-haspopup\": \"listbox\",\n                        \"aria-autocomplete\": \"list\"\n                    });\n\n                this.filterInput.on(\"input\" , this._filterChange.bind(this));\n\n                $(filterTemplate)\n                    .insertBefore(this.tree)\n                    .find(\".k-searchbox\")\n                    .append(this.filterInput);\n            }\n        },\n\n        _filterChange: function() {\n            if (this.filterInput) {\n                this._search();\n            }\n        },\n\n        _disableCheckChildren: function() {\n            if (this._isMultipleSelection() && this.options.treeview.checkboxes && this.options.treeview.checkboxes.checkChildren) {\n                this.options.treeview.checkboxes.checkChildren = false;\n            }\n        },\n\n        _checkAll: function() {\n            if (this.checkAll) {\n                this.checkAll.find(\".k-checkbox-label, .k-checkbox\")\n                    .off(ns);\n                this.checkAll.remove();\n\n                this.checkAll = null;\n            }\n\n            if (this._isMultipleSelection() && this.options.checkAll) {\n                var checkAllCheckbox = html.renderCheckBox(extend({}, this.options, {\n                    label: \"Check All\",\n                    rounded: \"medium\"\n                }));\n                this.checkAll = $('<div class=\"k-check-all\">' + checkAllCheckbox + '</div>').insertBefore(this.tree);\n                this.checkAll.find(\".k-checkbox-label\").html(kendo.template(this.options.checkAllTemplate)({ instance: this }));\n                this.checkAll.find(\".k-checkbox\")\n                                .on(\"change\" + ns, this._changeCheckAll.bind(this))\n                                .on(\"keydown\" + ns, this._keydownCheckAll.bind(this));\n                this._disabledCheckedItems = [];\n                this._disabledUnCheckedItems = [];\n\n                this._getAllChecked();\n\n                if (!this._allItemsAreUnchecked) {\n                    this._checkCheckAll();\n                }\n            }\n        },\n\n        _changeCheckAll: function() {\n            var checkAllCheckbox = this.checkAll.find('.k-checkbox');\n            var isChecked = checkAllCheckbox.prop('checked');\n\n            this._updateCheckAll(isChecked);\n        },\n\n        _updateCheckAll: function(isChecked) {\n            var checkAllCheckbox = this.checkAll.find('.k-checkbox');\n            this._toggleCheckAllItems(isChecked);\n            checkAllCheckbox.prop('checked', isChecked);\n            if (this._disabledCheckedItems.length && this._disabledUnCheckedItems.length) {\n                checkAllCheckbox.prop('indeterminate', true);\n            } else if (this._disabledCheckedItems.length) {\n                checkAllCheckbox.prop('indeterminate', !isChecked);\n            } else if (this._disabledUnCheckedItems.length) {\n                checkAllCheckbox.prop('indeterminate', isChecked);\n            } else {\n                checkAllCheckbox.prop('indeterminate', false);\n            }\n            this._disabledCheckedItems = [];\n            this._disabledUnCheckedItems = [];\n        },\n\n        _keydownCheckAll: function(e) {\n            var key = e.keyCode;\n            var altKey = e.altKey;\n\n            if ((altKey && key === keys.UP) || key === keys.ESC || key === keys.TAB) {\n                this.close();\n                this.wrapper.trigger(\"focus\");\n                e.preventDefault();\n                return;\n            }\n\n            if (key === keys.UP) {\n                if (this.filterInput) {\n                    this.filterInput.trigger(\"focus\");\n                } else {\n                    this.wrapper.trigger(\"focus\");\n                }\n\n                e.preventDefault();\n            }\n\n            if (key === keys.DOWN) {\n                if (this.tree && this.tree.is(\":visible\")) {\n                    this.tree.focus();\n                }\n\n                e.preventDefault();\n            }\n\n            if (key === keys.SPACEBAR && (browser.msie || browser.edge)) {\n                this._clickCheckAll();\n                e.preventDefault();\n            }\n        },\n\n        _clickCheckAll: function() {\n            var checkAllCheckbox = this.checkAll.find('.k-checkbox');\n            var isChecked = checkAllCheckbox.prop('checked');\n\n            this._updateCheckAll(!isChecked);\n\n            checkAllCheckbox.trigger(\"focus\");\n\n        },\n        //treeview\n        _dfs: function(items, action, prop) {\n            for (var idx = 0; idx < items.length; idx++) {\n                if (!this[action](items[idx], prop)) {\n                    break;\n                }\n                this._traverceChildren(items[idx], action, prop);\n            }\n        },\n\n        _uncheckItemByUid: function(uid) {\n            this._dfs(this.dataSource.data(), '_uncheckItemEqualsUid', uid);\n        },\n\n        _uncheckItemEqualsUid: function(item, uid) {\n            if (item.enabled !== false && item._tagUid == uid) {\n                item.set(\"checked\", false);\n                return false;\n            }\n            return true;\n        },\n\n        _selectItemByText: function(text) {\n            this._dfs(this.dataSource.data(), '_itemEqualsText', text);\n        },\n\n        _itemEqualsText: function(item, text) {\n            if (item.enabled !== false && this._text(item) === text) {\n                this.treeview.select(this.treeview.findByUid(item.uid));\n                this._selectValue(item);\n                return false;\n            }\n            return true;\n        },\n\n        _selectItemByValue: function(value) {\n            this._dfs(this.dataSource.data(), '_itemEqualsValue', value);\n        },\n\n        _itemEqualsValue: function(item, value) {\n            if (item.enabled !== false && this._valueComparer(item, value)) {\n\n                this.treeview.select(this.treeview.findByUid(item.uid));\n\n                return false;\n            }\n            return true;\n        },\n\n        _checkItemByValue: function(value) {\n            var items = this.treeview.dataItems();\n            for (var idx = 0; idx < value.length; idx++) {\n                this._dfs(items, '_checkItemEqualsValue', value[idx]);\n            }\n        },\n\n        _checkItemEqualsValue: function(item, value) {\n            if (item.enabled !== false && this._valueComparer(item, value)) {\n                    item.set(\"checked\", true);\n                return false;\n            }\n            return true;\n        },\n\n        _valueComparer: function(item, value) {\n            var itemValue = this._value(item);\n            var itemText;\n\n            if (!this._isNullorUndefined(itemValue)) {\n                if (this._isNullorUndefined(value)) {\n                    return false;\n                }\n\n                var newValue = this._value(value);\n\n                if (newValue) {\n                    return itemValue == newValue;\n                } else {\n                    return itemValue == value;\n                }\n            }\n\n            itemText = this._text(item);\n            if (itemText) {\n                if (this._text(value)) {\n                    return itemText == this._text(value);\n                } else {\n                    return itemText == value;\n                }\n            }\n\n            return false;\n        },\n\n        _isNullorUndefined: function(value) {\n            return value === undefined || value === null;\n        },\n\n        _getAllChecked: function() {\n            this._allCheckedItems = [];\n            this._allItemsAreChecked = true;\n            this._allItemsAreUnchecked = true;\n\n            this._dfs(this.dataSource.data(), '_getAllCheckedItems');\n\n            return this._allCheckedItems;\n        },\n\n        _getAllCheckedItems: function(item) {\n            if (this._allItemsAreChecked) {\n                this._allItemsAreChecked = item.checked;\n            }\n\n            if (this._allItemsAreUnchecked) {\n                this._allItemsAreUnchecked = !item.checked;\n            }\n\n            if (item.checked) {\n                this._allCheckedItems.push(item);\n            }\n            return true;\n        },\n\n        _traverceChildren: function(item, action, prop) {\n            var childrenField = (item._childrenOptions && item._childrenOptions.schema) ? item._childrenOptions.schema.data : null;\n            var subItems = item[childrenField] || item.items || item.children;\n\n            if (!subItems) {\n                return;\n            }\n\n            this._dfs(subItems, action, prop);\n        },\n\n        _toggleCheckAllItems: function(checked) {\n            this._dfs(this.dataSource.data(), '_checkAllCheckItem', checked);\n        },\n\n        _checkAllCheckItem: function(item, checked) {\n            if (item.enabled === false) {\n                if (item.checked) {\n                    this._disabledCheckedItems.push(item);\n                } else {\n                    this._disabledUnCheckedItems.push(item);\n                }\n            } else {\n                item.set(\"checked\", checked);\n            }\n            return true;\n        },\n\n        _isFilterEnabled: function() {\n            var filter = this.options.filter;\n            return filter && filter !== \"none\";\n        },\n\n        _editable: function(options) {\n            var that = this;\n            var element = that.element;\n            var disable = options.disable;\n            var readonly = options.readonly;\n            var wrapper = that.wrapper.add(that.filterInput).off(ns);\n            var dropDownWrapper = that.wrapper.off(HOVEREVENTS);\n            if (that._isMultipleSelection()) {\n                that.tagList.off(CLICK + ns);\n            }\n            if (!readonly && !disable) {\n                element.prop(DISABLED, false).prop(READONLY, false);\n\n                dropDownWrapper\n                    .removeClass(STATEDISABLED)\n                    .on(HOVEREVENTS, that._toggleHover);\n\n                that._clear.on(\"click\" + ns, that._clearClick.bind(that));\n                wrapper\n                    .attr(TABINDEX, wrapper.data(TABINDEX))\n                    .attr(ARIA_DISABLED, false)\n                    .on(\"keydown\" + ns, that._keydown.bind(that))\n                    .on(\"focusin\" + ns, that._focusinHandler.bind(that))\n                    .on(\"focusout\" + ns, that._focusoutHandler.bind(that));\n\n                that.wrapper.on(CLICK + ns, that._wrapperClick.bind(that));\n\n                if (this._isMultipleSelection()) {\n                    that.tagList.on(CLICK + ns, \"span.k-chip\", function(e) {\n                        $(e.currentTarget).addClass(FOCUSED);\n                    });\n\n                    that.tagList.on(CLICK + ns, \".k-i-x-circle\", function(e) {\n                        that._removeTagClick(e);\n                    });\n                }\n            } else if (disable) {\n                wrapper.removeAttr(TABINDEX);\n                dropDownWrapper\n                    .addClass(STATEDISABLED);\n            } else {\n                wrapper\n                    .attr(TABINDEX, wrapper.data(TABINDEX));\n\n                dropDownWrapper\n                    .removeClass(STATEDISABLED);\n\n                wrapper\n                    .on(\"focusin\" + ns, that._focusinHandler.bind(that))\n                    .on(\"focusout\" + ns, that._focusoutHandler.bind(that));\n            }\n\n            element.attr(DISABLED, disable)\n                   .attr(READONLY, readonly);\n\n            wrapper.attr(ARIA_DISABLED, disable);\n        },\n\n        _focusinHandler: function() {\n            this.wrapper.addClass(FOCUSED);\n            this._prevent = false;\n        },\n\n        _focusoutHandler: function() {\n            var that = this;\n\n            if (this._isMultipleSelection()) {\n                this.tagList.find(DOT + FOCUSED).removeClass(FOCUSED);\n            }\n            if (!that._prevent) {\n                this.wrapper.removeClass(FOCUSED);\n                that._prevent = true;\n                that.element.trigger(\"blur\");\n            }\n        },\n\n        _toggle: function(open) {\n            open = open !== undefined ? open : !this.popup.visible();\n\n            this[open ? OPEN : CLOSE]();\n        },\n\n        _wrapperClick: function(e) {\n            e.preventDefault();\n            this.popup.unbind(\"activate\", this._focusInputHandler);\n            this._focused = this.wrapper;\n            this._prevent = false;\n            this._toggle();\n        },\n\n        _toggleHover: function(e) {\n            $(e.currentTarget).toggleClass(HOVER, e.type === \"mouseenter\");\n        },\n\n        _focusInput: function() {\n            if (this.filterInput) {\n                this.filterInput.trigger(\"focus\");\n            } else if (this.checkAll) {\n                this.checkAll.find(\".k-checkbox\").trigger(\"focus\");\n            } else if (this.tree.is(\":visible\")) {\n                this.tree[0].focus({ preventScroll: true });\n                this._ie11PreventScrollOnFocus();\n            }\n        },\n\n        _ie11PreventScrollOnFocus: function() {\n            if (browser.msie && browser.version == 11) {\n                var popup = this.popup;\n                popup._toggleResize(false);\n                setTimeout(function() {\n                    popup._toggleResize(true);\n                },50);\n            }\n        },\n\n        _keydown: function(e) {\n            var key = e.keyCode;\n            var altKey = e.altKey;\n            var isFilterInputActive;\n            var isWrapperActive;\n            var focused, tagItem;\n\n            var isPopupVisible = this.popup.visible();\n\n            if (this.filterInput) {\n                isFilterInputActive = this.filterInput[0] === activeElement();\n            }\n\n            if (this.wrapper) {\n                isWrapperActive = this.wrapper[0] === activeElement();\n            }\n\n            if (isWrapperActive) {\n                if (key === keys.ESC) {\n                    this._clearTextAndValue();\n                    e.preventDefault();\n                    return;\n                }\n\n                if (this._isMultipleSelection()) {\n                    if (key === keys.LEFT) {\n                        this._focusPrevTag();\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (key === keys.RIGHT) {\n                        this._focusNextTag();\n                          e.preventDefault();\n                        return;\n                    }\n\n                    if (key === keys.HOME) {\n                        this._focusFirstTag();\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (key === keys.END) {\n                        this._focusLastTag();\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (key === keys.DELETE) {\n                        focused = this.tagList.find(DOT + FOCUSED).first();\n                        if (focused.length) {\n                            tagItem = this._tags[focused.index()];\n                            this._removeTag(tagItem);\n                        }\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (key === keys.BACKSPACE) {\n                        focused = this.tagList.find(DOT + FOCUSED).first();\n                        if (focused.length) {\n                            tagItem = this._tags[focused.index()];\n                            this._removeTag(tagItem);\n                        } else {\n                            focused = this._focusLastTag();\n                            if (focused.length) {\n                                tagItem = this._tags[focused.index()];\n                                this._removeTag(tagItem);\n                            }\n                        }\n                        e.preventDefault();\n                        return;\n                    }\n                }\n            }\n\n\n            if (isFilterInputActive) {\n                if (key === keys.ESC) {\n                    this._clearFilter();\n                }\n\n                if ((key === keys.UP) && !altKey) {\n                    this.wrapper.trigger(\"focus\");\n                    e.preventDefault();\n                }\n\n                if (browser.msie && browser.version < 10) {\n                    if (key === keys.BACKSPACE || key === keys.DELETE) {\n                        this._search();\n                    }\n                }\n\n                if (key === keys.TAB) {\n                    this.close();\n                    this.wrapper.trigger(\"focus\");\n                    e.preventDefault();\n                    return;\n                }\n            }\n\n            if ((altKey && key === keys.UP) || key === keys.ESC) {\n                this.close();\n                this.wrapper.trigger(\"focus\");\n                e.preventDefault();\n                return;\n            }\n\n            if (key === keys.ENTER && this._typingTimeout && this.filterInput && isPopupVisible) {\n                e.preventDefault();\n                return;\n            }\n\n            if (key === keys.SPACEBAR && !isFilterInputActive) {\n                this._toggle(!isPopupVisible);\n                e.preventDefault();\n            }\n\n            if ((altKey && key === keys.DOWN) && !isPopupVisible) {\n                this.open();\n                e.preventDefault();\n            }\n\n            if ((key === keys.DOWN) && isPopupVisible) {\n                if (this.filterInput && !isFilterInputActive) {\n                    this.filterInput.trigger(\"focus\");\n                } else if (this.checkAll && this.checkAll.is(\":visible\")) {\n                    this.checkAll.find('input').trigger(\"focus\");\n                } else if (this.tree.is(\":visible\")) {\n                    this.tree[0].focus({ preventScroll: true });\n                    this._ie11PreventScrollOnFocus();\n                }\n                e.preventDefault();\n            }\n\n            if (key === keys.TAB && isPopupVisible) {\n                this.close();\n                this.wrapper.trigger(\"focus\");\n                e.preventDefault();\n            }\n        },\n\n        _focusPrevTag: function() {\n            var focused = this.tagList.find(DOT + FOCUSED);\n            if (focused.length) {\n                var activedescendant = this._activeId;\n\n                focused.first()\n                    .removeClass(FOCUSED)\n                    .removeAttr(\"id\")\n                    .prev(CHIP)\n                    .addClass(FOCUSED)\n                    .attr(\"id\", activedescendant);\n\n                this.wrapper.attr(\"aria-activedescendant\", activedescendant);\n            } else {\n                this._focusLastTag();\n            }\n        },\n\n        _focusNextTag: function() {\n            var focused = this.tagList.find(DOT + FOCUSED);\n\n            if (focused.length) {\n                var activedescendant = this._activeId;\n\n                focused.first()\n                    .removeClass(FOCUSED)\n                    .removeAttr(\"id\")\n                    .next(CHIP)\n                    .addClass(FOCUSED)\n                    .attr(\"id\", activedescendant);\n\n                this.wrapper.attr(\"aria-activedescendant\", activedescendant);\n            } else {\n                this._focusFirstTag();\n            }\n        },\n\n        _focusFirstTag: function() {\n            var activedescendant = this._activeId;\n\n            this._clearDisabledTag();\n\n            var firstTag = this.tagList.children(CHIP).first()\n                .addClass(FOCUSED)\n                .attr(\"id\", activedescendant);\n\n            this.wrapper.attr(\"aria-activedescendant\", activedescendant);\n\n            return firstTag;\n        },\n\n        _focusLastTag: function() {\n            var activedescendant = this._activeId;\n\n            this._clearDisabledTag();\n\n            var lastTag = this.tagList.children(CHIP).last()\n                .addClass(FOCUSED)\n                .attr(\"id\", activedescendant);\n\n            this.wrapper.attr(\"aria-activedescendant\", activedescendant);\n\n            return lastTag;\n        },\n\n        _clearDisabledTag: function() {\n            this.tagList.find(DOT + FOCUSED).removeClass(FOCUSED).removeAttr(\"id\");\n        },\n\n        _search: function() {\n            var that = this;\n            clearTimeout(that._typingTimeout);\n\n            that._typingTimeout = setTimeout(function() {\n                var value = that.filterInput.val();\n\n                if (that._prev !== value) {\n                    that._prev = value;\n                    that.search(value);\n                }\n\n                that._typingTimeout = null;\n            }, that.options.delay);\n        },\n\n        _clearFilter: function() {\n            if (this.filterInput.val().length) {\n                this.filterInput.val(\"\");\n                this._prev = \"\";\n                this._filtering = true;\n                this.treeview.dataSource.filter({});\n            }\n        },\n\n        _removeTagClick: function(e) {\n            e.stopPropagation();\n            var tagItem = this._tags[$(e.currentTarget.closest(CHIP)).index()];\n            this._removeTag(tagItem);\n        },\n\n        _removeTag: function(tagItem) {\n           if (!tagItem) {\n                return;\n           }\n\n           var uid = tagItem.uid;\n           this._uncheckItemByUid(uid);\n        }\n    });\n\n    function assign(instance, fields, value) {\n        var idx = 0,\n            lastIndex = fields.length - 1,\n            field;\n\n        for (; idx < lastIndex; ++idx) {\n            field = fields[idx];\n\n            if (!(field in instance)) {\n                instance[field] = {};\n            }\n\n            instance = instance[field];\n        }\n\n        instance[fields[lastIndex]] = value;\n    }\n\n    ui.plugin(DropDownTree);\n\n    kendo.cssProperties.registerPrefix(\"DropDownTree\", \"k-picker-\");\n\n    kendo.cssProperties.registerValues(\"DropDownTree\", [{\n        prop: \"rounded\",\n        values: kendo.cssProperties.roundedValues.concat([['full', 'full']])\n    }]);\n\n    kendo.cssProperties.registerPrefix(\"MultiSelectDropDownTree\", \"k-input-\");\n\n    kendo.cssProperties.registerValues(\"MultiSelectDropDownTree\", [{\n        prop: \"rounded\",\n        values: kendo.cssProperties.roundedValues.concat([['full', 'full']])\n    }]);\n\n    var SingleSelection = kendo.Class.extend({\n        init: function(view) {\n            this._dropdowntree = view;\n        },\n\n        _initWrapper: function() {\n            this._wrapper();\n            this._span();\n        },\n\n        _preselect: function(data) {\n            var dropdowntree = this._dropdowntree;\n\n            dropdowntree._selectValue(data);\n        },\n\n        _wrapper: function() {\n            var dropdowntree = this._dropdowntree,\n                element = dropdowntree.element,\n                DOMelement = element[0],\n                wrapper;\n\n            wrapper = element.parent();\n\n            if (!wrapper.is(\"span.k-dropdowntree\")) {\n                wrapper = element.wrap(\"<span />\").parent();\n                wrapper[0].style.cssText = DOMelement.style.cssText;\n                wrapper[0].title = DOMelement.title;\n            }\n\n            dropdowntree._focused = dropdowntree.wrapper = wrapper\n                .addClass(\"k-dropdowntree k-picker\")\n                .addClass(DOMelement.className)\n                .removeClass('input-validation-error')\n                .removeClass('k-invalid')\n                .css(\"display\", \"\")\n                .attr({\n                    accesskey: element.attr(\"accesskey\"),\n                    unselectable: \"on\"\n                });\n\n            element.hide().removeAttr(\"accesskey\");\n        },\n\n        _span: function() {\n            var dropdowntree = this._dropdowntree,\n                wrapper = dropdowntree.wrapper,\n                SELECTOR = \"span.k-input-value-text\",\n                span;\n\n            span = wrapper.find(SELECTOR);\n\n            if (!span[0]) {\n                wrapper.append('<span unselectable=\"on\" class=\"k-input-inner\"><span class=\"k-input-value-text\"></span></span>' +\n                                html.renderButton('<button unselectable=\"on\" class=\"k-input-button\" aria-label=\"select\" tabindex=\"-1\"></button>', extend({}, dropdowntree.options, {\n                                    icon: \"arrow-s\",\n                                    shape: \"none\",\n                                    rounded: \"none\"\n                                })))\n                       .append(dropdowntree.element);\n\n                span = wrapper.find(SELECTOR);\n            }\n\n            dropdowntree.span = span;\n            dropdowntree._arrow = wrapper.find(\".k-input-button\");\n            dropdowntree._arrowIcon = dropdowntree._arrow.find(\".k-icon\");\n        },\n\n        _setValue: function(value) {\n            var dropdowntree = this._dropdowntree;\n            var currentValue;\n\n            if (value === undefined || value === null) {\n                currentValue = dropdowntree._values.slice()[0];\n                value = (typeof currentValue === \"object\") ? currentValue : dropdowntree._accessor() || currentValue;\n                return value === undefined || value === null ? \"\" : value;\n            }\n            dropdowntree._valueMethodCalled = true;\n            if (value.length === 0) {\n                dropdowntree._clearTextAndValue();\n                dropdowntree._valueMethodCalled = false;\n                return;\n            }\n\n            dropdowntree._selectItemByValue(value);\n            dropdowntree._toggleCloseVisibility();\n        },\n\n        _clearValue: function() {\n            var dropdowntree = this._dropdowntree;\n            var selectedNode = dropdowntree.treeview.select();\n\n            if (dropdowntree.treeview.dataItem(selectedNode)) {\n                dropdowntree.treeview.dataItem(selectedNode).set('selected', false);\n                if (!dropdowntree._valueMethodCalled) {\n                    dropdowntree.trigger(CHANGE);\n                }\n            }\n        },\n\n        _checkLoadedItem: function(tempItem, value) {\n            var dropdowntree = this._dropdowntree;\n\n            if (!dropdowntree._isNullorUndefined(value) && value !== \"\") {\n                if (dropdowntree._valueComparer(tempItem, value)) {\n                    dropdowntree._preventChangeTrigger = true;\n                    tempItem.set(\"selected\", true);\n                    dropdowntree._preventChangeTrigger = false;\n                } else if (tempItem.selected) {\n                    dropdowntree.treeview.select(dropdowntree.treeview.findByUid(tempItem.uid));\n                }\n\n            } else if (!value && tempItem.selected) {\n                dropdowntree.treeview.select(dropdowntree.treeview.findByUid(tempItem.uid));\n            }\n        }\n    });\n\n    var MultipleSelection = kendo.Class.extend({\n        init: function(view) {\n            this._dropdowntree = view;\n        },\n\n        _initWrapper: function() {\n            var dropdowntree = this._dropdowntree;\n\n            this._tagTemplate();\n            dropdowntree.element.attr(\"multiple\", \"multiple\").hide();\n            this._wrapper();\n            dropdowntree._tags = new ObservableArray([]);\n            dropdowntree._multipleTags = new ObservableArray([]);\n            this._tagList();\n            dropdowntree.span = $('<span unselectable=\"on\" class=\"k-input-inner\"><span class=\"k-input-value-text\"></span></span>').appendTo(dropdowntree.tagList).find(\".k-input-value-text\");\n\n        },\n\n        _preselect: function(data, value) {\n            var dropdowntree = this._dropdowntree;\n            var valueToSelect = value || dropdowntree.options.value;\n\n            if (!Array.isArray(data) && !(data instanceof kendo.data.ObservableArray)) {\n                data = [data];\n            }\n\n            if ($.isPlainObject(data[0]) || data[0] instanceof kendo.data.ObservableObject || !dropdowntree.options.dataValueField) {\n                dropdowntree.dataSource.data(data);\n\n                dropdowntree.value(valueToSelect);\n            }\n        },\n\n        _tagTemplate: function() {\n            var dropdowntree = this._dropdowntree;\n            var options = dropdowntree.options;\n            var tagTemplate = options.valueTemplate;\n            var isMultiple = options.tagMode === \"multiple\";\n            var singleTag = options.messages.singleTag;\n\n            tagTemplate = tagTemplate ? kendo.template(tagTemplate) : dropdowntree.valueTemplate;\n\n            dropdowntree.valueTemplate = function(data) {\n                return html.renderChip('<span unselectable=\"on\" role=\"option\"' +\n                    'class=\"' + ((data.enabled === false) ? \"k-disabled\" : \"\") + '\"' +\n                    ((data.enabled === false) ? 'aria-disabled=\"true\"' : '') +\n                    '>' +\n                    '</span>', $.extend({}, options, {\n                            fillMode: \"solid\",\n                            themeColor: \"base\",\n                            rounded: \"medium\",\n                            attr: {\n                                unselectable: \"on\"\n                            },\n                            text: (isMultiple ? tagTemplate(data) : ('<span unselectable=\"on\" data-bind=\"text: tags.length\"></span>' +\n                            '<span unselectable=\"on\">&nbsp;' + singleTag + '</span>' )),\n                            removable: isMultiple,\n                            removeIcon: \"x-circle\",\n                            removableAttr: {\n                                unselectable: \"on\",\n                                \"aria-hidden\": true,\n                                \"aria-label\": dropdowntree.options.messages.deleteTag,\n                                title: dropdowntree.options.messages.deleteTag\n                            }\n                        }));\n            };\n        },\n\n        _wrapper: function() {\n            var dropdowntree = this._dropdowntree,\n                element = dropdowntree.element,\n                wrapper = element.parent(\"span.k-dropdowntree\");\n\n            if (!wrapper[0]) {\n                wrapper = element.wrap('<span class=\"k-dropdowntree k-input\" unselectable=\"on\" />').parent();\n                wrapper[0].style.cssText = element[0].style.cssText;\n                wrapper[0].title = element[0].title;\n            }\n\n            dropdowntree.wrapper = wrapper.addClass(element[0].className).css(\"display\", \"\");\n        },\n\n        _tagList: function() {\n            var dropdowntree = this._dropdowntree,\n                tagList = dropdowntree.wrapper.children(\"div.k-input-values\");\n\n            if (!tagList[0]) {\n                var isMultiple = dropdowntree.options.tagMode === \"multiple\";\n                var tagCollection = isMultiple ? \"tags\" : \"multipleTag\";\n\n                tagList = $(html.renderChipList('<div unselectable=\"on\" class=\"k-input-values\" data-template=\"tagTemplate\" data-bind=\"source: ' + tagCollection + '\" />', $.extend({}, dropdowntree.options))).appendTo(dropdowntree.wrapper);\n            }\n\n            dropdowntree.tagList = tagList;\n            dropdowntree.tagList.attr('id', kendo.guid() + \"_tagList\");\n            dropdowntree.wrapper.attr(\"aria-controls\", dropdowntree.tagList.attr('id'));\n            var viewModel = kendo.observable({\n                multipleTag: dropdowntree._multipleTags,\n                tags: dropdowntree._tags,\n                tagTemplate: dropdowntree.valueTemplate\n            });\n            kendo.bind(dropdowntree.tagList, viewModel);\n            dropdowntree.tagList.attr(\"data-stop\", true);\n        },\n\n        _setValue: function(value) {\n            var dropdowntree = this._dropdowntree;\n            var oldValues = dropdowntree._values;\n            if (value === undefined || value === null) {\n                return dropdowntree._values.slice();\n            }\n\n            dropdowntree.setValue(value);\n            dropdowntree._valueMethodCalled = true;\n            if (value.length) {\n                this._removeValues(oldValues, value);\n\n                dropdowntree._checkItemByValue(value);\n            } else {\n                dropdowntree._clearTextAndValue();\n            }\n\n            dropdowntree._valueMethodCalled = false;\n            dropdowntree._toggleCloseVisibility();\n        },\n\n        _removeValues: function(oldValues, value) {\n            var dropdowntree = this._dropdowntree;\n            var removedValues = this._getNewValues(oldValues, value);\n\n            for (var idx = 0; idx < removedValues.length; idx++) {\n                for (var j = 0; j < dropdowntree._tags.length; j++) {\n                    if (dropdowntree._valueComparer(dropdowntree._tags[j],removedValues[idx])) {\n                        dropdowntree._uncheckItemByUid(dropdowntree._tags[j].uid);\n                    }\n                }\n            }\n        },\n\n        _getNewValues: function(oldValues, value) {\n            var removedValues = [];\n\n            for (var idx = 0; idx < oldValues.length; idx++) {\n                if (value.indexOf(oldValues[idx]) === -1) {\n                    removedValues.push(oldValues[idx]);\n                }\n            }\n\n            return removedValues;\n        },\n\n        _clearValue: function() {\n            var dropdowntree = this._dropdowntree;\n            var tagsArray = dropdowntree._tags.slice();\n\n            for (var idx = 0; idx < tagsArray.length; idx++) {\n                var uid = tagsArray[idx].uid;\n                dropdowntree._preventChangeTrigger = true;\n                dropdowntree._uncheckItemByUid(uid);\n            }\n\n            if (tagsArray.length) {\n                dropdowntree._preventChangeTrigger = false;\n                if (!dropdowntree._valueMethodCalled) {\n                    dropdowntree.trigger(CHANGE);\n                }\n            }\n        },\n\n        _checkLoadedItem: function(tempItem, value) {\n            var dropdowntree = this._dropdowntree;\n\n            if (dropdowntree._noInitialValue && tempItem.checked) {\n                dropdowntree._checkValue(tempItem);\n                return;\n            }\n\n            if ((value.length || this._isDataSourceSet) &&\n                (value.indexOf(dropdowntree._currentValue(tempItem)) !== -1 || value.indexOf(tempItem)) !== -1 &&\n                !this._findTag(dropdowntree._currentValue(tempItem))) {\n                if (tempItem.checked) {\n                    dropdowntree._checkValue(tempItem);\n                } else {\n                    dropdowntree._preventChangeTrigger = true;\n                    tempItem.set(\"checked\", true);\n                    dropdowntree._preventChangeTrigger = false;\n                }\n            }\n        },\n\n        _findTag: function(tempItemValue) {\n            var dropdowntree = this._dropdowntree;\n\n            return dropdowntree._tags.find(function(item) {\n                return dropdowntree._valueComparer(item, tempItemValue);\n            });\n        }\n    });\n\n    kendo.ui.DropDownTree.SingleSelection = SingleSelection;\n    kendo.ui.DropDownTree.MultipleSelection = MultipleSelection;\n\n})(window.kendo.jQuery);\n\nreturn window.kendo;\n\n}, typeof define == 'function' && define.amd ? define : function(a1, a2, a3) { (a3 || a2)(); });\n\n"],"names":["define","$","window","kendo","jQuery","undefined","ui","keys","DISABLED","SELECT","CHECKED","DATABOUND","CLICK","NS","INDETERMINATE","NAVIGATE","subGroup","TreeView","contentChild","filter","node","result","children","length","Tree","extend","init","element","options","dropdowntree","that","this","fn","call","_isMultipleSelection","wrapper","on","_clickSelectedItem","bind","_checkOnSelect","e","isDefaultPrevented","dataItem","set","checked","_setCheckedValue","value","_click","one","currentTarget","_trigger","defaultrefresh","action","items","parentNode","loadOnDemand","checkChildren","checkboxes","i","_skip","field","level","_updateNodes","findByUid","uid","_progress","bubble","_appendItems","index","_remove","_refreshChildren","_refreshRoot","expanded","load","attr","find","_ariaItems","trigger","_treeViewDataBound","sender","updateIndeterminate","_previousVisible","lastChild","prev","root","last","_expanded","parent","checkAll","is","filterInput","_keydown","key","keyCode","target","focused","current","checkbox","first","rtl","support","isRtl","RIGHT","LEFT","_nextVisible","hasClass","expand","collapse","_enabled","DOWN","UP","altKey","HOME","END","ENTER","select","SPACEBAR","prop","data","_checkboxChange","ESC","_closePopup","TAB","preventDefault","close","refresh","skipUpdateOnBind","_checkValue","selected","_selectValue","_dropdowntree","amd","a1","a2","a3","__meta__","id","name","category","description","depends","html","Widget","ObservableArray","ObservableObject","activeElement","_activeElement","ns","HIDDENCLASS","WIDTH","browser","outerWidth","_outerWidth","DOT","READONLY","STATEDISABLED","ARIA_DISABLED","HOVER","FOCUSED","HOVEREVENTS","TABINDEX","OPEN","CLOSE","CHANGE","quotRegExp","CHIP","DropDownTree","_selection","_getSelection","_focusInputHandler","_focusInput","_initial","val","_values","_noInitialValue","_isNullorUndefined","_valueMethodCalled","Array","isArray","slice","_inputTemplate","_accessors","_setTreeViewOptions","_dataSource","_initWrapper","_applyCssClasses","_placeholder","_tabindex","tree","tabIndex","aria-hidden","list","append","_header","_noData","_footer","_reset","_popup","popup","_popupOpen","_clearButton","_filterHeader","_treeview","_renderFooter","_checkAll","_enable","_toggleCloseVisibility","_aria","autoBind","text","_preselect","_textAccessor","placeholder","disabled","parents","enable","notify","treeviewOptions","dataImageUrlField","dataSpriteCssClassField","dataTextField","dataUrlField","size","treeview","template","rootDataSource","dataSource","HierarchicalDataSource","create","wrap","_altname","MultipleSelection","SingleSelection","setDataSource","_isDataSourceSet","_tags","setValue","empty","span","show","_multipleTags","animation","autoClose","autoWidth","clearButton","dataValueField","delay","enabled","enforceMinLength","height","ignoreCase","messages","singleTag","clear","deleteTag","noData","minLength","noDataTemplate","checkAllTemplate","tagMode","valuePrimitive","footerTemplate","headerTemplate","valueTemplate","filterLabel","fillMode","rounded","events","focus","readonly","_editable","disable","toggle","open","_toggle","_isFilterEnabled","_search","fetch","visible","_allowOpening","addClass","_hovered","search","word","clearTimeout","_typingTimeout","_getFilter","_filtering","operator","flatView","_renderNoData","setOptions","console","warn","css","destroy","off","_clear","tagList","unbind","_form","_resetHandler","_filter","_setValue","loweredText","toLowerCase","_selectItemByText","input","aria-haspopup","aria-expanded","aria-controls","role","_activeId","guid","_ariaLabel","aria-multiselectable","aria-describedby","header","_angularElement","remove","prepend","angular","elements","appendTo","instance","footer","_adjustListWidth","width","style","computedStyle","computedWidth","getComputedStyle","parseFloat","msie","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","fontFamily","minWidth","whiteSpace","formId","form","closest","setTimeout","Popup","anchor","_openHandler","_closeHandler","autosize","toggleClass","trim","aria-selected","removeAttr","_currentValue","currentValue","_value","indexOfValue","isMultiple","_level","indexOf","alreadyAddedTag","grep","item","_tagUid","itemToAdd","toJSON","push","hide","itemToRemove","idx","splice","_treeViewCheckAllCheck","_preventChangeTrigger","position","_updateSelectedOptions","tagName","selectedItems","_option","_text","dataValue","dataText","option","replace","htmlEncode","_accessor","_clearClick","stopPropagation","_clearTextAndValue","_clearInput","_clearText","_clearValue","useWithBlock","_assignInstance","assign","split","removeClass","isPlainObject","getElements","get","getter","textField","valueField","getterFunction","count","levels","map","x","d","Math","min","_accessorInput","clearTitle","insertAfter","isReadOnly","hasValue","valueDoesNotEqualPlaceHolder","_showClear","_hideClear","_prev","_deselectItem","rootItems","_checkLoadedItems","rootItem","subItems","_valueComparer","_checkLoadedItem","_getAllChecked","_checkCheckAll","_uncheckCheckAll","checkAllCheckbox","_allItemsAreChecked","_allItemsAreUnchecked","filterTemplate","_disableCheckChildren","title","aria-autocomplete","_filterChange","insertBefore","renderCheckBox","label","_changeCheckAll","_keydownCheckAll","_disabledCheckedItems","_disabledUnCheckedItems","isChecked","_updateCheckAll","_toggleCheckAllItems","edge","_clickCheckAll","_dfs","_traverceChildren","_uncheckItemByUid","_uncheckItemEqualsUid","_itemEqualsText","_selectItemByValue","_itemEqualsValue","_checkItemByValue","dataItems","_checkItemEqualsValue","itemValue","itemText","newValue","_allCheckedItems","_getAllCheckedItems","childrenField","_childrenOptions","schema","_checkAllCheckItem","add","dropDownWrapper","_toggleHover","_focusinHandler","_focusoutHandler","_wrapperClick","_removeTagClick","_prevent","_focused","type","preventScroll","_ie11PreventScrollOnFocus","version","_toggleResize","isFilterInputActive","isWrapperActive","tagItem","isPopupVisible","_focusPrevTag","_focusNextTag","_focusFirstTag","_focusLastTag","DELETE","_removeTag","BACKSPACE","_clearFilter","activedescendant","next","_clearDisabledTag","firstTag","lastTag","fields","lastIndex","plugin","cssProperties","registerPrefix","registerValues","values","roundedValues","concat","Class","view","_wrapper","_span","DOMelement","cssText","className","accesskey","unselectable","SELECTOR","renderButton","icon","shape","_arrow","_arrowIcon","selectedNode","tempItem","_tagTemplate","_tagList","valueToSelect","tagTemplate","renderChip","themeColor","removable","removeIcon","removableAttr","aria-label","tagCollection","renderChipList","viewModel","observable","multipleTag","tags","oldValues","_removeValues","removedValues","_getNewValues","j","tagsArray","_findTag","tempItemValue"],"mappings":"CAAA,SAAaA,QACTA,OAAO,wBAAwB,CAAE,kBAClC,WAEH,IAAUC,EA+RPC,OAAOC,MAAMC,OA/RHC,OAAb,EAEQF,EAAQD,OAAOC,MACfG,EACAC,EAAOJ,EAAMI,KACbC,EAAW,aACXC,EAAS,SACTC,EAAU,UACVC,EAAY,YACZC,EAAQ,QACRC,EAAK,iBACLC,EAAgB,gBAChBC,EAAW,WACXC,EACAC,EAXKd,EAAMG,GAWGW,SAEd,SAASC,EAAaC,GAClB,OAAO,SAASC,GACZ,IAAIC,EAASD,EAAKE,SAAS,0BAE3B,IAAKD,EAAOE,OACRF,EAASD,EAGb,OAAOC,EAAOC,SAASH,IAI/BH,EAAWE,EAAa,YAE5B,IAAIM,EAAOP,EAASQ,OAAO,CACvBC,KAAM,SAASC,EAASC,EAASC,GAC7B,IAAIC,EAAOC,KAEXD,EAAKD,aAAeA,EAEpBZ,EAASe,GAAGN,KAAKO,KAAKH,EAAMH,EAASC,GACrC,GAAIE,EAAKD,aAAaK,uBAClBJ,EAAKK,QAAQC,GAAGxB,EAAQC,EAAI,mBAAoBiB,EAAKO,mBAAmBC,KAAKR,KAIrFS,eAAgB,SAASC,GACrB,IAAKA,EAAEC,qBAAsB,CACzB,IAAIC,EAAWX,KAAKW,SAASF,EAAEpB,MAE/BsB,EAASC,IAAI,WAAYD,EAASE,WAI1CC,iBAAkB,SAASzB,EAAM0B,GAC7B1B,EAAKuB,IAAIjC,EAASoC,IAGtBC,OAAQ,SAASP,GACb,IAAIV,EAAOC,KAEX,GAAID,EAAKD,aAAaK,uBAClBJ,EAAKkB,IAAI,SAAUlB,EAAKS,gBAE5BtB,EAASe,GAAGe,OAAOd,KAAKH,EAAMU,IAGlCH,mBAAoB,SAASG,GACzB,IAAIV,EAAOC,KACXX,EAAOnB,EAAEuC,EAAES,eAEXnB,EAAKkB,IAAI,SAAUlB,EAAKS,gBACxB,IAAKT,EAAKoB,SAASzC,EAAQW,GACvBU,EAAKY,SAAStB,GAAMuB,IAAI,WAAY,QAI5CQ,eAAgB,SAASX,GACrB,IAAIV,EAAOC,KACX,IAAIX,EAAOoB,EAAEpB,KACb,IAAIgC,EAASZ,EAAEY,OACf,IAAIC,EAAQb,EAAEa,MACd,IAAIC,EAAavB,KAAKI,QACtB,IAAIP,EAAUG,KAAKH,QACnB,IAAI2B,EAAe3B,EAAQ2B,aAC3B,IAAIC,EAAgB5B,EAAQ6B,YAAc7B,EAAQ6B,WAAWD,cAC7D,IAAIE,EAEJ,GAAI3B,KAAK4B,MACL,OAGJ,GAAInB,EAAEoB,MAAO,CACT,IAAKP,EAAM,KAAOA,EAAM,GAAGQ,MACvB,OAGJ,OAAO9B,KAAK+B,aAAaT,EAAOb,EAAEoB,OAGtC,GAAIxC,EAAM,CACNkC,EAAavB,KAAKgC,UAAU3C,EAAK4C,KACjCjC,KAAKkC,UAAUX,EAAY,OAG/B,GAAIE,GAAiBJ,GAAU,SAAU,CACrC,IAAIc,EAAS,MAEb,IAAKR,EAAI,EAAGA,EAAIL,EAAM9B,OAAQmC,IAC1B,GAAI,YAAaL,EAAMK,GAAI,CACvBQ,EAAS,KACT,MAIR,IAAKA,GAAU9C,GAAQA,EAAKwB,QACxB,IAAKc,EAAI,EAAGA,EAAIL,EAAM9B,OAAQmC,IAC1BL,EAAMK,GAAGd,QAAU,KAK/B,GAAIQ,GAAU,MACVrB,KAAKoC,aAAa3B,EAAE4B,MAAOf,EAAOC,QAC/B,GAAIF,GAAU,SACjBrB,KAAKsC,QAAQtC,KAAKgC,UAAUV,EAAM,GAAGW,KAAM,YACxC,GAAIZ,GAAU,aACjBrB,KAAK+B,aAAaT,QACf,GAAID,GAAU,aACjBrB,KAAKuC,iBAAiBhB,EAAYD,EAAOb,EAAE4B,YAE3CrC,KAAKwC,aAAalB,GAGtB,GAAID,GAAU,SACV,IAAKM,EAAI,EAAGA,EAAIL,EAAM9B,OAAQmC,IAC1B,IAAKH,GAAgBF,EAAMK,GAAGc,SAC1BnB,EAAMK,GAAGe,OAKrB3C,EAAKK,QAAQuC,KAAK,OAAQ,QAC1B5C,EAAKK,QAAQwC,KAAK,OAAOD,KAAK,OAAQ,QAEtC3C,KAAK6C,WAAW7C,KAAKI,QAAQwC,KAAK,qBAAsB,GAExD5C,KAAK8C,QAAQlE,EAAW,CAAES,KAAMA,EAAOkC,EAAajD,IACpD0B,KAAKF,aAAaiD,mBAAmB,CAAE1D,KAAMA,EAAOkC,EAAajD,EAAW0E,OAAQhD,OACpF,GAAIA,KAAKH,QAAQ6B,WAAWD,cACxBzB,KAAKiD,uBAIbC,iBAAkB,SAAS7D,GACvB,IAAIU,EAAOC,KACPmD,EACA7D,EAEJ,IAAKD,EAAKG,QAAUH,EAAK+D,OAAO5D,OAAQ,CACpC,GAAIH,EAAKG,OACLF,EAASD,EAAK+D,YAEd9D,EAASS,EAAKsD,KAAK9D,WAAW+D,OAGlC,MAAOvD,EAAKwD,UAAUjE,GAAS,CAC3B6D,EAAYlE,EAASK,GAAQC,WAAW+D,OAExC,IAAKH,EAAU3D,OACX,MAGJF,EAAS6D,OAEV,CACH7D,EAASS,EAAKyD,OAAOnE,IAASA,EAE9B,IAAKC,EAAOE,OACR,GAAIO,EAAKD,aAAa2D,UAAY1D,EAAKD,aAAa2D,SAASC,GAAG,YAC5D3D,EAAKD,aAAa2D,SAASb,KAAK,eAAeE,QAAQ,cACpD,GAAI/C,EAAKD,aAAa6D,YACzB5D,EAAKD,aAAa6D,YAAYb,QAAQ,cAEtC/C,EAAKD,aAAaM,QAAQ0C,QAAQ,SAK9C,OAAOxD,GAGXsE,SAAU,SAASnD,GACf,IAAIV,EAAOC,KACP6D,EAAMpD,EAAEqD,QACRC,EACAC,EAAUjE,EAAKkE,UACfxB,EAAW1C,EAAKwD,UAAUS,GAC1BE,EAAWF,EAAQpB,KAAK,uBAAuBuB,QAAQvB,KAAK,aAC5DwB,EAAMhG,EAAMiG,QAAQC,MAAMvE,EAAKH,SAEnC,GAAIa,EAAEsD,QAAUtD,EAAES,cACd,OAGJ,IAAMkD,GAAOP,GAAOrF,EAAK+F,OAAWH,GAAOP,GAAOrF,EAAKgG,MACnD,GAAI/B,EACAsB,EAAShE,EAAK0E,aAAaT,QACxB,IAAKA,EAAQpB,KAAK,SAASuB,QAAQO,SAASjG,GAC/CsB,EAAK4E,OAAOX,QAEb,IAAMI,GAAOP,GAAOrF,EAAKgG,MAAUJ,GAAOP,GAAOrF,EAAK+F,MACzD,GAAI9B,IAAauB,EAAQpB,KAAK,SAASuB,QAAQO,SAASjG,GACpDsB,EAAK6E,SAASZ,OACX,CACHD,EAAShE,EAAKyD,OAAOQ,GAErB,IAAKjE,EAAK8E,SAASd,GACfA,EAASzF,OAGd,GAAIuF,GAAOrF,EAAKsG,KACnBf,EAAShE,EAAK0E,aAAaT,QACxB,GAAIH,GAAOrF,EAAKuG,KAAOtE,EAAEuE,OAC5BjB,EAAShE,EAAKmD,iBAAiBc,QAC5B,GAAIH,GAAOrF,EAAKyG,KACnBlB,EAAShE,EAAK0E,aAAavG,UACxB,GAAI2F,GAAOrF,EAAK0G,IACnBnB,EAAShE,EAAKmD,iBAAiBhF,UAC5B,GAAI2F,GAAOrF,EAAK2G,QAAUnB,EAAQpB,KAAK,SAASuB,QAAQO,SAASjG,IACpE,IAAKuF,EAAQpB,KAAK,SAASuB,QAAQO,SAAS,cACxC,IAAK3E,EAAKoB,SAASzC,EAAQsF,GACvBjE,EAAKqF,OAAOpB,QAGjB,GAAIH,GAAOrF,EAAK6G,UAAYnB,EAAS1E,SAAWwE,EAAQpB,KAAK,SAASuB,QAAQO,SAASjG,GAAW,CACrGyF,EAASoB,KAAK3G,GAAUuF,EAASoB,KAAK3G,IACjC4G,KAAKxG,EAAe,OACpBuG,KAAKvG,EAAe,OAEzBgB,EAAKyF,gBAAgB,CAAEzB,OAAQG,IAE/BH,EAASC,OACN,GAAKvD,EAAEuE,QAAUnB,IAAQrF,EAAKuG,IAAOlB,IAAQrF,EAAKiH,IACrD1F,EAAK2F,mBACF,GAAK7B,IAAQrF,EAAKmH,IAAK,CAC1BlF,EAAEmF,iBACF7F,EAAK2F,cAGT,GAAI3B,EAAQ,CACRtD,EAAEmF,iBAEF,GAAI5B,EAAQ,IAAMD,EAAO,GAAI,CACzBhE,EAAKoB,SAASnC,EAAU+E,GACxBhE,EAAKkE,QAAQF,MAKzB2B,YAAa,WACT1F,KAAKF,aAAa+F,QAClB7F,KAAKF,aAAaM,QAAQ0C,QAAQ,UAGtCgD,QAAS,SAASrF,GACdT,KAAKoB,eAAeX,GAEpB,GAAIT,KAAKF,aAAaD,QAAQkG,iBAC1B,OAGJ,GAAItF,EAAEY,SAAW,cACb,GAAIrB,KAAKF,aAAaK,wBAClB,GAAIM,EAAEoB,QAAU,UACZ7B,KAAKF,aAAakG,YAAYvF,EAAEa,MAAM,SAG1C,GAAIb,EAAEoB,QAAU,WAAapB,EAAEoB,QAAU,YAAcpB,EAAEa,MAAM,GAAG2E,SAC9DjG,KAAKF,aAAaoG,aAAazF,EAAEa,MAAM,SAI/CtB,KAAKF,aAAagG,QAAQrF,MAU1C,OAJIrC,EAAMG,GAAG4H,cAAgB1G,EAItBtB,OAAOC,QArSd,CAuSoB,mBAAVH,QAAwBA,OAAOmI,IAAMnI,OAAS,SAASoI,EAAIC,EAAIC,IAAOA,GAAMD,OAEtF,SAAarI,QACTA,OAAO,qBAAqB,CAAE,0BAA2B,cAAe,eAAgB,kBAAmB,sBAAuB,oBAAqB,oBACxJ,WAEH,IAAIuI,EAAW,CACXC,GAAI,eACJC,KAAM,eACNC,SAAU,MACVC,YAAa,8GACbC,QAAS,CAAE,WAAY,QAAS,SAAU,YAAa,gBAAiB,cAAe,eAGjF3I,EAqrEPC,OAAOC,MAAMC,OArrEHC,OAAb,EACQF,EAAQD,OAAOC,MACfG,EAAKH,EAAMG,GACXuI,EAAO1I,EAAM0I,KACbC,EAASxI,EAAGwI,OACZ7H,EAAWX,EAAG4H,cACda,EAAkB5I,EAAMmH,KAAKyB,gBAC7BC,EAAmB7I,EAAMmH,KAAK0B,iBAC9BvH,EAASxB,EAAEwB,OACXwH,EAAgB9I,EAAM+I,eACtBC,EAAK,qBACL5I,EAAOJ,EAAMI,KACb6F,EAAUjG,EAAMiG,QAChBgD,EAAc,WACdC,EAAQ,QACRC,EAAUlD,EAAQkD,QAClBC,EAAapJ,EAAMqJ,YACnBC,EAAM,IACNjJ,EAAW,WACXkJ,EAAW,WACXC,EAAgB,aAChBC,EAAgB,gBAChBC,EAAQ,UACRC,EAAU,UACVC,EAAc,aAAeZ,EAAK,cAAgBA,EAClDa,EAAW,WACXpJ,EAAQ,QACRqJ,EAAO,OACPC,EAAQ,QACRC,EAAS,SACTC,EAAa,KAEbC,EAAO,UAEPC,EAAenK,EAAMG,GAAGwI,OAAOrH,OAAQ,CACvCC,KAAM,SAASC,EAASC,GACpBG,KAAKoH,GAAKA,EAEVhJ,EAAMG,GAAGwI,OAAO9G,GAAGN,KAAKO,KAAKF,KAAMJ,EAASC,GAC5CG,KAAKwI,WAAaxI,KAAKyI,gBACvBzI,KAAK0I,mBAAqB1I,KAAK2I,YAAYpI,KAAKP,MAChDA,KAAK4I,SAAW5I,KAAKJ,QAAQiJ,MAE7B7I,KAAK8I,QAAU,GAEf,IAAI/H,EAAQf,KAAKH,QAAQkB,MAEzB,GAAIA,IAAU,OAASA,EAAMvB,OACzBQ,KAAK+I,gBAAkB,KAG3B,IAAK/I,KAAKgJ,mBAAmBjI,GAAQ,CACjCf,KAAKiJ,mBAAqB,KAC1BjJ,KAAK8I,QAAUI,MAAMC,QAAQpI,GAASA,EAAMqI,MAAM,GAAK,CAACrI,GAG5Df,KAAKqJ,iBAELrJ,KAAKsJ,aACLtJ,KAAKuJ,oBAAoBvJ,KAAKH,SAC9BG,KAAKwJ,cACLxJ,KAAKwI,WAAWiB,eAChBzJ,KAAK0J,mBACL1J,KAAK2J,aAAa,MAClB3J,KAAK4J,YACL5J,KAAKI,QAAQmF,KAAK0C,EAAUjI,KAAKI,QAAQuC,KAAKsF,IAE9CjI,KAAK6J,KAAO3L,EAAE,UACbyE,KAAK,CACFmH,UAAW,EACXC,cAAe,OAGnB/J,KAAKgK,KAAO9L,EAAE,mCACT+L,OAAOjK,KAAK6J,MAEjB7J,KAAKkK,UACLlK,KAAKmK,UACLnK,KAAKoK,UACLpK,KAAKqK,SACLrK,KAAKsK,SACLtK,KAAKuK,MAAMtJ,IAAI,OAAQjB,KAAKwK,WAAWjK,KAAKP,OAC5CA,KAAKyK,eACLzK,KAAK0K,gBACL1K,KAAK2K,YAEL3K,KAAK4K,gBAEL5K,KAAK6K,YACL7K,KAAK8K,UACL9K,KAAK+K,yBAEL/K,KAAKgL,QAEL,IAAKhL,KAAKH,QAAQoL,SAAU,CACxB,IAAIC,EAAOrL,EAAQqL,MAAQ,GAC3B,IAAKlL,KAAKgJ,mBAAmBnJ,EAAQkB,OACjCf,KAAKmL,WAAWtL,EAAQkB,YACrB,GAAImK,EACPlL,KAAKoL,cAAcF,QAChB,GAAIrL,EAAQwL,YACfrL,KAAK2J,aAAa,MAI1B,IAAI2B,EAAWpN,EAAE8B,KAAKJ,SAAS2L,QAAQ,YAAY7H,GAAG,aAEtD,GAAI4H,EACAtL,KAAKwL,OAAO,OAEhBxL,KAAKiJ,mBAAqB,MAC1B7K,EAAMqN,OAAOzL,OAGjBmL,WAAY,SAAS5F,EAAMxE,GACvBf,KAAKwI,WAAW2C,WAAW5F,EAAMxE,IAGrCwI,oBAAqB,SAAS1J,GAC1B,IAAI6L,EAAkB,CAClBT,SAAUpL,EAAQoL,SAClBvJ,WAAY7B,EAAQ6B,WACpBiK,kBAAmB9L,EAAQ8L,kBAC3BC,wBAAyB/L,EAAQ+L,wBACjCC,cAAehM,EAAQgM,cACvBC,aAAcjM,EAAQiM,aACtBtK,aAAc3B,EAAQ2B,aACtBuK,KAAMlM,EAAQkM,MAGlB/L,KAAKH,QAAQmM,SAAW9N,EAAEwB,OAAO,GAAIgM,EAAiB1L,KAAKH,QAAQmM,UAEnE,GAAInM,EAAQoM,SACRjM,KAAKH,QAAQmM,SAASC,SAAWpM,EAAQoM,SAG7C,GAAIpM,EAAQkM,KACR/L,KAAKH,QAAQmM,SAASD,KAAOlM,EAAQkM,MAI7CvC,YAAa,WACT,IAAI0C,EAAiBlM,KAAKH,QAAQsM,WAElCnM,KAAKmM,WAAa/N,EAAMmH,KAAK6G,uBAAuBC,OAAOH,GAC3D,GAAIA,EACAhO,EAAEwB,OAAOM,KAAKH,QAAQmM,SAAS,CAC3BG,WAAYnM,KAAKmM,cAK7B3B,WAAY,WACR,IAAID,EAAQvK,KAAKuK,MACjBA,EAAMnK,QAAUhC,EAAMkO,KAAK/B,EAAM3K,UAGrC6I,cAAe,WACX,GAAIzI,KAAKG,uBAAwB,CAC7BH,KAAKH,QAAQ0M,SAAW,0BACxB,OAAO,IAAIhO,EAAGgK,aAAaiE,kBAAkBxM,WAE7C,OAAO,IAAIzB,EAAGgK,aAAakE,gBAAgBzM,OAInD0M,cAAe,SAASP,GACpBnM,KAAK2M,iBAAmB,KACxB,GAAI3M,KAAK4M,MAAO,CACZ5M,KAAK+I,gBAAkB,KACvB/I,KAAK6M,SAAS,IACd7M,KAAK4M,MAAME,QACX9M,KAAK+M,KAAKC,OACVhN,KAAKiN,cAAcH,QAEvB9M,KAAKmM,WAAaA,EAClBnM,KAAKgM,SAASU,cAAcP,GAC5BnM,KAAK2M,iBAAmB,OAG5BxM,qBAAsB,WAClB,OAAOH,KAAKH,UAAYG,KAAKH,QAAQmM,SAAStK,YAAc1B,KAAKH,QAAQ6B,aAG7E7B,QAAS,CACL6G,KAAM,eACNwG,UAAW,GACXjC,SAAU,KACVkC,UAAW,KACXC,UAAW,MACXC,YAAa,KACbxB,cAAe,GACfyB,eAAgB,GAChB3B,kBAAmB,GACnBC,wBAAyB,GACzBE,aAAc,GACdyB,MAAO,IACPC,QAAS,KACTC,iBAAkB,MAClBrO,OAAQ,OACRsO,OAAQ,IACRC,WAAY,KACZtL,MAAO,EACPb,aAAc,MACdoM,SAAU,CACNC,UAAa,mBACbC,MAAS,QACTC,UAAa,SACbC,OAAU,kBAEdC,UAAW,EACXvM,WAAY,MACZwM,eAAgB,KAChB7C,YAAa,GACb5H,SAAU,MACV0K,iBAAkB,YAClBC,QAAS,WACTnC,SAAU,KACVf,KAAM,KACNc,SAAU,GACVqC,eAAgB,MAChBC,eAAgB,GAChBC,eAAgB,GAChBxN,MAAO,KACPyN,cAAe,KACfjE,MAAO,KACPkE,YAAa,KACb1C,KAAM,SACN2C,SAAU,QACVC,QAAS,UAGbC,OAAQ,CACJ,OACA,QACA,YACAxG,EACA,SACA,aAGJyG,MAAO,WACH7O,KAAKI,QAAQ0C,QAAQ,UAGzBnC,SAAU,SAAStB,GACf,OAAOW,KAAKgM,SAASrL,SAAStB,IAGlCyP,SAAU,SAASA,GACf9O,KAAK+O,UAAU,CACXD,SAAUA,IAAaxQ,EAAY,KAAOwQ,EAC1CE,QAAS,QAEbhP,KAAK+K,0BAGTS,OAAQ,SAASA,GACbxL,KAAK+O,UAAU,CACXD,SAAU,MACVE,UAAWxD,EAASA,IAAWlN,EAAY,KAAOkN,KAEtDxL,KAAK+K,0BAGTkE,OAAQ,SAASC,GACblP,KAAKmP,QAAQD,IAGjBA,KAAM,WACF,IAAI3E,EAAQvK,KAAKuK,MAEjB,IAAKvK,KAAKH,QAAQoL,WAAajL,KAAKmM,WAAW5G,OAAO/F,OAAQ,CAC1DQ,KAAKgM,SAAS9J,UAAU,MACxB,GAAIlC,KAAKoP,mBACLpP,KAAKqP,eAELrP,KAAKmM,WAAWmD,QAIxB,GAAI/E,EAAMgF,YAAcvP,KAAKwP,gBACzB,OAGJ,GAAIxP,KAAKG,uBACLoK,EAAM3K,QAAQ6P,SAAS,wBAE3BlF,EAAM3K,QAAQ6P,SAAS,wBAEvBlF,EAAMtJ,IAAI,WAAYjB,KAAK0I,oBAC3B6B,EAAMmF,SAAW,KACjBnF,EAAM2E,QAGVrJ,MAAO,WACH7F,KAAKuK,MAAM1E,SAGf8J,OAAQ,SAASC,GACb,IAAI/P,EAAUG,KAAKH,QACnB,IAAIT,EACJyQ,aAAa7P,KAAK8P,gBAElB,IAAMjQ,EAAQ4N,mBAAqBmC,EAAKpQ,QAAWoQ,EAAKpQ,QAAUK,EAAQoO,UAAW,CACjF7O,EAASY,KAAK+P,WAAWH,GACzB,GAAI5P,KAAK8C,QAAQ,YAAa,CAAE1D,OAAQA,KACvC8J,MAAMC,QAAQnJ,KAAKH,QAAQgM,eACxB,OAGJ7L,KAAKgQ,WAAa,KAClBhQ,KAAKgM,SAASG,WAAW/M,OAAOA,KAIxC2Q,WAAY,SAASH,GACjB,MAAO,CACH/N,MAAO7B,KAAKH,QAAQgM,cACpBoE,SAAUjQ,KAAKH,QAAQT,OACvB2B,MAAO6O,EACPjC,WAAY3N,KAAKH,QAAQ8N,aAIjC7H,QAAS,WACL,IAAIP,EAAOvF,KAAKgM,SAASG,WAAW+D,WACpClQ,KAAK4K,gBACL5K,KAAKmQ,gBACL,GAAInQ,KAAK2D,aAAe3D,KAAKyD,SACzBzD,KAAKyD,SAASwL,QAAQjP,KAAK2D,YAAYkF,MAAMrJ,QAGjDQ,KAAK6J,KAAKoF,SAAS1J,EAAK/F,QACxBtB,EAAE8B,KAAKgO,QAAQiB,QAAQ1J,EAAK/F,SAGhC4Q,WAAY,SAASvQ,GAEjB,GAAIG,KAAKH,QAAQ6B,YAAc7B,EAAQ6B,WAAY,QACxC7B,EAAQ6B,WACfvD,OAAOkS,QAAQC,KAAK,kFAGxBvJ,EAAO9G,GAAGmQ,WAAWlQ,KAAKF,KAAMH,GAEhCG,KAAKuJ,oBAAoB1J,GACzBG,KAAKwJ,cACL,GAAIxJ,KAAKH,QAAQmM,UAAYnM,EAAQkM,KACjC/L,KAAKgM,SAASoE,WAAWpQ,KAAKH,QAAQmM,UAG1C,GAAInM,EAAQ6N,QAAU1N,KAAK6J,KACvB7J,KAAK6J,KAAK0G,IAAI,aAAc1Q,EAAQ6N,QAGxC1N,KAAKkK,UACLlK,KAAKmK,UACLnK,KAAKoK,UAELpK,KAAK4K,gBACL5K,KAAKmQ,gBACL,GAAInQ,KAAK+M,OAAS/M,KAAKG,wBAA0BH,KAAK+M,KAAKrI,SAAS,eAChE1E,KAAK2J,aAAa,MAEtB3J,KAAKqJ,iBACLrJ,KAAKsJ,aACLtJ,KAAK0K,gBACL1K,KAAK6K,YACL7K,KAAK8K,UACL,GAAIjL,IAAYA,EAAQ2L,QAAU3L,EAAQ2N,SACtCxN,KAAKwL,OAAO,MAEhBxL,KAAKyK,gBAGT+F,QAAS,WACLpS,EAAMG,GAAGwI,OAAO9G,GAAGuQ,QAAQtQ,KAAKF,MAChC,GAAIA,KAAKgM,SACLhM,KAAKgM,SAASwE,UAElBxQ,KAAKuK,MAAMiG,UAEXxQ,KAAKI,QAAQqQ,IAAIrJ,GACjBpH,KAAK0Q,OAAOD,IAAIrJ,GAChB,GAAIpH,KAAK2D,YACL3D,KAAK2D,YAAY8M,IAAIrJ,GAGzB,GAAIpH,KAAK2Q,QACL3Q,KAAK2Q,QAAQF,IAAIrJ,GAGrBhJ,EAAMwS,OAAO5Q,KAAK2Q,SAClB,GAAI3Q,KAAKH,QAAQ4D,UAAYzD,KAAKyD,SAC9BzD,KAAKyD,SAASgN,IAAIrJ,GAGtB,GAAIpH,KAAK6Q,MACL7Q,KAAK6Q,MAAMJ,IAAI,QAASzQ,KAAK8Q,gBAIrCjE,SAAU,SAAS9L,GACfA,EAAQmI,MAAMC,QAAQpI,IAAUA,aAAiBiG,EAAkBjG,EAAMqI,MAAM,GAAK,CAACrI,GAErFf,KAAK8I,QAAU/H,GAGnBO,MAAO,WACH,OAAOtB,KAAKgM,SAAS1K,SAGzBP,MAAO,SAASA,GACZ,IAAIhB,EAAOC,KAEX,GAAIe,EACA,GAAIhB,EAAK4D,aAAe5D,EAAKoM,WAAW4E,QAAS,CAC7ChR,EAAKiQ,WAAa,KAClBjQ,EAAKoM,WAAW/M,OAAO,SACpB,IAAKW,EAAKoM,WAAW5G,OAAO/F,SAAWO,EAAKiM,SAASG,WAAW5G,OAAO/F,OAAQ,CAClF,IAAKO,EAAKF,QAAQ2B,aAAc,CAC5BzB,EAAKiM,SAAS/K,IAAI,gBAAiB,WAC/BlB,EAAKyI,WAAWwI,UAAUjQ,KAG9B,IAAKhB,EAAKF,QAAQoL,UAAYlL,EAAKF,QAAQwO,eACvCtO,EAAKoM,WAAWmD,aAGpBvP,EAAKoM,WAAWmD,MAAM,WAClBvP,EAAKyI,WAAWwI,UAAUjQ,KAIlC,OAIR,OAAOhB,EAAKyI,WAAWwI,UAAUjQ,IAGrCmK,KAAM,SAASA,GACX,IAAI+F,EACJ,IAAItD,EAAa3N,KAAKH,QAAQ8N,WAE9BzC,EAAOA,IAAS,KAAO,GAAKA,EAE5B,GAAIA,IAAS5M,IAAc0B,KAAKG,uBAAwB,CACpD,UAAW+K,IAAS,SAAU,CAC1BlL,KAAKoL,cAAcF,GACnB,OAGJ+F,EAActD,EAAazC,EAAOA,EAAKgG,cAEvClR,KAAKmR,kBAAkBF,GAEvBjR,KAAKoL,cAAc6F,QAEnB,OAAOjR,KAAKoL,iBAIpBJ,MAAO,WACH,IAAIoG,EAAQpR,KAAKI,QAAQwC,KAAK,sBAE9B5C,KAAKI,QAAQuC,KAAK,CACd0O,gBAAiB,OACjBC,gBAAiB,MACjBC,gBAAiBvR,KAAKgM,SAASpM,QAAQ+C,KAAK,MAC5C6O,KAAQ,YAGZxR,KAAKyR,UAAYrT,EAAMsT,OACvB1R,KAAK2R,WAAW3R,KAAKI,SAErB,GAAIJ,KAAK2D,aAAe3D,KAAKH,QAAQ4O,YACjCzO,KAAK2D,YAAYhB,KAAK,aAAc3C,KAAKH,QAAQ4O,aAGrD,IAAKzO,KAAKH,QAAQ6B,YAAc0P,EAAMlG,OAAO1L,OAAQ,CACjD4R,EAAMzO,KAAK,OAAQ,UACnByO,EAAMzO,KAAK,gBAAiB,QAC5ByO,EAAMzO,KAAK,KAAM3C,KAAKyR,WAEtBzR,KAAKI,QAAQuC,KAAK,wBAAyB3C,KAAKyR,gBAC7C,GAAIzR,KAAKH,QAAQ6B,WAAY,CAChC1B,KAAKI,QAAQuC,KAAK,CACdiP,uBAAwB,KACxBC,mBAAoB7R,KAAK2Q,QAAQ,GAAGlK,KAGxCzG,KAAK2Q,QAAQhO,KAAK,OAAQ,UAIlCuH,QAAS,WACL,IAAIF,EAAOhK,KACX,IAAI8R,EAAS5T,EAAE8L,EAAK8H,QACpB,IAAI7F,EAAWjC,EAAKnK,QAAQ0O,eAE5BvO,KAAK+R,gBAAgBD,EAAQ,WAC7B1T,EAAMoS,QAAQsB,GACdA,EAAOE,SAEP,IAAK/F,EAAU,CACXjC,EAAK8H,OAAS,KACd,OAGJ,IAAIvD,SAAwBtC,IAAa,WAAa7N,EAAM6N,SAASA,GAAYA,EACjF6F,EAAS5T,EAAEqQ,EAAe,KAE1BvE,EAAK8H,OAASA,EAAO,GAAKA,EAAS,KACnC9H,EAAKA,KAAKiI,QAAQH,GAElB9R,KAAK+R,gBAAgB/H,EAAK8H,OAAQ,YAGtC3H,QAAS,WACL,IAAIH,EAAOhK,KACX,IAAIgO,EAAS9P,EAAE8L,EAAKgE,QACpB,IAAI/B,EAAWjC,EAAKnK,QAAQqO,iBAAmB,KAAOlE,EAAKnK,QAAQ+N,SAASI,OAAShE,EAAKnK,QAAQqO,eAElGlE,EAAKkI,QAAQ,UAAW,WAAa,MAAO,CAAEC,SAAUnE,KACxD5P,EAAMoS,QAAQxC,GACdA,EAAOgE,SAEP,IAAK/F,EAAU,CACXjC,EAAKgE,OAAS,KACd,OAGJhE,EAAKgE,OAAS9P,EAAE,wDAAwDkU,SAASpI,EAAKA,MACtFA,EAAKkE,sBAAwBjC,IAAa,WAAa7N,EAAM6N,SAASA,GAAYA,GAGtFkE,cAAe,WACX,IAAInG,EAAOhK,KACX,IAAIgO,EAAShE,EAAKgE,OAElB,IAAKA,EACD,OAGJhO,KAAK+R,gBAAgB/D,EAAQ,WAC7BA,EAAOlH,KAAKkD,EAAKkE,eAAe,CAAEmE,SAAUrI,KAC5ChK,KAAK+R,gBAAgB/D,EAAQ,YAGjC5D,QAAS,WACL,IAAIJ,EAAOhK,KACX,IAAIsS,EAASpU,EAAE8L,EAAKsI,QACpB,IAAIrG,EAAWjC,EAAKnK,QAAQyO,eAE5BtO,KAAK+R,gBAAgBO,EAAQ,WAC7BlU,EAAMoS,QAAQ8B,GACdA,EAAON,SAEP,IAAK/F,EAAU,CACXjC,EAAKsI,OAAS,KACd,OAGJtI,EAAKsI,OAASpU,EAAE,gCAAgCkU,SAASpI,EAAKA,MAC9DA,EAAKsE,sBAAwBrC,IAAa,WAAa7N,EAAM6N,SAASA,GAAYA,GAGtFrB,cAAe,WACX,IAAIZ,EAAOhK,KACX,IAAIsS,EAAStI,EAAKsI,OAElB,IAAKA,EACD,OAGJtS,KAAK+R,gBAAgBO,EAAQ,WAC7BA,EAAOxL,KAAKkD,EAAKsE,eAAe,CAAE+D,SAAUrI,KAC5ChK,KAAK+R,gBAAgBO,EAAQ,YAGjCxH,QAAS,WACL,IAAI/K,EAAOC,KACPH,EAAUE,EAAKF,QACfyL,EAAWvL,EAAKH,QAAQ8D,GAAG,cAE/B,GAAI7D,EAAQ2L,SAAWlN,EACnBuB,EAAQ2N,QAAU3N,EAAQ2L,OAG9B,IAAK3L,EAAQ2N,SAAWlC,EACpBvL,EAAKyL,OAAO,YAEZzL,EAAK+O,SAAS/O,EAAKH,QAAQ8D,GAAG,gBAItC6O,iBAAkB,WACd,IAAIxS,EAAOC,KACPgK,EAAOjK,EAAKiK,KACZwI,EAAQxI,EAAK,GAAGyI,MAAMD,MACtBpS,EAAUL,EAAKK,QACfsS,EAAeC,EAEnB,IAAK3I,EAAKzE,KAAK+B,IAAUkL,EACrB,OAGJE,EAAgBvU,OAAOyU,iBAAmBzU,OAAOyU,iBAAiBxS,EAAQ,GAAI,MAAQ,EACtFuS,EAAgBE,WAAWH,GAAiBA,EAAcF,QAAUhL,EAAWpH,GAE/E,GAAIsS,GAAiBnL,EAAQuL,KACzBH,GAAiBE,WAAWH,EAAcK,aAAeF,WAAWH,EAAcM,cAAgBH,WAAWH,EAAcO,iBAAmBJ,WAAWH,EAAcQ,kBAG3K,GAAIlJ,EAAKuG,IAAI,gBAAkB,aAC3BiC,EAAQG,GAAiBnL,EAAWwC,GAAQA,EAAKwI,cAEjDA,EAAQG,EAGZ3I,EAAKuG,IAAI,CACL4C,WAAY/S,EAAQmQ,IAAI,eACxBiC,MAAOzS,EAAKF,QAAQuN,UAAY,OAASoF,EACzCY,SAAUZ,EACVa,WAAYtT,EAAKF,QAAQuN,UAAY,SAAW,WAEnD7H,KAAK+B,EAAOkL,GAEb,OAAO,MAGXnI,OAAQ,WACJ,IAAItK,EAAOC,KACPJ,EAAUG,EAAKH,QACf0T,EAAS1T,EAAQ+C,KAAK,QACtB4Q,EAAOD,EAASpV,EAAE,IAAMoV,GAAU1T,EAAQ4T,QAAQ,QAEtD,GAAID,EAAK,GAAI,CACTxT,EAAK+Q,cAAgB,WACjB2C,WAAW,WACP1T,EAAKgB,MAAMhB,EAAK6I,aAIxB7I,EAAK8Q,MAAQ0C,EAAKlT,GAAG,QAASN,EAAK+Q,iBAI3CxG,OAAQ,WACJ,IAAIN,EAAOhK,KAEX,GAAIgK,EAAKnK,QAAQ6B,YAAcsI,EAAKnK,QAAQ4D,SACxCuG,EAAKA,KAAKrH,KAAK,OAAQ,eAG3BqH,EAAKO,MAAQ,IAAIhM,EAAGmV,MAAM1J,EAAKA,KAAMtK,EAAO,GAAIsK,EAAKnK,QAAQ0K,MAAO,CAChEoJ,OAAQ3J,EAAK5J,QACb8O,KAAMlF,EAAK4J,aAAarT,KAAKyJ,GAC7BnE,MAAOmE,EAAK6J,cAActT,KAAKyJ,GAC/BkD,UAAWlD,EAAKnK,QAAQqN,UACxB5I,MAAOD,EAAQC,MAAM0F,EAAK5J,SAC1B0T,SAAU9J,EAAKnK,QAAQuN,cAI/B2E,gBAAiB,SAASnS,EAASyB,GAC/B,IAAKzB,EACD,OAGJI,KAAKkS,QAAQ7Q,EAAQ,WACjB,MAAO,CAAE8Q,SAAUvS,MAI3B4P,cAAe,WACX,OAAOxP,KAAKH,QAAQqO,gBAAkBlO,KAAKgM,SAASG,WAAW+D,WAAW1Q,QAG9EmK,aAAc,SAASqD,GACnB,GAAIhN,KAAK+M,KACL/M,KAAK+M,KAAKgH,YAAY,aAAc/G,GAAM9B,KAAK8B,EAAOhN,KAAKH,QAAQwL,YAAc,IAGrF,GAAIrL,KAAK+M,KAAK7B,OAAO8I,OAAOxU,OAAS,EACjCQ,KAAK+M,KAAKvJ,SAASb,KAAK,CACpB6O,KAAM,SACNyC,gBAAiB,WAElB,CACHjU,KAAK+M,KAAKvJ,SAAS0Q,WAAW,QAC9BlU,KAAK+M,KAAKvJ,SAAS0Q,WAAW,mBAItCC,cAAe,SAASxT,GACpB,IAAIyT,EAAepU,KAAKqU,OAAO1T,GAC/B,IAAKyT,GAAgBA,IAAiB,EAClCA,EAAezT,EAGnB,OAAOyT,GAGXpO,YAAa,SAASrF,GAClB,IAAII,EAAQ,GACZ,IAAIuT,GAAgB,EACpB,IAAIF,EAAepU,KAAKe,QACxB,IAAIwT,EAAavU,KAAKH,QAAQuO,UAAY,WAE1C,GAAIzN,GAAYA,IAAa,EAAG,CAC5B,GAAIA,EAASmB,MACTnB,EAAS6T,OAAS7T,EAASmB,QAG/Bf,EAAQf,KAAKmU,cAAcxT,GAE3B2T,EAAeF,EAAaK,QAAQ1T,GAGxC,GAAIJ,EAASE,QAAS,CAClB,IAAI6T,EAAkBxW,EAAEyW,KAAK3U,KAAK4M,MAAO,SAAUgI,GAC/C,OAAOA,EAAK3S,MAAQtB,EAASkU,UAGjC,GAAIH,EAAgBlV,OAChB,OAGJ,IAAIsV,EAAY,IAAI7N,EAAiBtG,EAASoU,UAC9CpU,EAASkU,QAAUC,EAAU7S,IAC7BjC,KAAK4M,MAAMoI,KAAKF,GAEhB,GAAI9U,KAAK4M,MAAMpN,SAAW,EAAG,CACzBQ,KAAK+M,KAAKkI,OAEV,IAAKV,EACDvU,KAAKiN,cAAc+H,KAAKF,GAIhC,GAAIR,KAAkB,EAAG,CACrBF,EAAaY,KAAKjU,GAClBf,KAAK6M,SAASuH,QAEf,CACH,IAAIc,EAAelV,KAAK4M,MAAMhK,KAAK,SAASgS,GACxC,OAAOA,EAAK3S,MAAQtB,EAASkU,UAGjC,IAAIM,EAAMnV,KAAK4M,MAAM6H,QAAQS,GAE7B,GAAIC,KAAS,EACTnV,KAAK4M,MAAMwI,OAAOD,EAAK,OACpB,CACHnV,KAAKqV,uBAAuB1U,GAC5B,OAGJ,GAAIX,KAAK4M,MAAMpN,SAAW,EAAG,CACzBQ,KAAK+M,KAAKC,OACV,IAAKuH,EACDvU,KAAKiN,cAAcmI,OAAO,EAAG,GAGrC,GAAId,KAAkB,EAAG,CACrBF,EAAagB,OAAOd,EAAc,GAClCtU,KAAK6M,SAASuH,IAItBpU,KAAKqV,uBAAuB1U,GAC5B,IAAKX,KAAKsV,wBAA0BtV,KAAKiJ,qBAAuBjJ,KAAK+I,gBACjE/I,KAAK8C,QAAQsF,GAGjB,GAAIpI,KAAKH,QAAQsN,WAAanN,KAAKuK,MAAMgF,UAAW,CAChDvP,KAAK6F,QACL7F,KAAKI,QAAQ0C,QAAQ,SAEzB9C,KAAKuK,MAAMgL,WACXvV,KAAK+K,yBACL/K,KAAKwV,0BAGTA,uBAAwB,WACpB,GAAIxV,KAAKJ,QAAQ,GAAG6V,QAAQvE,gBAAkB,SAC1C,OAGJ,IAAIwE,EAAgB1V,KAAK4M,MACzB,IAAI/M,EAAU,GACd,IAAIc,EAAW,KACf,IAAII,EAAQ,KAEZ,GAAI2U,EAAclW,OACd,IAAK,IAAI2V,EAAM,EAAGA,EAAMO,EAAclW,OAAQ2V,IAAO,CACjDxU,EAAW+U,EAAcP,GAEzBpU,EAAQf,KAAKqU,OAAO1T,GACpBd,GAAWG,KAAK2V,QAAQ5U,EAAOf,KAAK4V,MAAMjV,GAAW,MAI7DX,KAAKJ,QAAQkH,KAAKjH,IAGtB8V,QAAS,SAASE,EAAWC,EAAU7P,GACnC,IAAI8P,EAAS,UAEb,GAAIF,IAAcvX,EAAW,CACzBuX,GAAa,GAEb,GAAIA,EAAUpB,QAAQ,QAAU,EAC5BoB,EAAYA,EAAUG,QAAQ3N,EAAY,UAG9C0N,GAAU,WAAaF,EAAY,IAGvC,GAAI5P,EACA8P,GAAU,YAGdA,GAAU,IAEV,GAAID,IAAaxX,EACbyX,GAAU3X,EAAM6X,WAAWH,GAG/B,OAAOC,GAAU,aAGrB7P,aAAc,SAASvF,GACnB,IAAII,EAAQ,GACZ,IAAImK,EAAO,GAEX,GAAIvK,GAAYA,IAAa,EAAG,CAC5B,GAAIA,EAASmB,MACTnB,EAAS6T,OAAS7T,EAASmB,QAE/BoJ,EAAOlL,KAAK4V,MAAMjV,IAAaA,EAC/BI,EAAQf,KAAKmU,cAAcxT,GAG/B,GAAII,IAAU,KACVA,EAAQ,GAEZf,KAAK6M,SAAS9L,GACdf,KAAKoL,cAAcF,EAAMvK,GACzBX,KAAKkW,UAAUnV,GAEf,IAAKf,KAAKsV,wBAA0BtV,KAAKiJ,mBACrCjJ,KAAK8C,QAAQsF,GAEjBpI,KAAKiJ,mBAAqB,MAE1B,GAAIjJ,KAAKH,QAAQsN,WAAanN,KAAKuK,MAAMgF,UAAW,CAChDvP,KAAK6F,QACL7F,KAAKI,QAAQ0C,QAAQ,SAEzB9C,KAAKuK,MAAMgL,WACXvV,KAAK+K,0BAGToL,YAAa,SAAS1V,GAClBA,EAAE2V,kBACFpW,KAAKI,QAAQ0C,QAAQ,SACrB9C,KAAKqW,sBAGTA,mBAAoB,WAChBrW,KAAK6M,SAAS,IACd7M,KAAKsW,cACLtW,KAAKuW,aACLvW,KAAKwI,WAAWgO,cAChBxW,KAAKuK,MAAMgL,WACXvV,KAAK+K,0BAGTwL,WAAY,WACR,GAAIvW,KAAKH,QAAQwL,YACbrL,KAAK2J,aAAa,WAElB,GAAI3J,KAAK+M,KACL/M,KAAK+M,KAAKjG,KAAK,KAK3BuC,eAAgB,WACZ,IAAI4C,EAAWjM,KAAKH,QAAQ2O,cAE5B,IAAKvC,EACDA,EAAW7N,EAAM6N,SAAS,sBAAuB,CAAEwK,aAAc,QAASlW,KAAKP,WAE/EiM,EAAW7N,EAAM6N,SAASA,GAG9BjM,KAAKwO,cAAgBvC,GAGzByK,gBAAiB,SAASxL,EAAMnK,GAC5B,IAAI8K,EAAgB7L,KAAKH,QAAQgM,cACjC,IAAIlL,EAAW,GAEf,GAAIkL,EAAe,CACf8K,EAAOhW,EAAUkL,EAAc+K,MAAMlP,GAAMwD,GAC3CyL,EAAOhW,EAAUX,KAAKH,QAAQyN,eAAesJ,MAAMlP,GAAM3G,GACzDJ,EAAW,IAAIsG,EAAiBtG,QAEhCA,EAAWuK,EAGf,OAAOvK,GAGXyK,cAAe,SAASF,EAAMvK,GAC1B,IAAI6N,EAAgBxO,KAAKwO,cACzB,IAAIzB,EAAO/M,KAAK+M,KAEhB,GAAI7B,IAAS5M,EACT,OAAOyO,EAAK7B,OAGhB6B,EAAK8J,YAAY,cAEjB,IAAKlW,IAAazC,EAAE4Y,cAAc5L,IAASA,aAAgBjE,GACvDtG,EAAWuK,EAGf,IAAKvK,EACDA,EAAWX,KAAK0W,gBAAgBxL,EAAMlL,KAAKkW,aAG/C,IAAIa,EAAc,WACd,MAAO,CACH5E,SAAUpF,EAAKiK,MACfzR,KAAM,CAAE,CAAE5E,SAAUA,MAI5BX,KAAKkS,QAAQ,UAAW6E,GAExB,IACIhK,EAAKjG,KAAK0H,EAAc7N,IAC1B,MAAOF,GAEL,GAAIsM,EACAA,EAAKjG,KAAK,IAIlB9G,KAAKkS,QAAQ,UAAW6E,IAG5BzN,WAAY,WACR,IAAI1J,EAAUI,KAAKJ,QACnB,IAAIC,EAAUG,KAAKH,QACnB,IAAIoX,EAAS7Y,EAAM6Y,OACnB,IAAIC,EAAYtX,EAAQ+C,KAAKvE,EAAMuE,KAAK,eACxC,IAAIwU,EAAavX,EAAQ+C,KAAKvE,EAAMuE,KAAK,gBAEzC,IAAIyU,EAAiB,SAASvV,GAC1B,GAAIqH,MAAMC,QAAQtH,GAAQ,CACtB,IAAIwV,EAAQxV,EAAMrC,OAClB,IAAI8X,EAASpZ,EAAEqZ,IAAI1V,EAAO,SAAS2V,GAC/B,OAAO,SAASC,GAAK,OAAOA,EAAED,MAGlC,OAAO,SAAS7W,GACZ,IAAImB,EAAQnB,EAAS6T,OAErB,IAAK1S,GAASA,IAAU,EACpB,OAGJ,OAAOwV,EAAOI,KAAKC,IAAI7V,EAAOuV,EAAQ,IAAI1W,SAG9C,OAAOsW,EAAOpV,IAItB,IAAKhC,EAAQgM,eAAiBqL,EAC1BrX,EAAQgM,cAAgBqL,EAG5B,IAAKrX,EAAQyN,gBAAkB6J,EAC3BtX,EAAQyN,eAAiB6J,EAG7BtX,EAAQgM,cAAgBhM,EAAQgM,eAAiB,OACjDhM,EAAQyN,eAAiBzN,EAAQyN,gBAAkB,QAEnDtN,KAAK4V,MAAQwB,EAAevX,EAAQgM,eACpC7L,KAAKqU,OAAS+C,EAAevX,EAAQyN,iBAGzC4I,UAAW,SAASnV,EAAOoU,GACvB,OAAOnV,KAAK4X,eAAe7W,EAAOoU,IAGtCyC,eAAgB,SAAS7W,GACrB,IAAInB,EAAUI,KAAKJ,QAAQ,GAE3B,GAAImB,IAAUzC,EACV,OAAOsB,EAAQmB,UACZ,CACH,GAAIA,IAAU,KACVA,EAAQ,GAEZnB,EAAQmB,MAAQA,IAIxBuV,YAAa,WACT,IAAI1W,EAAUI,KAAKJ,QAAQ,GAC3BA,EAAQmB,MAAQ,IAGpB0J,aAAc,WACV,IAAIoN,EAAa7X,KAAKH,QAAQ+N,SAASE,MAEvC,IAAK9N,KAAK0Q,OACN1Q,KAAK0Q,OAASxS,EAAE,wDAA0D2Z,EAAa,+CAA+ClV,KAAK,CACvI6O,KAAQ,SACR1H,UAAa,IAIrB,GAAI9J,KAAKH,QAAQwN,YAAa,CAC1BrN,KAAK0Q,OAAOoH,YAAY9X,KAAK2Q,SAAW3Q,KAAK+M,KAAKvJ,UAClDxD,KAAKI,QAAQqP,SAAS,iCAEtB,IAAKzP,KAAKH,QAAQwN,YACdrN,KAAK0Q,OAAOsB,UAKxBjH,uBAAwB,WACpB,IAAIgN,EAAa/X,KAAKJ,QAAQ+C,KAAKgF,GACnC,IAAIqQ,EAAYhY,KAAKe,UAAYf,KAAKG,wBAA2BH,KAAKe,QAAQvB,OAC9E,IAAIyY,EAA+BjY,KAAKJ,QAAQiJ,OAAS7I,KAAKJ,QAAQiJ,QAAU7I,KAAKH,QAAQwL,YAE7F,IAAM0M,IAAeC,GAAYC,GAC7BjY,KAAKkY,kBAELlY,KAAKmY,cAIbD,WAAY,WACR,GAAIlY,KAAK0Q,OACL1Q,KAAK0Q,OAAOmG,YAAYxP,IAIhC8Q,WAAY,WACR,GAAInY,KAAK0Q,OACL1Q,KAAK0Q,OAAOjB,SAASpI,IAI7BuM,aAAc,SAASnT,GACnBT,KAAKuS,mBAEL,GAAIvS,KAAK8C,QAAQoF,GACbzH,EAAEmF,qBACC,CACF5F,KAAKI,QAAQuC,KAAK,gBAAiB,MACnC3C,KAAK6J,KAAKlH,KAAK,cAAe,OAAOA,KAAK,OAAQ,UAI3DkR,cAAe,SAASpT,GACpB,GAAIT,KAAK8C,QAAQqF,GACb1H,EAAEmF,qBACC,CACF5F,KAAKI,QAAQuC,KAAK,gBAAiB,OACnC3C,KAAK6J,KAAKlH,KAAK,cAAe,QAIvCgI,UAAW,WACP,IAAI5K,EAAOC,KACX,GAAID,EAAKF,QAAQ6N,OACb3N,EAAK8J,KAAK0G,IAAI,aAAaxQ,EAAKF,QAAQ6N,QAE5C3N,EAAK8J,KAAKlH,KAAK,KAAMvE,EAAMsT,QAC3B3R,EAAKiM,SAAW,IAAI9M,EAASa,EAAK8J,KAAMnK,EAAO,CAAEqM,KAAMhM,EAAKF,QAAQkM,MAAQhM,EAAKF,QAAQmM,UAAWjM,GACpGA,EAAKoM,WAAapM,EAAKiM,SAASG,WAEhCpM,EAAKiM,SAASzL,KAAK,SAAS,SAASE,GACjCV,EAAK+C,QAAQ,SAAUrC,MAI/BsC,mBAAoB,SAAStC,GACzB,GAAIA,EAAEpB,MAAQW,KAAKoY,OAASpY,KAAKoY,MAAM5Y,OACnCiB,EAAEuC,OAAO2B,OAAOlE,EAAEpB,MAGtB,GAAIW,KAAKgQ,WAAY,CACjB,IAAKvP,EAAEpB,KACHW,KAAKgQ,WAAa,MAGtB,IAAKhQ,KAAKG,uBACNH,KAAKqY,cAAc5X,GAEvB,OAGJ,IAAKT,KAAKgM,SACNhM,KAAKgM,SAAWvL,EAAEuC,OAGtB,IAAKvC,EAAEpB,KAAM,CACT,IAAIiZ,EAAY7X,EAAEuC,OAAOmJ,WAAW5G,OAEpCvF,KAAKuY,kBAAkBD,GACvB,GAAItY,KAAK+I,gBACL/I,KAAK+I,gBAAkB,UAExB,CACH,IAAIyP,EAAW/X,EAAEuC,OAAOrC,SAASF,EAAEpB,MACnC,GAAImZ,EAAU,CACV,IAAIC,EAAWD,EAASjZ,SAASgG,OACjCvF,KAAKuY,kBAAkBE,IAG/BzY,KAAK8C,QAAQ,YAAarC,IAG9B4X,cAAe,SAAS5X,GACpB,IAAIa,EAAQ,GACZ,IAAKb,EAAEpB,KACHiC,EAAQb,EAAEuC,OAAOmJ,WAAW5G,WACzB,CACH,IAAIiT,EAAW/X,EAAEuC,OAAOrC,SAASF,EAAEpB,MACnC,GAAImZ,EACAlX,EAAQkX,EAASjZ,SAASgG,OAIlC,IAAK,IAAI5D,EAAI,EAAGA,EAAIL,EAAM9B,OAAQmC,IAC9B,GAAIL,EAAMK,GAAGsE,WACRjG,KAAK0Y,eAAepX,EAAMK,GAAI3B,KAAKe,SACpCO,EAAMK,GAAGf,IAAI,WAAY,QAKrC2X,kBAAmB,SAASjX,GACxB,IAAIP,EAAQf,KAAKe,QAEjB,IAAKO,EACD,OAGJ,IAAK,IAAI6T,EAAM,EAAGA,EAAM7T,EAAM9B,OAAQ2V,IAClCnV,KAAKwI,WAAWmQ,iBAAiBrX,EAAM6T,GAAMpU,IAIrDsU,uBAAwB,SAAS1U,GAC7B,GAAIX,KAAKH,QAAQ4D,UAAYzD,KAAKyD,SAAU,CACxCzD,KAAK4Y,iBAEL,GAAIjY,EAASE,QACTb,KAAK6Y,sBAEL7Y,KAAK8Y,qBAKjBD,eAAgB,WACZ,IAAIE,EAAmB/Y,KAAKyD,SAASb,KAAK,eAE1C,GAAI5C,KAAKgZ,oBACLD,EAAiBzT,KAAK,UAAW,MAChBA,KAAK,gBAAiB,YAEvCyT,EAAiBzT,KAAK,gBAAiB,OAI/CwT,iBAAkB,WACd,IAAIC,EAAmB/Y,KAAKyD,SAASb,KAAK,eAE1C,GAAI5C,KAAKiZ,sBACLF,EAAiBzT,KAAK,UAAW,OAChBA,KAAK,gBAAiB,YAEvCyT,EAAiBzT,KAAK,gBAAiB,OAI/CoF,cAAe,WACX,IAAIwO,EAAiB,8BACjB,0GACI,uDACJ,UACJ,SAEA,GAAIlZ,KAAK2D,YAAa,CAClB3D,KAAK2D,YACA8M,IAAIrJ,GACJ5D,SACAwO,SAELhS,KAAK2D,YAAc,KAGvB,GAAI3D,KAAKoP,mBAAoB,CACzBpP,KAAKmZ,wBAELnZ,KAAK2D,YAAczF,EAAE,+CAChByE,KAAK,CACF0I,YAAarL,KAAKJ,QAAQ+C,KAAK,eAC/ByW,MAAOpZ,KAAKJ,QAAQ+C,KAAK,SACzB6O,KAAM,YACNH,gBAAiB,UACjBgI,oBAAqB,SAG7BrZ,KAAK2D,YAAYtD,GAAG,QAAUL,KAAKsZ,cAAc/Y,KAAKP,OAEtD9B,EAAEgb,GACGK,aAAavZ,KAAK6J,MAClBjH,KAAK,gBACLqH,OAAOjK,KAAK2D,eAIzB2V,cAAe,WACX,GAAItZ,KAAK2D,YACL3D,KAAKqP,WAIb8J,sBAAuB,WACnB,GAAInZ,KAAKG,wBAA0BH,KAAKH,QAAQmM,SAAStK,YAAc1B,KAAKH,QAAQmM,SAAStK,WAAWD,cACpGzB,KAAKH,QAAQmM,SAAStK,WAAWD,cAAgB,OAIzDoJ,UAAW,WACP,GAAI7K,KAAKyD,SAAU,CACfzD,KAAKyD,SAASb,KAAK,kCACd6N,IAAIrJ,GACTpH,KAAKyD,SAASuO,SAEdhS,KAAKyD,SAAW,KAGpB,GAAIzD,KAAKG,wBAA0BH,KAAKH,QAAQ4D,SAAU,CACtD,IAAIsV,EAAmBjS,EAAK0S,eAAe9Z,EAAO,GAAIM,KAAKH,QAAS,CAChE4Z,MAAO,YACP9K,QAAS,YAEb3O,KAAKyD,SAAWvF,EAAE,4BAA8B6a,EAAmB,UAAUQ,aAAavZ,KAAK6J,MAC/F7J,KAAKyD,SAASb,KAAK,qBAAqBkE,KAAK1I,EAAM6N,SAASjM,KAAKH,QAAQsO,iBAA5B/P,CAA8C,CAAEiU,SAAUrS,QACvGA,KAAKyD,SAASb,KAAK,eACFvC,GAAG,SAAW+G,EAAIpH,KAAK0Z,gBAAgBnZ,KAAKP,OAC5CK,GAAG,UAAY+G,EAAIpH,KAAK2Z,iBAAiBpZ,KAAKP,OAC/DA,KAAK4Z,sBAAwB,GAC7B5Z,KAAK6Z,wBAA0B,GAE/B7Z,KAAK4Y,iBAEL,IAAK5Y,KAAKiZ,sBACNjZ,KAAK6Y,mBAKjBa,gBAAiB,WACb,IAAIX,EAAmB/Y,KAAKyD,SAASb,KAAK,eAC1C,IAAIkX,EAAYf,EAAiBzT,KAAK,WAEtCtF,KAAK+Z,gBAAgBD,IAGzBC,gBAAiB,SAASD,GACtB,IAAIf,EAAmB/Y,KAAKyD,SAASb,KAAK,eAC1C5C,KAAKga,qBAAqBF,GAC1Bf,EAAiBzT,KAAK,UAAWwU,GACjC,GAAI9Z,KAAK4Z,sBAAsBpa,QAAUQ,KAAK6Z,wBAAwBra,OAClEuZ,EAAiBzT,KAAK,gBAAiB,WACpC,GAAItF,KAAK4Z,sBAAsBpa,OAClCuZ,EAAiBzT,KAAK,iBAAkBwU,QACrC,GAAI9Z,KAAK6Z,wBAAwBra,OACpCuZ,EAAiBzT,KAAK,gBAAiBwU,QAEvCf,EAAiBzT,KAAK,gBAAiB,OAE3CtF,KAAK4Z,sBAAwB,GAC7B5Z,KAAK6Z,wBAA0B,IAGnCF,iBAAkB,SAASlZ,GACvB,IAAIoD,EAAMpD,EAAEqD,QACZ,IAAIkB,EAASvE,EAAEuE,OAEf,GAAKA,GAAUnB,IAAQrF,EAAKuG,IAAOlB,IAAQrF,EAAKiH,KAAO5B,IAAQrF,EAAKmH,IAAK,CACrE3F,KAAK6F,QACL7F,KAAKI,QAAQ0C,QAAQ,SACrBrC,EAAEmF,iBACF,OAGJ,GAAI/B,IAAQrF,EAAKuG,GAAI,CACjB,GAAI/E,KAAK2D,YACL3D,KAAK2D,YAAYb,QAAQ,cAEzB9C,KAAKI,QAAQ0C,QAAQ,SAGzBrC,EAAEmF,iBAGN,GAAI/B,IAAQrF,EAAKsG,KAAM,CACnB,GAAI9E,KAAK6J,MAAQ7J,KAAK6J,KAAKnG,GAAG,YAC1B1D,KAAK6J,KAAKgF,QAGdpO,EAAEmF,iBAGN,GAAI/B,IAAQrF,EAAK6G,WAAakC,EAAQuL,MAAQvL,EAAQ0S,MAAO,CACzDja,KAAKka,iBACLzZ,EAAEmF,mBAIVsU,eAAgB,WACZ,IAAInB,EAAmB/Y,KAAKyD,SAASb,KAAK,eAC1C,IAAIkX,EAAYf,EAAiBzT,KAAK,WAEtCtF,KAAK+Z,iBAAiBD,GAEtBf,EAAiBjW,QAAQ,UAI7BqX,KAAM,SAAS7Y,EAAOD,EAAQiE,GAC1B,IAAK,IAAI6P,EAAM,EAAGA,EAAM7T,EAAM9B,OAAQ2V,IAAO,CACzC,IAAKnV,KAAKqB,GAAQC,EAAM6T,GAAM7P,GAC1B,MAEJtF,KAAKoa,kBAAkB9Y,EAAM6T,GAAM9T,EAAQiE,KAInD+U,kBAAmB,SAASpY,GACxBjC,KAAKma,KAAKna,KAAKmM,WAAW5G,OAAQ,wBAAyBtD,IAG/DqY,sBAAuB,SAAS1F,EAAM3S,GAClC,GAAI2S,EAAKpH,UAAY,OAASoH,EAAKC,SAAW5S,EAAK,CAC/C2S,EAAKhU,IAAI,UAAW,OACpB,OAAO,MAEX,OAAO,MAGXuQ,kBAAmB,SAASjG,GACxBlL,KAAKma,KAAKna,KAAKmM,WAAW5G,OAAQ,kBAAmB2F,IAGzDqP,gBAAiB,SAAS3F,EAAM1J,GAC5B,GAAI0J,EAAKpH,UAAY,OAASxN,KAAK4V,MAAMhB,KAAU1J,EAAM,CACrDlL,KAAKgM,SAAS5G,OAAOpF,KAAKgM,SAAShK,UAAU4S,EAAK3S,MAClDjC,KAAKkG,aAAa0O,GAClB,OAAO,MAEX,OAAO,MAGX4F,mBAAoB,SAASzZ,GACzBf,KAAKma,KAAKna,KAAKmM,WAAW5G,OAAQ,mBAAoBxE,IAG1D0Z,iBAAkB,SAAS7F,EAAM7T,GAC7B,GAAI6T,EAAKpH,UAAY,OAASxN,KAAK0Y,eAAe9D,EAAM7T,GAAQ,CAE5Df,KAAKgM,SAAS5G,OAAOpF,KAAKgM,SAAShK,UAAU4S,EAAK3S,MAElD,OAAO,MAEX,OAAO,MAGXyY,kBAAmB,SAAS3Z,GACxB,IAAIO,EAAQtB,KAAKgM,SAAS2O,YAC1B,IAAK,IAAIxF,EAAM,EAAGA,EAAMpU,EAAMvB,OAAQ2V,IAClCnV,KAAKma,KAAK7Y,EAAO,wBAAyBP,EAAMoU,KAIxDyF,sBAAuB,SAAShG,EAAM7T,GAClC,GAAI6T,EAAKpH,UAAY,OAASxN,KAAK0Y,eAAe9D,EAAM7T,GAAQ,CACxD6T,EAAKhU,IAAI,UAAW,MACxB,OAAO,MAEX,OAAO,MAGX8X,eAAgB,SAAS9D,EAAM7T,GAC3B,IAAI8Z,EAAY7a,KAAKqU,OAAOO,GAC5B,IAAIkG,EAEJ,IAAK9a,KAAKgJ,mBAAmB6R,GAAY,CACrC,GAAI7a,KAAKgJ,mBAAmBjI,GACxB,OAAO,MAGX,IAAIga,EAAW/a,KAAKqU,OAAOtT,GAE3B,GAAIga,EACA,OAAOF,GAAaE,OAEpB,OAAOF,GAAa9Z,EAI5B+Z,EAAW9a,KAAK4V,MAAMhB,GACtB,GAAIkG,EACA,GAAI9a,KAAK4V,MAAM7U,GACX,OAAO+Z,GAAY9a,KAAK4V,MAAM7U,QAE9B,OAAO+Z,GAAY/Z,EAI3B,OAAO,OAGXiI,mBAAoB,SAASjI,GACzB,OAAOA,IAAUzC,GAAayC,IAAU,MAG5C6X,eAAgB,WACZ5Y,KAAKgb,iBAAmB,GACxBhb,KAAKgZ,oBAAsB,KAC3BhZ,KAAKiZ,sBAAwB,KAE7BjZ,KAAKma,KAAKna,KAAKmM,WAAW5G,OAAQ,uBAElC,OAAOvF,KAAKgb,kBAGhBC,oBAAqB,SAASrG,GAC1B,GAAI5U,KAAKgZ,oBACLhZ,KAAKgZ,oBAAsBpE,EAAK/T,QAGpC,GAAIb,KAAKiZ,sBACLjZ,KAAKiZ,uBAAyBrE,EAAK/T,QAGvC,GAAI+T,EAAK/T,QACLb,KAAKgb,iBAAiBhG,KAAKJ,GAE/B,OAAO,MAGXwF,kBAAmB,SAASxF,EAAMvT,EAAQiE,GACtC,IAAI4V,EAAiBtG,EAAKuG,kBAAoBvG,EAAKuG,iBAAiBC,OAAUxG,EAAKuG,iBAAiBC,OAAO7V,KAAO,KAClH,IAAIkT,EAAW7D,EAAKsG,IAAkBtG,EAAKtT,OAASsT,EAAKrV,SAEzD,IAAKkZ,EACD,OAGJzY,KAAKma,KAAK1B,EAAUpX,EAAQiE,IAGhC0U,qBAAsB,SAASnZ,GAC3Bb,KAAKma,KAAKna,KAAKmM,WAAW5G,OAAQ,qBAAsB1E,IAG5Dwa,mBAAoB,SAASzG,EAAM/T,GAC/B,GAAI+T,EAAKpH,UAAY,MACjB,GAAIoH,EAAK/T,QACLb,KAAK4Z,sBAAsB5E,KAAKJ,QAEhC5U,KAAK6Z,wBAAwB7E,KAAKJ,QAGtCA,EAAKhU,IAAI,UAAWC,GAExB,OAAO,MAGXuO,iBAAkB,WACd,IAAIhQ,EAASY,KAAKH,QAAQT,OAC1B,OAAOA,GAAUA,IAAW,QAGhC2P,UAAW,SAASlP,GAChB,IAAIE,EAAOC,KACX,IAAIJ,EAAUG,EAAKH,QACnB,IAAIoP,EAAUnP,EAAQmP,QACtB,IAAIF,EAAWjP,EAAQiP,SACvB,IAAI1O,EAAUL,EAAKK,QAAQkb,IAAIvb,EAAK4D,aAAa8M,IAAIrJ,GACrD,IAAImU,EAAkBxb,EAAKK,QAAQqQ,IAAIzI,GACvC,GAAIjI,EAAKI,uBACLJ,EAAK4Q,QAAQF,IAAI5R,EAAQuI,GAE7B,IAAK0H,IAAaE,EAAS,CACvBpP,EAAQ0F,KAAK7G,EAAU,OAAO6G,KAAKqC,EAAU,OAE7C4T,EACK1E,YAAYjP,GACZvH,GAAG2H,EAAajI,EAAKyb,cAE1Bzb,EAAK2Q,OAAOrQ,GAAG,QAAU+G,EAAIrH,EAAKoW,YAAY5V,KAAKR,IACnDK,EACKuC,KAAKsF,EAAU7H,EAAQmF,KAAK0C,IAC5BtF,KAAKkF,EAAe,OACpBxH,GAAG,UAAY+G,EAAIrH,EAAK6D,SAASrD,KAAKR,IACtCM,GAAG,UAAY+G,EAAIrH,EAAK0b,gBAAgBlb,KAAKR,IAC7CM,GAAG,WAAa+G,EAAIrH,EAAK2b,iBAAiBnb,KAAKR,IAEpDA,EAAKK,QAAQC,GAAGxB,EAAQuI,EAAIrH,EAAK4b,cAAcpb,KAAKR,IAEpD,GAAIC,KAAKG,uBAAwB,CAC7BJ,EAAK4Q,QAAQtQ,GAAGxB,EAAQuI,EAAI,cAAe,SAAS3G,GAChDvC,EAAEuC,EAAES,eAAeuO,SAAS1H,KAGhChI,EAAK4Q,QAAQtQ,GAAGxB,EAAQuI,EAAI,gBAAiB,SAAS3G,GAClDV,EAAK6b,gBAAgBnb,WAG1B,GAAIuO,EAAS,CAChB5O,EAAQ8T,WAAWjM,GACnBsT,EACK9L,SAAS7H,OACX,CACHxH,EACKuC,KAAKsF,EAAU7H,EAAQmF,KAAK0C,IAEjCsT,EACK1E,YAAYjP,GAEjBxH,EACKC,GAAG,UAAY+G,EAAIrH,EAAK0b,gBAAgBlb,KAAKR,IAC7CM,GAAG,WAAa+G,EAAIrH,EAAK2b,iBAAiBnb,KAAKR,IAGxDH,EAAQ+C,KAAKlE,EAAUuQ,GACfrM,KAAKgF,EAAUmH,GAEvB1O,EAAQuC,KAAKkF,EAAemH,IAGhCyM,gBAAiB,WACbzb,KAAKI,QAAQqP,SAAS1H,GACtB/H,KAAK6b,SAAW,OAGpBH,iBAAkB,WACd,IAAI3b,EAAOC,KAEX,GAAIA,KAAKG,uBACLH,KAAK2Q,QAAQ/N,KAAK8E,EAAMK,GAAS8O,YAAY9O,GAEjD,IAAKhI,EAAK8b,SAAU,CAChB7b,KAAKI,QAAQyW,YAAY9O,GACzBhI,EAAK8b,SAAW,KAChB9b,EAAKH,QAAQkD,QAAQ,UAI7BqM,QAAS,SAASD,GACdA,EAAOA,IAAS5Q,EAAY4Q,GAAQlP,KAAKuK,MAAMgF,UAE/CvP,KAAKkP,EAAOhH,EAAOC,MAGvBwT,cAAe,SAASlb,GACpBA,EAAEmF,iBACF5F,KAAKuK,MAAMqG,OAAO,WAAY5Q,KAAK0I,oBACnC1I,KAAK8b,SAAW9b,KAAKI,QACrBJ,KAAK6b,SAAW,MAChB7b,KAAKmP,WAGTqM,aAAc,SAAS/a,GACnBvC,EAAEuC,EAAES,eAAe6S,YAAYjM,EAAOrH,EAAEsb,OAAS,eAGrDpT,YAAa,WACT,GAAI3I,KAAK2D,YACL3D,KAAK2D,YAAYb,QAAQ,cACtB,GAAI9C,KAAKyD,SACZzD,KAAKyD,SAASb,KAAK,eAAeE,QAAQ,cACvC,GAAI9C,KAAK6J,KAAKnG,GAAG,YAAa,CACjC1D,KAAK6J,KAAK,GAAGgF,MAAM,CAAEmN,cAAe,OACpChc,KAAKic,8BAIbA,0BAA2B,WACvB,GAAI1U,EAAQuL,MAAQvL,EAAQ2U,SAAW,GAAI,CACvC,IAAI3R,EAAQvK,KAAKuK,MACjBA,EAAM4R,cAAc,OACpB1I,WAAW,WACPlJ,EAAM4R,cAAc,OACtB,MAIVvY,SAAU,SAASnD,GACf,IAAIoD,EAAMpD,EAAEqD,QACZ,IAAIkB,EAASvE,EAAEuE,OACf,IAAIoX,EACJ,IAAIC,EACJ,IAAIrY,EAASsY,EAEb,IAAIC,EAAiBvc,KAAKuK,MAAMgF,UAEhC,GAAIvP,KAAK2D,YACLyY,EAAsBpc,KAAK2D,YAAY,KAAOuD,IAGlD,GAAIlH,KAAKI,QACLic,EAAkBrc,KAAKI,QAAQ,KAAO8G,IAG1C,GAAImV,EAAiB,CACjB,GAAIxY,IAAQrF,EAAKiH,IAAK,CAClBzF,KAAKqW,qBACL5V,EAAEmF,iBACF,OAGJ,GAAI5F,KAAKG,uBAAwB,CAC7B,GAAI0D,IAAQrF,EAAKgG,KAAM,CACnBxE,KAAKwc,gBACL/b,EAAEmF,iBACF,OAGJ,GAAI/B,IAAQrF,EAAK+F,MAAO,CACpBvE,KAAKyc,gBACHhc,EAAEmF,iBACJ,OAGJ,GAAI/B,IAAQrF,EAAKyG,KAAM,CACnBjF,KAAK0c,iBACLjc,EAAEmF,iBACF,OAGJ,GAAI/B,IAAQrF,EAAK0G,IAAK,CAClBlF,KAAK2c,gBACLlc,EAAEmF,iBACF,OAGJ,GAAI/B,IAAQrF,EAAKoe,OAAQ,CACrB5Y,EAAUhE,KAAK2Q,QAAQ/N,KAAK8E,EAAMK,GAAS5D,QAC3C,GAAIH,EAAQxE,OAAQ,CAChB8c,EAAUtc,KAAK4M,MAAM5I,EAAQ3B,SAC7BrC,KAAK6c,WAAWP,GAEpB7b,EAAEmF,iBACF,OAGJ,GAAI/B,IAAQrF,EAAKse,UAAW,CACxB9Y,EAAUhE,KAAK2Q,QAAQ/N,KAAK8E,EAAMK,GAAS5D,QAC3C,GAAIH,EAAQxE,OAAQ,CAChB8c,EAAUtc,KAAK4M,MAAM5I,EAAQ3B,SAC7BrC,KAAK6c,WAAWP,OACb,CACHtY,EAAUhE,KAAK2c,gBACf,GAAI3Y,EAAQxE,OAAQ,CAChB8c,EAAUtc,KAAK4M,MAAM5I,EAAQ3B,SAC7BrC,KAAK6c,WAAWP,IAGxB7b,EAAEmF,iBACF,SAMZ,GAAIwW,EAAqB,CACrB,GAAIvY,IAAQrF,EAAKiH,IACbzF,KAAK+c,eAGT,GAAKlZ,IAAQrF,EAAKuG,KAAQC,EAAQ,CAC9BhF,KAAKI,QAAQ0C,QAAQ,SACrBrC,EAAEmF,iBAGN,GAAI2B,EAAQuL,MAAQvL,EAAQ2U,QAAU,GAClC,GAAIrY,IAAQrF,EAAKse,WAAajZ,IAAQrF,EAAKoe,OACvC5c,KAAKqP,UAIb,GAAIxL,IAAQrF,EAAKmH,IAAK,CAClB3F,KAAK6F,QACL7F,KAAKI,QAAQ0C,QAAQ,SACrBrC,EAAEmF,iBACF,QAIR,GAAKZ,GAAUnB,IAAQrF,EAAKuG,IAAOlB,IAAQrF,EAAKiH,IAAK,CACjDzF,KAAK6F,QACL7F,KAAKI,QAAQ0C,QAAQ,SACrBrC,EAAEmF,iBACF,OAGJ,GAAI/B,IAAQrF,EAAK2G,OAASnF,KAAK8P,gBAAkB9P,KAAK2D,aAAe4Y,EAAgB,CACjF9b,EAAEmF,iBACF,OAGJ,GAAI/B,IAAQrF,EAAK6G,WAAa+W,EAAqB,CAC/Cpc,KAAKmP,SAASoN,GACd9b,EAAEmF,iBAGN,GAAKZ,GAAUnB,IAAQrF,EAAKsG,OAAUyX,EAAgB,CAClDvc,KAAKkP,OACLzO,EAAEmF,iBAGN,GAAK/B,IAAQrF,EAAKsG,MAASyX,EAAgB,CACvC,GAAIvc,KAAK2D,cAAgByY,EACrBpc,KAAK2D,YAAYb,QAAQ,cACtB,GAAI9C,KAAKyD,UAAYzD,KAAKyD,SAASC,GAAG,YACzC1D,KAAKyD,SAASb,KAAK,SAASE,QAAQ,cACjC,GAAI9C,KAAK6J,KAAKnG,GAAG,YAAa,CACjC1D,KAAK6J,KAAK,GAAGgF,MAAM,CAAEmN,cAAe,OACpChc,KAAKic,4BAETxb,EAAEmF,iBAGN,GAAI/B,IAAQrF,EAAKmH,KAAO4W,EAAgB,CACpCvc,KAAK6F,QACL7F,KAAKI,QAAQ0C,QAAQ,SACrBrC,EAAEmF,mBAIV4W,cAAe,WACX,IAAIxY,EAAUhE,KAAK2Q,QAAQ/N,KAAK8E,EAAMK,GACtC,GAAI/D,EAAQxE,OAAQ,CAChB,IAAIwd,EAAmBhd,KAAKyR,UAE5BzN,EAAQG,QACH0S,YAAY9O,GACZmM,WAAW,MACX9Q,KAAKkF,GACLmH,SAAS1H,GACTpF,KAAK,KAAMqa,GAEhBhd,KAAKI,QAAQuC,KAAK,wBAAyBqa,QAE3Chd,KAAK2c,iBAIbF,cAAe,WACX,IAAIzY,EAAUhE,KAAK2Q,QAAQ/N,KAAK8E,EAAMK,GAEtC,GAAI/D,EAAQxE,OAAQ,CAChB,IAAIwd,EAAmBhd,KAAKyR,UAE5BzN,EAAQG,QACH0S,YAAY9O,GACZmM,WAAW,MACX+I,KAAK3U,GACLmH,SAAS1H,GACTpF,KAAK,KAAMqa,GAEhBhd,KAAKI,QAAQuC,KAAK,wBAAyBqa,QAE3Chd,KAAK0c,kBAIbA,eAAgB,WACZ,IAAIM,EAAmBhd,KAAKyR,UAE5BzR,KAAKkd,oBAEL,IAAIC,EAAWnd,KAAK2Q,QAAQpR,SAAS+I,GAAMnE,QACtCsL,SAAS1H,GACTpF,KAAK,KAAMqa,GAEhBhd,KAAKI,QAAQuC,KAAK,wBAAyBqa,GAE3C,OAAOG,GAGXR,cAAe,WACX,IAAIK,EAAmBhd,KAAKyR,UAE5BzR,KAAKkd,oBAEL,IAAIE,EAAUpd,KAAK2Q,QAAQpR,SAAS+I,GAAMhF,OACrCmM,SAAS1H,GACTpF,KAAK,KAAMqa,GAEhBhd,KAAKI,QAAQuC,KAAK,wBAAyBqa,GAE3C,OAAOI,GAGXF,kBAAmB,WACfld,KAAK2Q,QAAQ/N,KAAK8E,EAAMK,GAAS8O,YAAY9O,GAASmM,WAAW,OAGrE7E,QAAS,WACL,IAAItP,EAAOC,KACX6P,aAAa9P,EAAK+P,gBAElB/P,EAAK+P,eAAiB2D,WAAW,WAC7B,IAAI1S,EAAQhB,EAAK4D,YAAYkF,MAE7B,GAAI9I,EAAKqY,QAAUrX,EAAO,CACtBhB,EAAKqY,MAAQrX,EACbhB,EAAK4P,OAAO5O,GAGhBhB,EAAK+P,eAAiB,MACvB/P,EAAKF,QAAQ0N,QAGpBwP,aAAc,WACV,GAAI/c,KAAK2D,YAAYkF,MAAMrJ,OAAQ,CAC/BQ,KAAK2D,YAAYkF,IAAI,IACrB7I,KAAKoY,MAAQ,GACbpY,KAAKgQ,WAAa,KAClBhQ,KAAKgM,SAASG,WAAW/M,OAAO,MAIxCwc,gBAAiB,SAASnb,GACtBA,EAAE2V,kBACF,IAAIkG,EAAUtc,KAAK4M,MAAM1O,EAAEuC,EAAES,cAAcsS,QAAQlL,IAAOjG,SAC1DrC,KAAK6c,WAAWP,IAGpBO,WAAY,SAASP,GAClB,IAAKA,EACA,OAGL,IAAIra,EAAMqa,EAAQra,IAClBjC,KAAKqa,kBAAkBpY,MAI9B,SAAS0U,EAAOtE,EAAUgL,EAAQtc,GAC9B,IAAIoU,EAAM,EACNmI,EAAYD,EAAO7d,OAAS,EAC5BqC,EAEJ,KAAOsT,EAAMmI,IAAanI,EAAK,CAC3BtT,EAAQwb,EAAOlI,GAEf,KAAMtT,KAASwQ,GACXA,EAASxQ,GAAS,GAGtBwQ,EAAWA,EAASxQ,GAGxBwQ,EAASgL,EAAOC,IAAcvc,EAGlCxC,EAAGgf,OAAOhV,GAEVnK,EAAMof,cAAcC,eAAe,eAAgB,aAEnDrf,EAAMof,cAAcE,eAAe,eAAgB,CAAC,CAChDpY,KAAM,UACNqY,OAAQvf,EAAMof,cAAcI,cAAcC,OAAO,CAAC,CAAC,OAAQ,aAG/Dzf,EAAMof,cAAcC,eAAe,0BAA2B,YAE9Drf,EAAMof,cAAcE,eAAe,0BAA2B,CAAC,CAC3DpY,KAAM,UACNqY,OAAQvf,EAAMof,cAAcI,cAAcC,OAAO,CAAC,CAAC,OAAQ,aAG/D,IAAIpR,EAAkBrO,EAAM0f,MAAMpe,OAAO,CACrCC,KAAM,SAASoe,GACX/d,KAAKmG,cAAgB4X,GAGzBtU,aAAc,WACVzJ,KAAKge,WACLhe,KAAKie,SAGT9S,WAAY,SAAS5F,GACjB,IAAIzF,EAAeE,KAAKmG,cAExBrG,EAAaoG,aAAaX,IAG9ByY,SAAU,WACN,IAAIle,EAAeE,KAAKmG,cACpBvG,EAAUE,EAAaF,QACvBse,EAAate,EAAQ,GACrBQ,EAEJA,EAAUR,EAAQ4D,SAElB,IAAKpD,EAAQsD,GAAG,uBAAwB,CACpCtD,EAAUR,EAAQ0M,KAAK,YAAY9I,SACnCpD,EAAQ,GAAGqS,MAAM0L,QAAUD,EAAWzL,MAAM0L,QAC5C/d,EAAQ,GAAGgZ,MAAQ8E,EAAW9E,MAGlCtZ,EAAagc,SAAWhc,EAAaM,QAAUA,EAC1CqP,SAAS,2BACTA,SAASyO,EAAWE,WACpBvH,YAAY,0BACZA,YAAY,aACZtG,IAAI,UAAW,IACf5N,KAAK,CACF0b,UAAWze,EAAQ+C,KAAK,aACxB2b,aAAc,OAGtB1e,EAAQqV,OAAOf,WAAW,cAG9B+J,MAAO,WACH,IAAIne,EAAeE,KAAKmG,cACpB/F,EAAUN,EAAaM,QACvBme,EAAW,0BACXxR,EAEJA,EAAO3M,EAAQwC,KAAK2b,GAEpB,IAAKxR,EAAK,GAAI,CACV3M,EAAQ6J,OAAO,gGACCnD,EAAK0X,aAAa,+FAAgG9e,EAAO,GAAII,EAAaD,QAAS,CAC/I4e,KAAM,UACNC,MAAO,OACP/P,QAAS,WAErB1E,OAAOnK,EAAaF,SAE5BmN,EAAO3M,EAAQwC,KAAK2b,GAGxBze,EAAaiN,KAAOA,EACpBjN,EAAa6e,OAASve,EAAQwC,KAAK,mBACnC9C,EAAa8e,WAAa9e,EAAa6e,OAAO/b,KAAK,YAGvDoO,UAAW,SAASjQ,GAChB,IAAIjB,EAAeE,KAAKmG,cACxB,IAAIiO,EAEJ,GAAIrT,IAAUzC,GAAayC,IAAU,KAAM,CACvCqT,EAAetU,EAAagJ,QAAQM,QAAQ,GAC5CrI,SAAgBqT,IAAiB,SAAYA,EAAetU,EAAaoW,aAAe9B,EACxF,OAAOrT,IAAUzC,GAAayC,IAAU,KAAO,GAAKA,EAExDjB,EAAamJ,mBAAqB,KAClC,GAAIlI,EAAMvB,SAAW,EAAG,CACpBM,EAAauW,qBACbvW,EAAamJ,mBAAqB,MAClC,OAGJnJ,EAAa0a,mBAAmBzZ,GAChCjB,EAAaiL,0BAGjByL,YAAa,WACT,IAAI1W,EAAeE,KAAKmG,cACxB,IAAI0Y,EAAe/e,EAAakM,SAAS5G,SAEzC,GAAItF,EAAakM,SAASrL,SAASke,GAAe,CAC9C/e,EAAakM,SAASrL,SAASke,GAAcje,IAAI,WAAY,OAC7D,IAAKd,EAAamJ,mBACdnJ,EAAagD,QAAQsF,KAKjCuQ,iBAAkB,SAASmG,EAAU/d,GACjC,IAAIjB,EAAeE,KAAKmG,cAExB,IAAKrG,EAAakJ,mBAAmBjI,IAAUA,IAAU,IACrD,GAAIjB,EAAa4Y,eAAeoG,EAAU/d,GAAQ,CAC9CjB,EAAawV,sBAAwB,KACrCwJ,EAASle,IAAI,WAAY,MACzBd,EAAawV,sBAAwB,WAClC,GAAIwJ,EAAS7Y,SAChBnG,EAAakM,SAAS5G,OAAOtF,EAAakM,SAAShK,UAAU8c,EAAS7c,WAGvE,IAAKlB,GAAS+d,EAAS7Y,SAC1BnG,EAAakM,SAAS5G,OAAOtF,EAAakM,SAAShK,UAAU8c,EAAS7c,SAK9EuK,EAAoBpO,EAAM0f,MAAMpe,OAAO,CACvCC,KAAM,SAASoe,GACX/d,KAAKmG,cAAgB4X,GAGzBtU,aAAc,WACV,IAAI3J,EAAeE,KAAKmG,cAExBnG,KAAK+e,eACLjf,EAAaF,QAAQ+C,KAAK,WAAY,YAAYsS,OAClDjV,KAAKge,WACLle,EAAa8M,MAAQ,IAAI5F,EAAgB,IACzClH,EAAamN,cAAgB,IAAIjG,EAAgB,IACjDhH,KAAKgf,WACLlf,EAAaiN,KAAO7O,EAAE,iGAAiGkU,SAAStS,EAAa6Q,SAAS/N,KAAK,wBAI/JuI,WAAY,SAAS5F,EAAMxE,GACvB,IAAIjB,EAAeE,KAAKmG,cACxB,IAAI8Y,EAAgBle,GAASjB,EAAaD,QAAQkB,MAElD,IAAKmI,MAAMC,QAAQ5D,MAAWA,aAAgBnH,EAAMmH,KAAKyB,iBACrDzB,EAAO,CAACA,GAGZ,GAAIrH,EAAE4Y,cAAcvR,EAAK,KAAOA,EAAK,aAAcnH,EAAMmH,KAAK0B,mBAAqBnH,EAAaD,QAAQyN,eAAgB,CACpHxN,EAAaqM,WAAW5G,KAAKA,GAE7BzF,EAAaiB,MAAMke,KAI3BF,aAAc,WACV,IAAIjf,EAAeE,KAAKmG,cACxB,IAAItG,EAAUC,EAAaD,QAC3B,IAAIqf,EAAcrf,EAAQ2O,cAC1B,IAAI+F,EAAa1U,EAAQuO,UAAY,WACrC,IAAIP,EAAYhO,EAAQ+N,SAASC,UAEjCqR,EAAcA,EAAc9gB,EAAM6N,SAASiT,GAAepf,EAAa0O,cAEvE1O,EAAa0O,cAAgB,SAASjJ,GAClC,OAAOuB,EAAKqY,WAAW,wCACnB,WAAc5Z,EAAKiI,UAAY,MAAS,aAAe,IAAM,KAC3DjI,EAAKiI,UAAY,MAAS,uBAAyB,IACrD,IACA,UAAWtP,EAAEwB,OAAO,GAAIG,EAAS,CACzB6O,SAAU,QACV0Q,WAAY,OACZzQ,QAAS,SACThM,KAAM,CACF2b,aAAc,MAElBpT,KAAOqJ,EAAa2K,EAAY3Z,GAAS,gEACzC,iCAAmCsI,EAAY,UAC/CwR,UAAW9K,EACX+K,WAAY,WACZC,cAAe,CACXjB,aAAc,KACdvU,cAAe,KACfyV,aAAc1f,EAAaD,QAAQ+N,SAASG,UAC5CqL,MAAOtZ,EAAaD,QAAQ+N,SAASG,gBAM7DiQ,SAAU,WACN,IAAIle,EAAeE,KAAKmG,cACpBvG,EAAUE,EAAaF,QACvBQ,EAAUR,EAAQ4D,OAAO,uBAE7B,IAAKpD,EAAQ,GAAI,CACbA,EAAUR,EAAQ0M,KAAK,6DAA6D9I,SACpFpD,EAAQ,GAAGqS,MAAM0L,QAAUve,EAAQ,GAAG6S,MAAM0L,QAC5C/d,EAAQ,GAAGgZ,MAAQxZ,EAAQ,GAAGwZ,MAGlCtZ,EAAaM,QAAUA,EAAQqP,SAAS7P,EAAQ,GAAGwe,WAAW7N,IAAI,UAAW,KAGjFyO,SAAU,WACN,IAAIlf,EAAeE,KAAKmG,cACpBwK,EAAU7Q,EAAaM,QAAQb,SAAS,sBAE5C,IAAKoR,EAAQ,GAAI,CACb,IAAI4D,EAAazU,EAAaD,QAAQuO,UAAY,WAClD,IAAIqR,EAAgBlL,EAAa,OAAS,cAE1C5D,EAAUzS,EAAE4I,EAAK4Y,eAAe,gGAAkGD,EAAgB,OAAQvhB,EAAEwB,OAAO,GAAII,EAAaD,WAAWuS,SAAStS,EAAaM,SAGzNN,EAAa6Q,QAAUA,EACvB7Q,EAAa6Q,QAAQhO,KAAK,KAAMvE,EAAMsT,OAAS,YAC/C5R,EAAaM,QAAQuC,KAAK,gBAAiB7C,EAAa6Q,QAAQhO,KAAK,OACrE,IAAIgd,EAAYvhB,EAAMwhB,WAAW,CAC7BC,YAAa/f,EAAamN,cAC1B6S,KAAMhgB,EAAa8M,MACnBsS,YAAapf,EAAa0O,gBAE9BpQ,EAAMmC,KAAKT,EAAa6Q,QAASgP,GACjC7f,EAAa6Q,QAAQhO,KAAK,YAAa,OAG3CqO,UAAW,SAASjQ,GAChB,IAAIjB,EAAeE,KAAKmG,cACxB,IAAI4Z,EAAYjgB,EAAagJ,QAC7B,GAAI/H,IAAUzC,GAAayC,IAAU,KACjC,OAAOjB,EAAagJ,QAAQM,QAGhCtJ,EAAa+M,SAAS9L,GACtBjB,EAAamJ,mBAAqB,KAClC,GAAIlI,EAAMvB,OAAQ,CACdQ,KAAKggB,cAAcD,EAAWhf,GAE9BjB,EAAa4a,kBAAkB3Z,QAE/BjB,EAAauW,qBAGjBvW,EAAamJ,mBAAqB,MAClCnJ,EAAaiL,0BAGjBiV,cAAe,SAASD,EAAWhf,GAC/B,IAAIjB,EAAeE,KAAKmG,cACxB,IAAI8Z,EAAgBjgB,KAAKkgB,cAAcH,EAAWhf,GAElD,IAAK,IAAIoU,EAAM,EAAGA,EAAM8K,EAAczgB,OAAQ2V,IAC1C,IAAK,IAAIgL,EAAI,EAAGA,EAAIrgB,EAAa8M,MAAMpN,OAAQ2gB,IAC3C,GAAIrgB,EAAa4Y,eAAe5Y,EAAa8M,MAAMuT,GAAGF,EAAc9K,IAChErV,EAAaua,kBAAkBva,EAAa8M,MAAMuT,GAAGle,MAMrEie,cAAe,SAASH,EAAWhf,GAC/B,IAAIkf,EAAgB,GAEpB,IAAK,IAAI9K,EAAM,EAAGA,EAAM4K,EAAUvgB,OAAQ2V,IACtC,GAAIpU,EAAM0T,QAAQsL,EAAU5K,OAAW,EACnC8K,EAAcjL,KAAK+K,EAAU5K,IAIrC,OAAO8K,GAGXzJ,YAAa,WACT,IAAI1W,EAAeE,KAAKmG,cACxB,IAAIia,EAAYtgB,EAAa8M,MAAMxD,QAEnC,IAAK,IAAI+L,EAAM,EAAGA,EAAMiL,EAAU5gB,OAAQ2V,IAAO,CAC7C,IAAIlT,EAAMme,EAAUjL,GAAKlT,IACzBnC,EAAawV,sBAAwB,KACrCxV,EAAaua,kBAAkBpY,GAGnC,GAAIme,EAAU5gB,OAAQ,CAClBM,EAAawV,sBAAwB,MACrC,IAAKxV,EAAamJ,mBACdnJ,EAAagD,QAAQsF,KAKjCuQ,iBAAkB,SAASmG,EAAU/d,GACjC,IAAIjB,EAAeE,KAAKmG,cAExB,GAAIrG,EAAaiJ,iBAAmB+V,EAASje,QAAS,CAClDf,EAAakG,YAAY8Y,GACzB,OAGJ,IAAK/d,EAAMvB,QAAUQ,KAAK2M,oBACrB5L,EAAM0T,QAAQ3U,EAAaqU,cAAc2K,OAAgB,GAAK/d,EAAM0T,QAAQqK,OAAgB,IAC5F9e,KAAKqgB,SAASvgB,EAAaqU,cAAc2K,IAC1C,GAAIA,EAASje,QACTf,EAAakG,YAAY8Y,OACtB,CACHhf,EAAawV,sBAAwB,KACrCwJ,EAASle,IAAI,UAAW,MACxBd,EAAawV,sBAAwB,QAKjD+K,SAAU,SAASC,GACf,IAAIxgB,EAAeE,KAAKmG,cAExB,OAAOrG,EAAa8M,MAAMhK,KAAK,SAASgS,GACpC,OAAO9U,EAAa4Y,eAAe9D,EAAM0L,QAUzD,OALIliB,EAAMG,GAAGgK,aAAakE,gBAAkBA,EACxCrO,EAAMG,GAAGgK,aAAaiE,kBAAoBA,EAIvCrO,OAAOC,QAnsEd,CAqsEoB,mBAAVH,QAAwBA,OAAOmI,IAAMnI,OAAS,SAASoI,EAAIC,EAAIC,IAAOA,GAAMD"}